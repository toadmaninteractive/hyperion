!function(){function e(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,d=e[Symbol.iterator]();!(i=(a=d.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(c){r=!0,o=c}finally{try{i||null==d.return||d.return()}finally{if(r)throw o}}return n}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"8YY7":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=function(e){return e[e.Id=1]="Id",e[e.FileSize=2]="FileSize",e[e.OriginalFilename=3]="OriginalFilename",e[e.ContentType=4]="ContentType",e[e.PersonnelId=5]="PersonnelId",e[e.PersonnelName=6]="PersonnelName",e[e.CreatedAt=7]="CreatedAt",e}({});!function(e){function t(t){switch(t){case e.Id:return"id";case e.FileSize:return"file_size";case e.OriginalFilename:return"original_filename";case e.ContentType:return"content_type";case e.PersonnelId:return"personnel_id";case e.PersonnelName:return"personnel_name";case e.CreatedAt:return"created_at";default:throw new Error("Invalid FileAttachmentOrderBy value: "+t)}}function n(t){switch(t){case"id":return e.Id;case"file_size":return e.FileSize;case"original_filename":return e.OriginalFilename;case"content_type":return e.ContentType;case"personnel_id":return e.PersonnelId;case"personnel_name":return e.PersonnelName;case"created_at":return e.CreatedAt;default:throw new Error("Invalid FileAttachmentOrderBy value: "+t)}}e.toJson=function(e){return t(e)},e.fromJson=function(e){return n(e)},e.toJsonKey=t,e.fromJsonKey=n}(i||(i={}))},E1Th:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("tk/3"),o=n("z6cu"),d=n("JIr8"),c=n("lJxs"),l=n("UTw3"),s=n("0bxZ"),p=n("8YY7"),m=n("fXoL"),u=function(){var e=function(){function e(t){r(this,e),this.http=t,this.baseUrl=""}return a(e,[{key:"getProjectAttachments",value:function(e,t,n,r,a){var m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=[];u.push("order_by="+p.a.toJson(t)),u.push("order_dir="+l.h.toJson(n)),u.push("offset="+r),u.push("limit="+a),null!=m&&u.push("needle="+m);var h=u.length>0?"?"+u.join("&"):"";return this.http.get("".concat(this.baseUrl,"/api/attachments/project/").concat(e).concat(h)).pipe(Object(d.a)(function(e){if(e instanceof i.c)switch(e.status){case 403:return Object(o.a)(l.d.fromJson(e.error));case 500:return Object(o.a)(l.f.fromJson(e.error))}Object(o.a)(e)}),Object(c.a)(function(e){return l.c.instanceJsonSerializer(s.c).fromJson(e)}))}},{key:"getLinkedAttachments",value:function(e,t){return this.http.get("".concat(this.baseUrl,"/api/attachments/").concat(s.b.toJson(e),"/").concat(t)).pipe(Object(d.a)(function(e){if(e instanceof i.c)switch(e.status){case 403:return Object(o.a)(l.d.fromJson(e.error));case 404:return Object(o.a)(l.g.fromJson(e.error));case 500:return Object(o.a)(l.f.fromJson(e.error))}Object(o.a)(e)}),Object(c.a)(function(e){return l.b.instanceJsonSerializer(s.c).fromJson(e)}))}},{key:"deleteAttachmentLink",value:function(e,t,n){return this.http.delete("".concat(this.baseUrl,"/api/attachments/").concat(e,"/").concat(s.b.toJson(t),"/").concat(n)).pipe(Object(d.a)(function(e){if(e instanceof i.c)switch(e.status){case 403:return Object(o.a)(l.d.fromJson(e.error));case 404:return Object(o.a)(l.g.fromJson(e.error));case 500:return Object(o.a)(l.f.fromJson(e.error))}Object(o.a)(e)}),Object(c.a)(function(e){return l.e.fromJson(e)}))}},{key:"getAttachmentLinks",value:function(e){return this.http.get("".concat(this.baseUrl,"/api/attachments/").concat(e,"/links")).pipe(Object(d.a)(function(e){if(e instanceof i.c)switch(e.status){case 403:return Object(o.a)(l.d.fromJson(e.error));case 500:return Object(o.a)(l.f.fromJson(e.error))}Object(o.a)(e)}),Object(c.a)(function(e){return l.b.instanceJsonSerializer(s.d).fromJson(e)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275inject"](i.a))},e.\u0275prov=m["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},gQyj:function(i,o,d){"use strict";d.r(o),d.d(o,"SetupModule",function(){return lt});var c=d("ofXK"),l=d("3Pt+"),s=d("tyNb"),p=d("bTqV"),m=d("bSwM"),u=d("0IaG"),h=d("kmnG"),f=d("NFeN"),v=d("qFsG"),g=d("Xa2L"),b=d("Qu3c"),y=d("8yBR"),S=d("m3o8"),N=d("fXoL");d("jhN1");var x,k=((x=function e(){r(this,e)}).\u0275mod=N["\u0275\u0275defineNgModule"]({type:x}),x.\u0275inj=N["\u0275\u0275defineInjector"]({factory:function(e){return new(e||x)},imports:[[c.c]]}),x),w=d("gfTr"),C=d("bFKe"),I=d("QJFE"),E=d("PCNd"),T=d("j1ZV"),M=d("0Y/I"),O=d("sUzd"),P=d("tk/3"),A=d("XNiG"),D=d("2Vo4"),j=d("itXk"),F=d("VRyK"),_=d("1G5W"),R=d("pLZG"),$=d("nYR2"),V=d("/1cH"),L=d("E1Th"),B=d("EPMp"),z=d("Y4+Y"),J=d("TufI"),U=d("25+x"),H=d("Sw3e"),Q=d("Ehhc"),q=d("N1IV"),Y=d("FvrZ"),G=d("0bxZ"),Z=["addButtonTemplate"],X=["addParaButtonTemplate"],K=["nodeTitleTemplate"],W=["treeSelector"];function ee(e,t){1&e&&(N["\u0275\u0275elementStart"](0,"div",4),N["\u0275\u0275text"](1," Node template not defined "),N["\u0275\u0275elementEnd"]())}function te(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"div",5),N["\u0275\u0275listener"]("dragover",function(e){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"]().onDragOverRoot(e)})("drop",function(e){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"]().onDropToRoot(e)})("dragleave",function(){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"]().onDragLeaveRoot()}),N["\u0275\u0275elementStart"](1,"div",6),N["\u0275\u0275text"](2," Drop to root "),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"]();N["\u0275\u0275classProp"]("drop-parent-select",i.dragOverRoot)}}function ne(e,t){1&e&&N["\u0275\u0275element"](0,"div",19)}function ie(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"div",20),N["\u0275\u0275elementStart"](1,"mat-icon",21),N["\u0275\u0275listener"]("click",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"]().$implicit,t=N["\u0275\u0275nextContext"](2);return t.toggleTreeNode(e,t.treeControl.isExpanded(e))}),N["\u0275\u0275text"](2),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"]().$implicit,r=N["\u0275\u0275nextContext"](2);N["\u0275\u0275advance"](2),N["\u0275\u0275textInterpolate1"](" ",r.treeControl.isExpanded(i)?"expand_more":"chevron_right"," ")}}function re(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"mat-checkbox",22),N["\u0275\u0275listener"]("change",function(e){N["\u0275\u0275restoreView"](n);var t=N["\u0275\u0275nextContext"]().$implicit;return N["\u0275\u0275nextContext"](2).onCheckNode(t,e.checked)}),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"]().$implicit,r=N["\u0275\u0275nextContext"](2);N["\u0275\u0275property"]("checked",r.checkedNodeSet.has(i.item.id))("indeterminate",r.indeterminatedNodeSet.has(i.item.id))("disabled",i.item.isDraft)}}function oe(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"mat-icon",23),N["\u0275\u0275listener"]("mousedown",function(e){N["\u0275\u0275restoreView"](n);var t=N["\u0275\u0275nextContext"]().$implicit;return N["\u0275\u0275nextContext"](2).setDraggedNode(e,t)})("mouseup",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"]().$implicit;return N["\u0275\u0275nextContext"](2).unsetDraggedNode(e)}),N["\u0275\u0275text"](1," apps "),N["\u0275\u0275elementEnd"]()}}function ae(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"mat-icon",24),N["\u0275\u0275listener"]("click",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"]().$implicit;return N["\u0275\u0275nextContext"](2).onRemoveNode(e)}),N["\u0275\u0275text"](1," delete "),N["\u0275\u0275elementEnd"]()}}var de=function(e){return{node:e}};function ce(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"div",27),N["\u0275\u0275elementStart"](1,"div",28),N["\u0275\u0275elementStart"](2,"span",29),N["\u0275\u0275listener"]("click",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"](2).$implicit;return N["\u0275\u0275nextContext"](2).onAddNode(e)}),N["\u0275\u0275text"](3," Add item to "),N["\u0275\u0275elementStart"](4,"b"),N["\u0275\u0275text"](5),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementContainer"](6,16),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"](2).$implicit,r=N["\u0275\u0275nextContext"](2),o=N["\u0275\u0275reference"](4);N["\u0275\u0275advance"](5),N["\u0275\u0275textInterpolate"](i.item.title),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngTemplateOutlet",r.addButtonTemplate?r.addButtonTemplate:o)("ngTemplateOutletContext",N["\u0275\u0275pureFunction1"](3,de,i))}}function le(e,t){if(1&e&&(N["\u0275\u0275elementStart"](0,"ul"),N["\u0275\u0275elementContainer"](1,25),N["\u0275\u0275template"](2,ce,7,5,"div",26),N["\u0275\u0275elementEnd"]()),2&e){var n=N["\u0275\u0275nextContext"]().$implicit,i=N["\u0275\u0275nextContext"](2);N["\u0275\u0275classProp"]("basic-tree-invisible",!i.treeControl.isExpanded(n)),N["\u0275\u0275advance"](2),N["\u0275\u0275property"]("ngIf",n.children.length>10&&!i.showCheckboxes&&!i.treeNodeHasDraftChildren(n))}}function se(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"mat-nested-tree-node"),N["\u0275\u0275elementStart"](1,"li"),N["\u0275\u0275elementStart"](2,"div",10),N["\u0275\u0275listener"]("dragover",function(e){N["\u0275\u0275restoreView"](n);var i=t.$implicit;return N["\u0275\u0275nextContext"](2).onDragOver(e,i)})("dragend",function(e){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"](2).onDragEnd(e)})("drop",function(e){N["\u0275\u0275restoreView"](n);var i=t.$implicit;return N["\u0275\u0275nextContext"](2).onDrop(e,i)})("dragstart",function(e){N["\u0275\u0275restoreView"](n);var i=t.$implicit;return N["\u0275\u0275nextContext"](2).onDragStart(e,i)}),N["\u0275\u0275template"](3,ne,1,0,"div",11),N["\u0275\u0275template"](4,ie,3,1,"div",12),N["\u0275\u0275template"](5,re,1,3,"mat-checkbox",13),N["\u0275\u0275elementStart"](6,"button",14),N["\u0275\u0275template"](7,oe,2,0,"mat-icon",15),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementContainer"](8,16),N["\u0275\u0275elementContainer"](9,16),N["\u0275\u0275elementContainer"](10,16),N["\u0275\u0275elementStart"](11,"button",14),N["\u0275\u0275template"](12,ae,2,0,"mat-icon",17),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275template"](13,le,3,3,"ul",18),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit,r=N["\u0275\u0275nextContext"](2),o=N["\u0275\u0275reference"](4);N["\u0275\u0275styleProp"]("display",null!=r.hiddenNodeSet&&r.hiddenNodeSet.has(i)?"none":"block"),N["\u0275\u0275attribute"]("matTreeNodeToggle",0===i.children.length),N["\u0275\u0275advance"](2),N["\u0275\u0275classProp"]("dimmed",!!r.filterFn&&!r.filterFn(i,r.filterText))("more",!!r.filterFn&&!r.filterFn(i,r.filterText))("drag-start",i===r.draggedNode)("drop-center",i===r.hoveredNode&&0===r.draggedNodeHoveredType&&i!==r.draggedNode&&r.canDropInto&&r.canDropInto(r.draggedNode,r.hoveredNode))("drop-before",i===r.hoveredNode&&-1===r.draggedNodeHoveredType&&i!==r.draggedNode&&r.canDropBefore&&r.canDropBefore(r.draggedNode,r.hoveredNode))("drop-below",i===r.hoveredNode&&1===r.draggedNodeHoveredType&&i!==r.draggedNode&&r.canDropAfter&&r.canDropAfter(r.draggedNode,r.hoveredNode)),N["\u0275\u0275attribute"]("draggable",i===r.draggedNode),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngIf",0===(null==i.children?null:i.children.length)),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngIf",(null==i.children?null:i.children.length)>0),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngIf",r.showCheckboxes),N["\u0275\u0275advance"](2),N["\u0275\u0275property"]("ngIf",r.canDrag&&0!==i.item.id),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngTemplateOutlet",r.nodeTitleTemplate)("ngTemplateOutletContext",N["\u0275\u0275pureFunction1"](28,de,i)),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngTemplateOutlet",r.addButtonTemplate?r.addButtonTemplate:o)("ngTemplateOutletContext",N["\u0275\u0275pureFunction1"](30,de,i)),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngTemplateOutlet",r.addParaButtonTemplate?r.addParaButtonTemplate:null)("ngTemplateOutletContext",N["\u0275\u0275pureFunction1"](32,de,i)),N["\u0275\u0275advance"](2),N["\u0275\u0275property"]("ngIf",r.nodeRemoved.observers.length>0),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngIf",i.children.length>0)}}function pe(e,t){if(1&e&&(N["\u0275\u0275elementStart"](0,"mat-tree",7,8),N["\u0275\u0275template"](2,se,14,34,"mat-nested-tree-node",9),N["\u0275\u0275elementEnd"]()),2&e){var n=N["\u0275\u0275nextContext"]();N["\u0275\u0275property"]("dataSource",n.dataSource)("treeControl",n.treeControl)}}function me(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"button",31),N["\u0275\u0275listener"]("click",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"]().node;return N["\u0275\u0275nextContext"]().onAddNode(e)}),N["\u0275\u0275elementStart"](1,"mat-icon"),N["\u0275\u0275text"](2,"add"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"]().node,r=N["\u0275\u0275nextContext"]();N["\u0275\u0275property"]("disabled",r.treeNodeHasDraftChildren(i))}}function ue(e,t){if(1&e&&N["\u0275\u0275template"](0,me,3,1,"button",30),2&e){var n=N["\u0275\u0275nextContext"]();N["\u0275\u0275property"]("ngIf",n.nodeAdded.observers.length>0)}}var he,fe=((he=function(){function e(t,n,i){r(this,e),this.cdr=t,this.notificationService=n,this.windowRefService=i,this.nodeMapChange=new N.EventEmitter,this.itemMapChange=new N.EventEmitter,this.itemMapRefresh=new N.EventEmitter,this.getCheckedNodeSet=new N.EventEmitter,this.selectNode=new N.EventEmitter,this.treeChanged=new N.EventEmitter,this.nodeAdded=new N.EventEmitter,this.parametricNodeAdded=new N.EventEmitter,this.nodeRemoved=new N.EventEmitter,this.nodeModified=new N.EventEmitter,this.showNotification=new N.EventEmitter,this.destroy$=new A.b,this.treeControl=new Y.j(function(e){return e.children}),this.dataSource=new y.d,this.expandedNodeId=new Set,this.expandedNodeSet=new Set,this.checkedNodeSet=new Set,this.indeterminatedNodeSet=new Set,this.fullNodeMap=[],this.dragOverRoot=!1,this.delayBeforeHoveredNodeExpand=300,this.dropPlaceEnum=q.a,this.notificationTypeEnum=z.b,this.alreadySetPrechecked=!1}return a(e,[{key:"ngOnDestroy",value:function(){this.destroy$.next(),this.destroy$.complete()}},{key:"ngOnChanges",value:function(){var e=this;if(this.rootNode&&this.rootNode.children.length>0){if(console.log("========== onChanges ==========="),this.dataSource.data=[],this.dataSource=new y.d,this.dataSource.data=this.rootNode.children,this.dataSource.data.sort(this.orderingFn),this.updateDataSource(),this.expandedNodeSet.clear(),this.expandedNodeId.forEach(function(t){return e.findNodeInDataSource(e.dataSource.data,t)}),this.expandedNodeSet.forEach(function(t){return e.toggleTreeNode(t,!0)}),this.nodeMap.clear(),this.itemMap||(this.itemMap=new Map),this.rootNode.children.forEach(function(t){return e.walkTreeNode(t)}),setTimeout(function(){return e.windowRefService.focusElementById("input-setup-0",0)},200),setTimeout(function(){return e.windowRefService.focusElementById("input-parameter-0",0)},200),this.precheckedNodeSet){var t=[];this.rootNode.children.forEach(function(n,i){t.push(e.flatTree(e.rootNode.children[i]))}),t.forEach(function(t){e.fullNodeMap.push(t.reduce(function(e,t){return e.find(function(e){return e.id===t.id})?e:e.concat([t])},[]))}),this.fullNodeMap.forEach(function(t){var n=[];t.forEach(function(t){!1===t.draft&&!1===t.group&&e.checkedNodeSet.has(t.id)&&n.push(t)})}),this.precheckedNodeSet.forEach(function(t){return e.checkUncheckNodeParent(e.searchNode(t),!0,!0)})}}else this.dataSource.data=[];if(this.websocketNodeAdd&&this.prevNewNode!==this.websocketNodeAdd&&(this.prevNewNode=this.websocketNodeAdd,this.nodeMap.has(this.websocketNodeAdd.item.id)||(this.websocketNodeAdd.item.parentId?this.nodeMap.get(this.websocketNodeAdd.item.parentId).children.push(this.websocketNodeAdd):this.rootNode.children.push(this.websocketNodeAdd),this.itemMap.set(this.websocketNodeAdd.item.id,this.websocketNodeAdd.item),this.updateDataSource(),this.tree.renderNodeChanges(this.dataSource.data))),this.websocketNodeModifyEvent&&this.prevUpdatedNode!==this.websocketNodeModifyEvent&&(this.prevUpdatedNode=this.websocketNodeModifyEvent,this.nodeMap.has(this.websocketNodeModifyEvent.item.id))){var n=this.itemMap.get(this.websocketNodeModifyEvent.item.id),i=this.nodeMap.get(this.websocketNodeModifyEvent.item.id);i.item=this.websocketNodeModifyEvent.item,this.nodeMap.set(i.item.id,i),this.setItemMapByType(i),this.moveTreeNode(i,n.parentId,this.websocketNodeModifyEvent.item.parentId),this.dataSource.data.sort(this.orderingFn),this.tree.renderNodeChanges(this.dataSource.data)}if(this.websocketNodeRemove&&this.prevRemovedNode!==this.websocketNodeRemove&&this.nodeMap.has(this.websocketNodeRemove.item.id)){this.nodeMap.delete(this.websocketNodeRemove.item.id),this.itemMap.delete(this.websocketNodeRemove.item.id);var r=this.websocketNodeRemove.item.parentId?this.nodeMap.get(this.websocketNodeRemove.item.parentId):null,o=r?r.children.findIndex(function(t){return t.item.id===e.websocketNodeRemove.item.id}):this.rootNode.children.findIndex(function(t){return t.item.id===e.websocketNodeRemove.item.id});-1!==o&&(r?r.children.splice(o,1):this.rootNode.children.splice(o,1)),this.updateDataSource()}!this.alreadySetPrechecked&&this.precheckedNodeSet&&(this.checkedNodeSet=this.precheckedNodeSet,this.alreadySetPrechecked=!0),this.itemMapRefresh.emit(this.nodeMap)}},{key:"flatTree",value:function(e){var t=this,n=new Array;return n.push({id:e.item.id,parentId:e.item.parentId,node:e}),e.children&&e.children.forEach(function(e){n.push({id:e.item.id,parentId:e.item.parentId,node:e}),e.children.length>0&&n.push(t.flatTree(e))}),n.flat(1)}},{key:"walkTreeNode",value:function(e){var t=this;e&&0!==e.item.id&&this.itemMap&&(this.setItemMapByType(e),this.nodeMap.set(e.item.id,e),e.children.forEach(function(e){return t.walkTreeNode(e)}))}},{key:"setItemMapByType",value:function(e){switch(e.item.constructor){case G.m:this.itemMap.set(e.item.id,G.m.fromJson(e.item.toJson()));break;case G.o:this.itemMap.set(e.item.id,G.o.fromJson(e.item.toJson()));break;case G.f:this.itemMap.set(e.item.id,G.f.fromJson(e.item.toJson()))}}},{key:"moveTreeNode",value:function(e,t,n){if(t!==n){e.item.parentId=n;var i=t?this.nodeMap.get(t):null,r=i?i.children.findIndex(function(t){return t.item.id===e.item.id}):this.rootNode.children.findIndex(function(t){return t.item.id===e.item.id});-1!==r&&(i?i.children.splice(r,1):this.rootNode.children.splice(r,1)),n?this.nodeMap.get(n).children.push(e):this.rootNode.children.push(e),this.dataSource.data=this.rootNode.children,this.updateDataSource()}}},{key:"updateDataSource",value:function(){this.dataSource.data=[],performance.now(),this.dataSource=new y.d,this.dataSource.data=this.rootNode.children,this.dataSource.data.sort(this.orderingFn)}},{key:"treeNodeHasDraftChildren",value:function(e){return e.children.filter(function(e){return 0===e.item.id}).length>0}},{key:"findNodeInDataSource",value:function(e,t){var n=this;e.forEach(function(e){e.item.id!==t?n.findNodeInDataSource(e.children,t):n.expandedNodeSet.add(e)})}},{key:"toggleTreeNode",value:function(e,t){t?this.treeControl.expand(e):this.treeControl.collapse(e),t?this.expandedNodeId.add(e.item.id):this.expandedNodeId.delete(e.item.id)}},{key:"toggleAllChildTreeNode",value:function(e,t){var n=this;t?this.treeControl.expand(e):this.treeControl.collapse(e),t?this.expandedNodeId.add(e.item.id):this.expandedNodeId.delete(e.item.id),e.children.forEach(function(e){return n.toggleAllChildTreeNode(e,t)})}},{key:"toggleOneChildTreeNode",value:function(e,t){t?this.treeControl.expand(e):this.treeControl.collapse(e),t?this.expandedNodeId.add(e.item.id):this.expandedNodeId.delete(e.item.id),e.item.parentId&&this.toggleOneChildTreeNode(this.nodeMap.get(e.item.parentId),!0)}},{key:"expandAllTreeNodes",value:function(){var e=this;this.dataSource.data.forEach(function(t){return e.toggleAllChildTreeNode(t,!0)})}},{key:"collapseAllTreeNodes",value:function(){var e=this;this.dataSource.data.forEach(function(t){return e.toggleAllChildTreeNode(t,!1)})}},{key:"checkUncheckNodeParent",value:function(e,t,n){var i=this;if(e){n&&(this.indeterminatedNodeSet.delete(e.item.id),t&&!e.item.isDraft?this.checkedNodeSet.add(e.item.id):this.checkedNodeSet.delete(e.item.id),e.children.length>0&&e.children.forEach(function(n){t&&!e.item.isDraft?i.checkedNodeSet.add(n.item.id):i.checkedNodeSet.delete(n.item.id),i.indeterminatedNodeSet.delete(n.item.id),i.checkUncheckNodeChild(n,t)}));var r=0,o=0;e.children.length>0&&e.children.forEach(function(e){i.indeterminatedNodeSet.has(e.item.id),i.checkedNodeSet.has(e.item.id)&&r++,o++}),r===o&&0!==r&&0!==o?(this.indeterminatedNodeSet.delete(e.item.id),t&&!e.item.isDraft?this.checkedNodeSet.add(e.item.id):this.checkedNodeSet.delete(e.item.id),this.indeterminatedNodeSet.add(e.item.parentId),this.checkUncheckNodeParent(this.searchNode(e.item.parentId),t,!1)):e.item.parentId?this.fullNodeMap.forEach(function(n,r){var o=0,a=0,d=0;n.forEach(function(t){t.parentId===e.item.parentId&&null!==t.parentId&&null!==e.item.parentId&&(o=t.parentId,a++,i.checkedNodeSet.has(t.id)&&d++)}),d>0&&(t=!0),a>0&&(i.checkedNodeSet.delete(o),t&&!e.item.isDraft?i.indeterminatedNodeSet.add(o):i.indeterminatedNodeSet.delete(o),i.checkUncheckNodeParent(i.searchNode(o),t,!1))}):r>0&&this.indeterminatedNodeSet.add(e.item.id)}}},{key:"checkUncheckNodeChild",value:function(e,t){var n=this;e.children&&e.children.forEach(function(i){n.indeterminatedNodeSet.delete(i.item.id),t&&!e.item.isDraft?n.checkedNodeSet.add(i.item.id):n.checkedNodeSet.delete(i.item.id),n.checkUncheckNodeChild(i,t)})}},{key:"searchNode",value:function(e){var t;return this.fullNodeMap.forEach(function(n,i){n.forEach(function(n){n.id===e&&(t=n.node)})}),t}},{key:"setDraggedNode",value:function(e,t){this.draggedNode=t}},{key:"unsetDraggedNode",value:function(e){this.draggedNode=null}},{key:"onDragOverRoot",value:function(e){this.dragOverRoot=!0,e.preventDefault()}},{key:"onDragLeaveRoot",value:function(){this.dragOverRoot=!1}},{key:"onDropToRoot",value:function(e){this.dragOverRoot=!1,this.nodeModified.emit({dropType:q.a.Root,draggedNode:this.draggedNode,targetNode:null}),this.onDragEnd(e)}},{key:"onDragOver",value:function(e,t){e.preventDefault(),this.draggedNodeHoveredType=NaN,this.hoveredNode&&t===this.hoveredNode?Date.now()-this.draggedNodeHoveredSince>this.delayBeforeHoveredNodeExpand&&(this.treeControl.isExpanded(t)||this.treeControl.expand(t)):(this.hoveredNode=t,this.draggedNodeHoveredSince=(new Date).getTime());var n=e.offsetY/e.target.clientHeight;n>.15&&n<.85?this.draggedNodeHoveredType=this.dropPlaceEnum.Into:n<.15?this.draggedNodeHoveredType=this.dropPlaceEnum.Before:n>.85&&(this.draggedNodeHoveredType=this.dropPlaceEnum.After)}},{key:"onDrop",value:function(e,t){t!==this.draggedNode&&(this.draggedNodeHoveredType===this.dropPlaceEnum.Into?this.canDropInto(this.draggedNode,t)?this.draggedNode.item.parentId===t.item.id?this.showNotification.emit({type:this.notificationTypeEnum.Error,message:"You try drop to parent"}):this.nodeModified.emit({dropType:q.a.Into,draggedNode:this.draggedNode,targetNode:t}):this.showNotification.emit({type:this.notificationTypeEnum.Error,message:"Forbidden"}):this.draggedNodeHoveredType===this.dropPlaceEnum.Before&&this.canDropBefore(this.draggedNode,t)?this.nodeModified.emit({dropType:q.a.Before,draggedNode:this.draggedNode,targetNode:t}):this.draggedNodeHoveredType===this.dropPlaceEnum.After&&this.canDropAfter(this.draggedNode,t)&&this.nodeModified.emit({dropType:q.a.After,draggedNode:this.draggedNode,targetNode:t})),this.onDragEnd(e)}},{key:"onDragStart",value:function(e,t){e.dataTransfer.setData("foo","bar")}},{key:"onDragEnd",value:function(e){this.draggedNode=null,this.hoveredNode=null,this.draggedNodeHoveredSince=0,this.draggedNodeHoveredType=NaN,e.preventDefault()}},{key:"onAddNode",value:function(e){this.nodeAdded.emit(e)}},{key:"onRemoveNode",value:function(e){this.nodeRemoved.emit(e)}},{key:"onCheckNode",value:function(e,t){this.checkUncheckNodeParent(e,t,!0),this.getCheckedNodeSet.emit(this.checkedNodeSet),this.cdr.detectChanges()}}]),e}()).\u0275fac=function(e){return new(e||he)(N["\u0275\u0275directiveInject"](N.ChangeDetectorRef),N["\u0275\u0275directiveInject"](z.a),N["\u0275\u0275directiveInject"](Q.a))},he.\u0275cmp=N["\u0275\u0275defineComponent"]({type:he,selectors:[["m-tree"]],contentQueries:function(e,t,n){var i;1&e&&(N["\u0275\u0275contentQuery"](n,Z,!0),N["\u0275\u0275contentQuery"](n,X,!0),N["\u0275\u0275contentQuery"](n,K,!0)),2&e&&(N["\u0275\u0275queryRefresh"](i=N["\u0275\u0275loadQuery"]())&&(t.addButtonTemplate=i.first),N["\u0275\u0275queryRefresh"](i=N["\u0275\u0275loadQuery"]())&&(t.addParaButtonTemplate=i.first),N["\u0275\u0275queryRefresh"](i=N["\u0275\u0275loadQuery"]())&&(t.nodeTitleTemplate=i.first))},viewQuery:function(e,t){var n;1&e&&N["\u0275\u0275viewQuery"](W,!0),2&e&&N["\u0275\u0275queryRefresh"](n=N["\u0275\u0275loadQuery"]())&&(t.tree=n.first)},inputs:{rootNode:"rootNode",filterFn:"filterFn",filterText:"filterText",hiddenNodeSet:"hiddenNodeSet",orderingFn:"orderingFn",config:"config",canDrag:"canDrag",canDropInto:"canDropInto",canDropBefore:"canDropBefore",canDropAfter:"canDropAfter",customAddTemplate:"customAddTemplate",precheckedNodeSet:"precheckedNodeSet",showCheckboxes:"showCheckboxes",websocketNodeAdd:"websocketNodeAdd",websocketNodeRemove:"websocketNodeRemove",websocketNodeModifyEvent:"websocketNodeModifyEvent",nodeMap:"nodeMap",itemMap:"itemMap"},outputs:{nodeMapChange:"nodeMapChange",itemMapChange:"itemMapChange",itemMapRefresh:"itemMapRefresh",getCheckedNodeSet:"getCheckedNodeSet",selectNode:"selectNode",treeChanged:"treeChanged",nodeAdded:"nodeAdded",parametricNodeAdded:"parametricNodeAdded",nodeRemoved:"nodeRemoved",nodeModified:"nodeModified",showNotification:"showNotification"},features:[N["\u0275\u0275NgOnChangesFeature"]],decls:5,vars:3,consts:[["class","m-card-warning",4,"ngIf"],["class","drop-parent",3,"drop-parent-select","dragover","drop","dragleave",4,"ngIf"],["class","basic-tree",3,"dataSource","treeControl",4,"ngIf"],["defaultAddButton",""],[1,"m-card-warning"],[1,"drop-parent",3,"dragover","drop","dragleave"],[1,"drop-text"],[1,"basic-tree",3,"dataSource","treeControl"],["treeSelector",""],[3,"display",4,"matTreeNodeDef"],[1,"mat-tree-node",3,"dragover","dragend","drop","dragstart"],["class","mat-icon-not",4,"ngIf"],["class","chevron-btn",4,"ngIf"],["color","primary","class","mr-1",3,"checked","indeterminate","disabled","change",4,"ngIf"],["mat-icon-button",""],["class","node-drag-icon light drag-handle",3,"mousedown","mouseup",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","node-delete-icon pointer","color","warn","matTooltip","Click to delete","matTooltipPosition","above",3,"click",4,"ngIf"],[3,"basic-tree-invisible",4,"ngIf"],[1,"mat-icon-not"],[1,"chevron-btn"],["matTreeNodeToggle","",1,"node-chevron-icon","drop-down","pointer",3,"click"],["color","primary",1,"mr-1",3,"checked","indeterminate","disabled","change"],[1,"node-drag-icon","light","drag-handle",3,"mousedown","mouseup"],["color","warn","matTooltip","Click to delete","matTooltipPosition","above",1,"node-delete-icon","pointer",3,"click"],["matTreeNodeOutlet",""],["class","block-add-node",4,"ngIf"],[1,"block-add-node"],[1,"group"],[1,"button-link-add",3,"click"],["class","node-add-icon f-w-600 pointer","color","primary","mat-icon-button","","matTooltip","Click to add a child","matTooltipPosition","above",3,"disabled","click",4,"ngIf"],["color","primary","mat-icon-button","","matTooltip","Click to add a child","matTooltipPosition","above",1,"node-add-icon","f-w-600","pointer",3,"disabled","click"]],template:function(e,t){1&e&&(N["\u0275\u0275template"](0,ee,2,0,"div",0),N["\u0275\u0275template"](1,te,3,2,"div",1),N["\u0275\u0275template"](2,pe,3,2,"mat-tree",2),N["\u0275\u0275template"](3,ue,1,1,"ng-template",null,3,N["\u0275\u0275templateRefExtractor"])),2&e&&(N["\u0275\u0275property"]("ngIf",!t.nodeTitleTemplate),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngIf",t.draggedNode&&t.draggedNode.item.parentId),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngIf",t.rootNode))},directives:[c.m,y.b,y.e,y.a,y.g,p.a,c.r,f.a,m.a,b.a,y.f],styles:[".pointer[_ngcontent-%COMP%]{cursor:pointer}.mat-tree-node[_ngcontent-%COMP%]{overflow:visible;border:2px solid transparent}.drop-center[_ngcontent-%COMP%]{border-color:var(--primary)!important;transition:border 125ms linear}.drop-before[_ngcontent-%COMP%]{border-top:30px solid var(--primary)!important;transition:border-top 125ms linear}.drop-after[_ngcontent-%COMP%]{border-bottom:30px solid var(--primary)!important;transition:border-bottom 125ms linear}.drag-start[_ngcontent-%COMP%]{border:1px dashed var(--info);color:#000}.drop-root[_ngcontent-%COMP%]{border:1px dashed var(--gray);margin-left:15px;height:30px}.drag-handle[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.drop-parent[_ngcontent-%COMP%]{position:absolute;left:-90px;top:33%;z-index:100;background-color:rgba(85,120,235,.6);width:120px;height:120px;border-radius:50%;box-shadow:3px 3px 15px -5px rgba(0,0,0,.75)}.drop-parent-select[_ngcontent-%COMP%]{background-color:#5578eb;transition:.25s linear}.drop-text[_ngcontent-%COMP%]{height:60px;padding:45px 10px;color:#fff;font-size:18px;text-align:center;font-weight:400}.block-add-node[_ngcontent-%COMP%]{display:block;padding-left:22px;margin-top:-10px}input[type=text].default-disable[_ngcontent-%COMP%], input[type=text].default-disable[_ngcontent-%COMP%]:disabled{border:none;border-bottom:1px solid #ccc;background-color:hsla(0,0%,100%,.125)}.button-link-add[_ngcontent-%COMP%]{color:#3f51b5}.button-link-add[_ngcontent-%COMP%]:hover{cursor:pointer;border-bottom:1px solid #3f51b5}.mat-icon-not[_ngcontent-%COMP%]{display:block;height:40px;width:22px}"]}),he),ve=d("xmDL"),ge=d("QyQT");function be(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"mat-checkbox",7),N["\u0275\u0275listener"]("change",function(){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"]().checkFilter()}),N["\u0275\u0275elementStart"](1,"a",8),N["\u0275\u0275listener"]("click",function(){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"]().checkFilter()}),N["\u0275\u0275text"](2),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"]();N["\u0275\u0275property"]("checked",i.hideUnsetParameters),N["\u0275\u0275advance"](2),N["\u0275\u0275textInterpolate"](i.hideUnsetParameters?"Show unset parameters":"Hide unset parameters")}}function ye(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275element"](0,"i",9),N["\u0275\u0275elementStart"](1,"div",10),N["\u0275\u0275elementStart"](2,"div",11),N["\u0275\u0275listener"]("click",function(){N["\u0275\u0275restoreView"](n);var e=t.node;return N["\u0275\u0275nextContext"]().selectParameter(e)}),N["\u0275\u0275text"](3),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=t.node;N["\u0275\u0275classProp"]("la-cog",null===i.item.dependentId)("la-cogs",i.item.dependentId),N["\u0275\u0275advance"](3),N["\u0275\u0275textInterpolate1"](" ",i.item.title," ")}}function Se(e,t){if(1&e&&(N["\u0275\u0275elementStart"](0,"span",12),N["\u0275\u0275text"](1),N["\u0275\u0275elementEnd"]()),2&e){var n=N["\u0275\u0275nextContext"]();N["\u0275\u0275advance"](1),N["\u0275\u0275textInterpolate1"]("",n.data.project.title," does not contain any parameters")}}var Ne,xe=((Ne=function(){function e(t,n,i,o){r(this,e),this.dialogRef=t,this.data=n,this.cdr=i,this.parametersService=o,this.loading$=new D.a(!0),this.hideUnsetParameters=!1,this.hiddenNodeSetId=new Set,this.unsetParameters=new Set}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.destroy$=new A.b,this.parametersService.parameterList$.asObservable().pipe(Object(_.a)(this.destroy$)).subscribe(function(t){t.forEach(function(t){0===t.item.values.length&&e.unsetParameters.add(t.item.id)})})}},{key:"ngOnDestroy",value:function(){this.destroy$.next(),this.destroy$.complete(),this.loading$.complete()}},{key:"selectParameter",value:function(e){this.dialogRef.close({paramNode:e,setup:this.data.setupNode})}},{key:"checkFilter",value:function(){this.hideUnsetParameters=!this.hideUnsetParameters,this.hiddenNodeSetId=this.hideUnsetParameters?new Set(this.unsetParameters):new Set,this.cdr.detectChanges()}}]),e}()).\u0275fac=function(e){return new(e||Ne)(N["\u0275\u0275directiveInject"](u.g),N["\u0275\u0275directiveInject"](u.a),N["\u0275\u0275directiveInject"](N.ChangeDetectorRef),N["\u0275\u0275directiveInject"](ve.a))},Ne.\u0275cmp=N["\u0275\u0275defineComponent"]({type:Ne,selectors:[["m-browse-params-dialog"]],viewQuery:function(e,t){var n;1&e&&N["\u0275\u0275viewQuery"](fe,!0),2&e&&N["\u0275\u0275queryRefresh"](n=N["\u0275\u0275loadQuery"]())&&(t.tree=n.first)},decls:10,vars:7,consts:[["mat-dialog-title",""],["color","primary",3,"checked","change",4,"ngIf","ngIfElse"],["mat-dialog-content",""],[2,"max-height","80vh"],[3,"inputNodes$","hiddenNodeSet","canDrag","canAdd","canRemove"],["nodeTitleTemplate",""],["other_content",""],["color","primary",3,"checked","change"],["href","javascript:void(null)",3,"click"],[1,"las","dimmed","f-s-20"],[1,"new-in-place","monospace"],[1,"pointer","f-w-400",3,"click"],[1,"f-s-14"]],template:function(e,t){if(1&e&&(N["\u0275\u0275elementStart"](0,"h1",0),N["\u0275\u0275text"](1,"Choose parameter"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275template"](2,be,3,2,"mat-checkbox",1),N["\u0275\u0275elementStart"](3,"div",2),N["\u0275\u0275elementStart"](4,"perfect-scrollbar",3),N["\u0275\u0275elementStart"](5,"m-dynamic-tree-map",4),N["\u0275\u0275template"](6,ye,4,5,"ng-template",null,5,N["\u0275\u0275templateRefExtractor"]),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275template"](8,Se,2,1,"ng-template",null,6,N["\u0275\u0275templateRefExtractor"])),2&e){var n=N["\u0275\u0275reference"](9);N["\u0275\u0275advance"](2),N["\u0275\u0275property"]("ngIf",t.data.paramData.length>0)("ngIfElse",n),N["\u0275\u0275advance"](3),N["\u0275\u0275property"]("inputNodes$",t.parametersService.parameterTree$)("hiddenNodeSet",t.hiddenNodeSetId)("canDrag",!1)("canAdd",!1)("canRemove",!1)}},directives:[u.h,c.m,u.e,C.b,ge.a,m.a],styles:[".tree-label[_ngcontent-%COMP%]{line-height:40px}mat-nested-tree-node[_ngcontent-%COMP%], mat-tree-node[_ngcontent-%COMP%]{min-height:30px;height:35px}.m-badge[_ngcontent-%COMP%]{min-width:40px}  .ps__rail-x{visibility:hidden}.pointer[_ngcontent-%COMP%]{cursor:pointer}.mat-tree-node[_ngcontent-%COMP%]{overflow:visible;border:2px solid transparent}.dialog-tree-invisible[_ngcontent-%COMP%]{display:none}.dialog-tree[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .dialog-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;list-style-type:none}.mat-tree-node[_ngcontent-%COMP%]{color:#4a7cbe;cursor:pointer}"]}),Ne),ke=d("PSD3"),we=d.n(ke),Ce=d("wg/d"),Ie=d("65F8"),Ee=d("lPHq"),Te=d("UTw3"),Me=d("9pgZ"),Oe=d("7Z50"),Pe=d("cdP3"),Ae=d("ihCf");function De(e,t){if(1&e&&N["\u0275\u0275element"](0,"i",26),2&e){var n=N["\u0275\u0275nextContext"]().node,i=N["\u0275\u0275nextContext"]();N["\u0275\u0275property"]("matTooltip",i.tooltipTextShow(n))}}function je(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"input",24),N["\u0275\u0275listener"]("ngModelChange",function(e){return t.node.item.title=e})("click",function(){N["\u0275\u0275restoreView"](n);var e=t.node,i=N["\u0275\u0275nextContext"]();return e.item.id>0?i.setActiveTreeNode(e):null})("keyup.escape",function(e){N["\u0275\u0275restoreView"](n);var i=t.node;return N["\u0275\u0275nextContext"]().revertTreeNode(i),e.target.blur()})("keyup.enter",function(e){return e.target.blur()})("blur",function(e){N["\u0275\u0275restoreView"](n);var i=t.node;return N["\u0275\u0275nextContext"]().invalidateTreeNode(i,0===i.item.id?null:"title",e.target.value)}),N["\u0275\u0275elementEnd"](),N["\u0275\u0275template"](1,De,1,1,"i",25)}if(2&e){var i=t.node,r=N["\u0275\u0275nextContext"]();N["\u0275\u0275styleProp"]("width",i.item.title.length?i.item.title.length+2:15,"ch"),N["\u0275\u0275classProp"]("changed",0===i.item.id||r.pristineSetupStep.get(i.item.id)&&i.item.title!==r.pristineSetupStep.get(i.item.id).title)("draft",i.item.isDraft)("m-selected",r.activeNode&&i.item.id===r.activeNode.item.id),N["\u0275\u0275propertyInterpolate1"]("id","input-setup-",i.item.id,""),N["\u0275\u0275property"]("placeholder",0===i.item.title.length?"Setup step title":null)("ngModel",i.item.title),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngIf",r.tooltipTextShow(i))}}function Fe(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"div",54),N["\u0275\u0275elementStart"](1,"mat-icon",55),N["\u0275\u0275text"](2," add "),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](3,"a",56),N["\u0275\u0275listener"]("click",function(){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"](3).changeParameter()}),N["\u0275\u0275text"](4," Add parameter "),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}}function _e(e,t){if(1&e&&(N["\u0275\u0275elementContainerStart"](0),N["\u0275\u0275elementStart"](1,"div",52),N["\u0275\u0275template"](2,Fe,5,0,"div",53),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementContainerEnd"]()),2&e){var n=N["\u0275\u0275nextContext"](2),i=N["\u0275\u0275reference"](35);N["\u0275\u0275advance"](2),N["\u0275\u0275property"]("ngIf",n.parametersList.size>0)("ngIfElse",i)}}function Re(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"mat-icon",58),N["\u0275\u0275listener"]("click",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"](3);return e.deleteParameter(e.activeNode)}),N["\u0275\u0275text"](1," close "),N["\u0275\u0275elementEnd"]()}}function $e(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementContainerStart"](0),N["\u0275\u0275elementStart"](1,"div",52),N["\u0275\u0275elementStart"](2,"div",54),N["\u0275\u0275elementStart"](3,"a",56),N["\u0275\u0275listener"]("click",function(){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"](2).changeParameter()}),N["\u0275\u0275text"](4),N["\u0275\u0275elementEnd"](),N["\u0275\u0275template"](5,Re,2,0,"mat-icon",57),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementContainerEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"](2);N["\u0275\u0275advance"](4),N["\u0275\u0275textInterpolate1"](" ",i.activeParam.item.title," "),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngIf",i.activeNode.item.parameterId)}}function Ve(e,t){if(1&e&&(N["\u0275\u0275elementContainerStart"](0),N["\u0275\u0275elementContainer"](1,48),N["\u0275\u0275elementContainerEnd"]()),2&e){var n=N["\u0275\u0275nextContext"](2),i=N["\u0275\u0275reference"](31),r=N["\u0275\u0275reference"](29);N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngTemplateOutlet",(null==n.activeFileAttachments?null:n.activeFileAttachments.length)>3&&n.showMoreAttachments?i:r)}}function Le(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"as-split-area",14),N["\u0275\u0275elementStart"](1,"div",27),N["\u0275\u0275elementStart"](2,"perfect-scrollbar",16),N["\u0275\u0275elementStart"](3,"div",28),N["\u0275\u0275elementStart"](4,"div",29),N["\u0275\u0275elementStart"](5,"input",30),N["\u0275\u0275listener"]("ngModelChange",function(e){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"]().activeNode.item.title=e})("keyup.escape",function(e){N["\u0275\u0275restoreView"](n);var t=N["\u0275\u0275nextContext"]();return t.revertTreeNodeTitle(t.activeNode),e.target.blur()})("blur",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"]();return e.invalidateTreeNode(e.activeNode,"title")}),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](6,"div",31),N["\u0275\u0275elementStart"](7,"div",32),N["\u0275\u0275listener"]("click",function(){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"]().resetActiveTreeNode()}),N["\u0275\u0275element"](8,"i",33),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](9,"div",34),N["\u0275\u0275elementStart"](10,"span",35),N["\u0275\u0275text"](11),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](12,"ul",36),N["\u0275\u0275elementStart"](13,"li"),N["\u0275\u0275elementStart"](14,"div",37),N["\u0275\u0275elementStart"](15,"div",38),N["\u0275\u0275elementStart"](16,"label",39),N["\u0275\u0275text"](17,"Description"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](18,"textarea",40),N["\u0275\u0275listener"]("ngModelChange",function(e){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"]().activeNode.item.description=e})("keyup.escape",function(e){N["\u0275\u0275restoreView"](n);var t=N["\u0275\u0275nextContext"]();return t.revertTreeNodeDescription(t.activeNode),e.target.blur()})("blur",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"]();return e.invalidateTreeNode(e.activeNode,"description")}),N["\u0275\u0275text"](19,"                                            "),N["\u0275\u0275elementEnd"](),N["\u0275\u0275element"](20,"div",41),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](21,"li"),N["\u0275\u0275elementStart"](22,"div",37),N["\u0275\u0275elementStart"](23,"div",42),N["\u0275\u0275elementStart"](24,"label",43),N["\u0275\u0275text"](25,"Parameter"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementContainerStart"](26,44),N["\u0275\u0275template"](27,_e,3,2,"ng-container",45),N["\u0275\u0275template"](28,$e,6,2,"ng-container",45),N["\u0275\u0275elementContainerEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](29,"li"),N["\u0275\u0275elementStart"](30,"div",37),N["\u0275\u0275elementStart"](31,"div",42),N["\u0275\u0275elementStart"](32,"label",39),N["\u0275\u0275text"](33,"Attachments"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](34,"div",37),N["\u0275\u0275elementStart"](35,"div",46),N["\u0275\u0275template"](36,Ve,2,1,"ng-container",47),N["\u0275\u0275elementContainer"](37,48),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](38,"li",49),N["\u0275\u0275elementStart"](39,"div",37),N["\u0275\u0275elementStart"](40,"div",50),N["\u0275\u0275elementStart"](41,"label",43),N["\u0275\u0275text"](42,"Created At"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275element"](43,"input",51),N["\u0275\u0275pipe"](44,"date"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](45,"div",50),N["\u0275\u0275elementStart"](46,"label",43),N["\u0275\u0275text"](47,"Updated At"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275element"](48,"input",51),N["\u0275\u0275pipe"](49,"date"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"](),r=N["\u0275\u0275reference"](33);N["\u0275\u0275property"]("size",i.activeNode?30:0),N["\u0275\u0275advance"](5),N["\u0275\u0275classProp"]("changed",i.treeNodeChanged(i.activeNode,"title")),N["\u0275\u0275property"]("placeholder",0===i.activeNode.item.title.length?"Parameter title":null)("ngModel",i.activeNode.item.title),N["\u0275\u0275advance"](6),N["\u0275\u0275textInterpolate1"](" #",i.activeNode.item.id," "),N["\u0275\u0275advance"](7),N["\u0275\u0275classProp"]("changed",i.treeNodeChanged(i.activeNode,"description")),N["\u0275\u0275property"]("ngModel",i.activeNode.item.description),N["\u0275\u0275advance"](8),N["\u0275\u0275property"]("ngSwitch",!!i.activeParam),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngSwitchCase",!1),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngSwitchCase",!0),N["\u0275\u0275advance"](8),N["\u0275\u0275property"]("ngIf",(null==i.activeFileAttachments?null:i.activeFileAttachments.length)>0),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngTemplateOutlet",0===(null==i.activeFileAttachments?null:i.activeFileAttachments.length)?r:null),N["\u0275\u0275advance"](6),N["\u0275\u0275propertyInterpolate"]("value",N["\u0275\u0275pipeBind2"](44,16,i.activeNode.item.createdAt,"yyyy-MM-dd HH:mm")),N["\u0275\u0275advance"](5),N["\u0275\u0275propertyInterpolate"]("value",N["\u0275\u0275pipeBind2"](49,19,i.activeNode.item.updatedAt,"yyyy-MM-dd HH:mm"))}}function Be(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"img",70),N["\u0275\u0275listener"]("click",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"](2).index;return N["\u0275\u0275nextContext"](2).openGallery(e)}),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"](2).$implicit;N["\u0275\u0275propertyInterpolate1"]("src","/download/attachments/",i.thumbFilename,"",N["\u0275\u0275sanitizeUrl"])}}function ze(e,t){1&e&&(N["\u0275\u0275elementStart"](0,"div",71),N["\u0275\u0275text"](1,"File"),N["\u0275\u0275elementEnd"]())}var Je=function(e){return{title:"Confirmation",html:e,type:"question",confirmButtonText:"Delete",confirmButtonColor:"#f4516c",confirmButtonClass:"btn-danger",showCancelButton:!0,heightAuto:!1}};function Ue(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"div",64),N["\u0275\u0275elementContainerStart"](1,44),N["\u0275\u0275template"](2,Be,1,1,"img",65),N["\u0275\u0275elementStart"](3,"a",66),N["\u0275\u0275template"](4,ze,2,0,"div",67),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementContainerEnd"](),N["\u0275\u0275elementStart"](5,"div",68),N["\u0275\u0275listener"]("confirm",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"]().$implicit,t=N["\u0275\u0275nextContext"](2);return t.unlinkFileAttachment(e.id,t.activeNode.item.id)}),N["\u0275\u0275elementStart"](6,"mat-icon",69),N["\u0275\u0275text"](7,"clear"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"]().$implicit;N["\u0275\u0275property"]("matTooltip",i.originalFilename),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngSwitch",!!i.thumbFilename),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngSwitchCase",!0),N["\u0275\u0275advance"](1),N["\u0275\u0275propertyInterpolate1"]("href","/download/attachments/",i.filename,"",N["\u0275\u0275sanitizeUrl"]),N["\u0275\u0275property"]("ngSwitch",!!i.thumbFilename),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngSwitchCase",!1),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("swal",N["\u0275\u0275pureFunction1"](7,Je,"Delete <b>"+i.originalFilename+"</b>?"))}}function He(e,t){if(1&e&&(N["\u0275\u0275elementContainerStart"](0),N["\u0275\u0275template"](1,Ue,8,9,"div",63),N["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.index;N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngIf",n<3)}}function Qe(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"div",72),N["\u0275\u0275listener"]("click",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"](2);return e.showMoreAttachments=!e.showMoreAttachments}),N["\u0275\u0275elementStart"](1,"div",73),N["\u0275\u0275text"](2),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"](2);N["\u0275\u0275advance"](2),N["\u0275\u0275textInterpolate1"](" + ",(null==i.activeFileAttachments?null:i.activeFileAttachments.length)-3," ")}}function qe(e,t){1&e&&N["\u0275\u0275elementContainer"](0)}function Ye(e,t){if(1&e&&(N["\u0275\u0275elementStart"](0,"div",59),N["\u0275\u0275template"](1,He,2,1,"ng-container",60),N["\u0275\u0275template"](2,Qe,3,1,"div",61),N["\u0275\u0275template"](3,qe,1,0,"ng-container",62),N["\u0275\u0275elementEnd"]()),2&e){var n=N["\u0275\u0275nextContext"](),i=N["\u0275\u0275reference"](33);N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngForOf",n.activeFileAttachments),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngIf",(null==n.activeFileAttachments?null:n.activeFileAttachments.length)>3),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngTemplateOutlet",i)}}function Ge(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"img",70),N["\u0275\u0275listener"]("click",function(){N["\u0275\u0275restoreView"](n);var e=N["\u0275\u0275nextContext"]().index;return N["\u0275\u0275nextContext"](2).openGallery(e)}),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"]().$implicit;N["\u0275\u0275propertyInterpolate1"]("src","/download/attachments/",i.thumbFilename,"",N["\u0275\u0275sanitizeUrl"])}}function Ze(e,t){1&e&&(N["\u0275\u0275elementStart"](0,"div",71),N["\u0275\u0275text"](1,"File"),N["\u0275\u0275elementEnd"]())}function Xe(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275elementStart"](0,"div",64),N["\u0275\u0275elementContainerStart"](1,44),N["\u0275\u0275template"](2,Ge,1,1,"img",65),N["\u0275\u0275elementStart"](3,"a",66),N["\u0275\u0275template"](4,Ze,2,0,"div",67),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementContainerEnd"](),N["\u0275\u0275elementStart"](5,"div",68),N["\u0275\u0275listener"]("confirm",function(){N["\u0275\u0275restoreView"](n);var e=t.$implicit,i=N["\u0275\u0275nextContext"](2);return i.unlinkFileAttachment(e.id,i.activeNode.item.id)}),N["\u0275\u0275elementStart"](6,"mat-icon",69),N["\u0275\u0275text"](7,"clear"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;N["\u0275\u0275property"]("matTooltip",i.originalFilename),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngSwitch",!!i.thumbFilename),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngSwitchCase",!0),N["\u0275\u0275advance"](1),N["\u0275\u0275propertyInterpolate1"]("href","/download/attachments/",i.filename,"",N["\u0275\u0275sanitizeUrl"]),N["\u0275\u0275property"]("ngSwitch",!!i.thumbFilename),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngSwitchCase",!1),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("swal",N["\u0275\u0275pureFunction1"](7,Je,"Delete <b>"+i.originalFilename+"</b>?"))}}function Ke(e,t){1&e&&N["\u0275\u0275elementContainer"](0)}function We(e,t){if(1&e&&(N["\u0275\u0275template"](0,Xe,8,9,"div",74),N["\u0275\u0275template"](1,Ke,1,0,"ng-container",62)),2&e){var n=N["\u0275\u0275nextContext"](),i=N["\u0275\u0275reference"](33);N["\u0275\u0275property"]("ngForOf",n.activeFileAttachments),N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngTemplateOutlet",i)}}function et(e,t){if(1&e&&(N["\u0275\u0275elementStart"](0,"div",79),N["\u0275\u0275element"](1,"mat-progress-spinner",80),N["\u0275\u0275pipe"](2,"async"),N["\u0275\u0275elementStart"](3,"div",81),N["\u0275\u0275text"](4),N["\u0275\u0275pipe"](5,"async"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()),2&e){var n=N["\u0275\u0275nextContext"]().$implicit;N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("value",N["\u0275\u0275pipeBind1"](2,2,n.value)),N["\u0275\u0275advance"](3),N["\u0275\u0275textInterpolate1"](" ",N["\u0275\u0275pipeBind1"](5,4,n.value),"% ")}}function tt(e,t){if(1&e&&(N["\u0275\u0275elementContainerStart"](0),N["\u0275\u0275template"](1,et,6,6,"div",78),N["\u0275\u0275pipe"](2,"async"),N["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit;N["\u0275\u0275advance"](1),N["\u0275\u0275property"]("ngIf",N["\u0275\u0275pipeBind1"](2,1,n.value))}}function nt(e,t){1&e&&(N["\u0275\u0275elementStart"](0,"button",82),N["\u0275\u0275listener"]("click",function(){return(0,t.openFileSelector)()}),N["\u0275\u0275elementStart"](1,"mat-icon",83),N["\u0275\u0275text"](2,"add"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]())}function it(e,t){if(1&e){var n=N["\u0275\u0275getCurrentView"]();N["\u0275\u0275template"](0,tt,3,3,"ng-container",60),N["\u0275\u0275pipe"](1,"keyvalue"),N["\u0275\u0275elementStart"](2,"div",75),N["\u0275\u0275elementStart"](3,"ngx-file-drop",76),N["\u0275\u0275listener"]("onFileDrop",function(e){return N["\u0275\u0275restoreView"](n),N["\u0275\u0275nextContext"]().dropped(e)}),N["\u0275\u0275template"](4,nt,3,0,"ng-template",77),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"]()}if(2&e){var i=N["\u0275\u0275nextContext"]();N["\u0275\u0275property"]("ngForOf",N["\u0275\u0275pipeBind1"](1,1,i.attachmentsProgress))}}function rt(e,t){if(1&e&&(N["\u0275\u0275elementStart"](0,"span",84),N["\u0275\u0275text"](1),N["\u0275\u0275elementEnd"]()),2&e){var n=N["\u0275\u0275nextContext"]();N["\u0275\u0275advance"](1),N["\u0275\u0275textInterpolate1"]("",n.project.title," does not contain any parameters")}}var ot,at,dt=((ot=function(){function i(e,t,n,o,a,d,c,l,s,p,m,u,h,f,v,g){r(this,i),this.route=e,this.router=t,this.cdr=n,this.lightbox=o,this.hyperionAttachmentService=a,this.hyperionSetupService=d,this.hyperionParameterService=c,this.notificationService=l,this.render=s,this.uploadService=p,this.websocketService=m,this.windowRefService=u,this.dialog=h,this.accountService=f,this.setupService=v,this.parameterService=g,this.destroy$=new A.b,this.setup$=new D.a(null),this.ready$=new D.a(!1),this.pristineSetupStep=new Map,this.setupList=new Map,this.rootLevelSetupSteps=new Map,this.activeNodeId=-1,this.attachments=new Map,this.showMoreAttachments=!1,this.attachmentsProgress=new Map,this.activeAlbum=[],this.parametersTree=new Map,this.dimmedNodeSetId=new Set,this.hiddenNodeSetId=new Set}return a(i,[{key:"ngOnInit",value:function(){var e=this;this.accountService.profile$.asObservable().pipe(Object(_.a)(this.destroy$)).subscribe(function(t){return e.profile=t}),Object(j.b)([this.setupService.flatSetup$,this.setupService.setupList$,this.parameterService.parameterTree$,this.parameterService.parameterList$]).pipe(Object(R.a)(function(e){var n=t(e,4),i=n[0],r=n[1],o=n[2],a=n[3];return!!(i&&r&&o&&a)}),Object(_.a)(this.destroy$)).subscribe(function(n){var i=t(n,4),r=i[0],o=i[1],a=i[2],d=i[3];e.pristineSetupStep.clear(),r.forEach(function(t){return e.pristineSetupStep.set(t.id,G.m.fromJson(t.toJson()))}),e.setupList=o,e.parametersTree=a,e.parametersList=d,e.ready$.next(!0)}),this.route.data.pipe(Object(_.a)(this.destroy$)).subscribe(function(t){return e.initialize(t.activeProject)}),this.setupService.setupTree$.asObservable().pipe(Object(R.a)(function(e){return!!e}),Object(_.a)(this.destroy$)).subscribe(function(t){e.rootLevelSetupSteps.clear(),t.forEach(function(t){return e.rootLevelSetupSteps.set(t.item.id,t.item)})}),Object(j.b)(this.route.data,this.route.queryParamMap).pipe(Object(_.a)(this.destroy$)).subscribe(function(n){var i=t(n,2),r=(i[0],i[1]);e.activeQueryId=parseInt(r.get("id"),10)}),Object(F.a)(this.websocketService.setupStepUpdated,this.websocketService.setupStepDeleted).pipe(Object(_.a)(this.destroy$),Object(R.a)(function(t){return t.data.projectId===e.project.id})).subscribe(function(t){var n=new Te.i;n.item=t.data,t instanceof Ie.n?-1!==e.activeNodeId&&n.item.id===e.activeNodeId&&e.profile.username!==t.actorName&&we.a.fire({type:"information",title:"Your active node has been changed by "+t.actorName,confirmButtonText:"ok"}).then(function(t){void 0!==t.value&&e.setActiveTreeNode(n)}):t instanceof Ie.m&&e.activeNode&&n.item.id===e.activeNode.item.id&&e.profile.username!==t.actorName&&we.a.fire({type:"warning",title:"Your active node has been deleted by "+t.actorName,confirmButtonText:"ok"}).then(function(t){void 0!==t.value&&e.resetActiveTreeNode()})}),Object(F.a)(this.websocketService.attachmentLinked,this.websocketService.attachmentUnlinked).pipe(Object(_.a)(this.destroy$),Object(R.a)(function(e){return e.link.owner===G.b.SetupStep})).subscribe(function(t){if(e.attachments.has(t.link.linkedId)){var n=e.attachments.get(t.link.linkedId),i=n.findIndex(function(e){return e.id===t.attachment.id});t instanceof Ie.a?i>=0?n[i]=t.attachment:n.push(t.attachment):t instanceof Ie.b&&-1!==i&&n.splice(i,1),e.attachments.set(t.link.linkedId,n),e.activeNode.item.id&&e.activeNode.item.id===t.link.linkedId&&(e.activeFileAttachments=n),e.cdr.detectChanges()}})}},{key:"ngOnDestroy",value:function(){this.destroy$.next(),this.destroy$.complete(),this.setup$.complete(),this.ready$.complete()}},{key:"initialize",value:function(e){this.project=e,this.activeNode=null,this.activeNodeId=-1}},{key:"openGallery",value:function(e){var t=this;this.activeFileAttachments.filter(function(e){return e.contentType.includes("image")}).forEach(function(e){t.activeAlbum.push({src:"/download/attachments/"+e.filename,caption:e.originalFilename,thumb:"/download/attachments/"+e.thumbFilename})}),this.lightbox.open(this.activeAlbum,e)}},{key:"getAllChildrenId",value:function(t){var n=this;return t.children.reduce(function(t,i){return[].concat(e(t),[[i.item.id],i.children.map(function(e){return n.getAllChildrenId(e)}).reduce(function(e,t){return e.concat(t)},[])])},[]).concat(t.item.id).reduce(function(e,t){return e.concat(t)},[])}},{key:"getAllParentId",value:function(e){for(var t=[];e&&0!==e.item.parentId;){var n=this.setupList.get(e.item.parentId);t.push(n?n.item.id:null),e=n}return t.filter(function(e){return!!e})}},{key:"applyFilter",value:function(e){var t=this;this.dimmedNodeSetId=new Set(Array.from(this.pristineSetupStep).map(function(n){return t.filterCallback(n[1],e)?null:n[1].id})),this.hiddenNodeSetId=new Set(Array.from(this.setupList).filter(function(e){return t.getAllChildrenId(e[1]).every(function(e){return t.dimmedNodeSetId.has(e)})}).map(function(e){return e[1].item.id})),this.expandAllTreeNodes()}},{key:"showChildrenBeforeAddDraftNode",value:function(e){var t=this;e?e.children.forEach(function(e){return t.hiddenNodeSetId.delete(e.item.id)}):this.hiddenNodeSetId.forEach(function(e){null===t.pristineSetupStep.get(e).parentId&&t.hiddenNodeSetId.delete(e)}),this.cdr.detectChanges()}},{key:"initializeTreeNode",value:function(t){var n=new Te.i,i=new G.m;return i.id=0,i.parentId=t?t.item.id:null,i.projectId=this.project.id,i.title="",i.description=null,i.orderNum=t?t.children.length?t.children.slice(-1)[0].item.orderNum+1e3:1e3:this.rootLevelSetupSteps.size?e(this.rootLevelSetupSteps.entries()).map(function(e){return e[1]}).sort(function(e,t){return e.orderNum>t.orderNum?1:-1}).slice(-1)[0].orderNum+1e3:1e3,n.item=i,n.children=[],n}},{key:"treeNodeHasDraftChildren",value:function(e){return e?e.children.filter(function(e){return 0===e.item.id}).length>0:this.rootLevelSetupSteps.has(0)}},{key:"treeNodeChanged",value:function(e,t){var n=this.pristineSetupStep.get(e.item.id);if(t&&"title"!==t&&"description"!==t&&"isDraft"!==t)return!1;if(!n)return!0;switch(t){case"title":return(n.title||"").trim()!==(e.item.title||"").trim();case"description":return(n.description||"").trim()!==(e.item.description||"").trim();case"isDraft":return n.isDraft!==e.item.isDraft;default:return(n.title||"").trim()!==(e.item.title||"").trim()||(n.description||"").trim()!==(e.item.description||"").trim()}}},{key:"canSubmitTreeNode",value:function(e,t){if(t&&"title"!==t&&"description"!==t&&"isDraft"!==t)return!1;switch(t){case"description":case"isDraft":return!0;case"title":default:return(e.item.title||"").trim().length>0}}},{key:"addDraftTreeNode",value:function(e){var t=e?this.setupList.get(e):null;this.resetActiveTreeNode(),t&&this.showChildrenBeforeAddDraftNode(t);var n=this.initializeTreeNode(t);t?this.setupService.addDraftSetupStep(n,t):this.setupService.addDraftSetupStep(n),this.cdr.detectChanges(),this.windowRefService.focusElementById("input-setup-0",100)}},{key:"revertTreeNode",value:function(e){var t=this.pristineSetupStep.get(e.item.id);e.item.title=t?t.title:"",e.item.description=t?t.description:null,this.activeNode=null,this.activeNodeId=-1,this.cdr.detectChanges()}},{key:"revertTreeNodeTitle",value:function(e){var t=this.pristineSetupStep.get(e.item.id);e.item.title=t?t.title:"",this.cdr.detectChanges()}},{key:"revertTreeNodeDescription",value:function(e){var t=this.pristineSetupStep.get(e.item.id);e.item.description=t?t.description:null,this.cdr.detectChanges()}},{key:"invalidateTreeNode",value:function(e,t,n){var i=this.pristineSetupStep.get(e.item.id);null!==t&&"title"!==t||!n||(e.item.title=n.trim(),0!==(e.item.title||"").trim().length)?this.treeNodeChanged(e,t)&&this.canSubmitTreeNode(e,t)&&(0===e.item.id?this.createTreeNode(e):this.updateSetupStep(e,t)):e.item.title=i?i.title:""}},{key:"setActiveTreeNode",value:function(e){e.item.id&&this.router.navigate([],{queryParams:{id:e.item.id},replaceUrl:!0,queryParamsHandling:"merge"}),this.activeNode=e,this.activeNodeId=e.item.id,this.setActiveParamNode(e),this.showMoreAttachments=!1,this.attachments.has(this.activeNode.item.id)&&(this.activeFileAttachments=this.attachments.get(this.activeNode.item.id)),this.getLinkedAttachments(this.activeNode.item.id)}},{key:"resetActiveTreeNode",value:function(){this.activeNode=null,this.activeNodeId=-1,this.activeParam=null,this.activeQueryId=null,this.cdr.detectChanges()}},{key:"getOrderNum",value:function(t,n){switch(n){case q.a.Before:if(t.item.parentId){var i=this.setupList.get(t.item.parentId).children.indexOf(t);return 0===i?1e3:Math.round((t.item.orderNum+this.setupList.get(t.item.parentId).children[i-1].item.orderNum)/2)}var r=e(this.rootLevelSetupSteps.entries()).map(function(e){return e[1]}).findIndex(function(e){return e.id===t.item.id});return 0===r?1e3:Math.round((t.item.orderNum+e(this.rootLevelSetupSteps.entries()).map(function(e){return e[1]})[r-1].orderNum)/2);case q.a.After:if(t.item.parentId){var o=this.setupList.get(t.item.parentId).children.indexOf(t);return o===this.setupList.get(t.item.parentId).children.length-1?t.item.orderNum+1e3:Math.round((t.item.orderNum+this.setupList.get(t.item.parentId).children[o+1].item.orderNum)/2)}var a=e(this.rootLevelSetupSteps.entries()).map(function(e){return e[1]}).findIndex(function(e){return e.id===t.item.id});return a===this.rootLevelSetupSteps.size-1?t.item.orderNum+1e3:Math.round((t.item.orderNum+e(this.rootLevelSetupSteps.entries()).map(function(e){return e[1]})[a+1].orderNum)/2)}}},{key:"dropped",value:function(e){var t,i=this,r=function(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=n(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,d=!0,c=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return d=e.done,e},e:function(e){c=!0,a=e},f:function(){try{d||null==i.return||i.return()}finally{if(c)throw a}}}}(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.fileEntry.isFile&&function(){var e=o.fileEntry,t=new D.a(0);i.attachmentsProgress.set(o.fileEntry.name,t),e.file(function(e){i.uploadService.uploadAttachment(e,G.b.SetupStep,i.activeNode.item.id).pipe(Object(_.a)(i.destroy$),Object(R.a)(function(e){return e.type===P.d.UploadProgress}),Object($.a)(function(){t.complete(),i.attachmentsProgress.delete(e.name),i.cdr.detectChanges()})).subscribe(function(e){var n=Math.round(100*e.loaded/e.total);t.next(n)},function(t){return i.notificationService.warning("Failed to upload attachment error: "+e.name)})})}()}}catch(a){r.e(a)}finally{r.f()}}},{key:"createTreeNode",value:function(e){var t=this,n=new Ee.a;n.parentId=e.item.parentId,n.title=null===e.item.title?null:e.item.title.trim(),n.description=null===e.item.description?null:e.item.description.trim(),n.isDraft=!1,n.orderNum=e.item.orderNum,this.hyperionSetupService.createSetupStep(n,e.item.projectId).pipe(Object(_.a)(this.destroy$)).subscribe(function(e){t.activeQueryId=e.id,t.activeNode={children:[],item:{description:e.description,id:e.id,isDraft:e.isDraft,orderNum:e.orderNum,parameterId:e.parameterId,parentId:e.parentId,projectId:e.projectId,rev:e.rev,title:e.title,createdAt:e.createdAt,updatedAt:e.updatedAt}},t.activeNodeId=e.id,t.notificationService.success("Setup step created"),t.setupService.clearDraftNode(e.parentId)},function(e){if(e instanceof Te.a){var n=null;switch(e.error){case Ee.b.ParentNotExists:n="Setup step does not exist";break;case Ee.b.ProjectNotExists:n="Project does not exist";break;case Ee.b.TitleAlreadyExists:n="Setup step title already exists";break;case Ee.b.HasChildren:n="Setup step has children"}t.notificationService.error(n||e)}else t.notificationService.error(e)})}},{key:"updateSetupStep",value:function(e,t,n,i){var r=this,o=new Ee.d,a=this.pristineSetupStep.get(e.item.id);o.parentId=n?-1===n?null:n:e.item.parentId!==a.parentId?e.item.parentId:a.parentId,o.orderNum=i||(e.item.orderNum!==a.orderNum?e.item.orderNum:a.orderNum),e.item.title===a.title||null!==t&&"title"!==t||(o.title=e.item.title),e.item.description===a.description||null!==t&&"description"!==t||(o.description=e.item.description),e.item.isDraft===a.isDraft||null!==t&&"isDraft"!==t||(o.isDraft=e.item.isDraft),this.hyperionSetupService.updateSetupStep(o,e.item.id).pipe(Object(_.a)(this.destroy$)).subscribe(function(e){r.notificationService.success("Setup step updated")},function(e){if(e instanceof Te.a){var t=null;switch(e.error){case Ee.b.ParentNotExists:t="Setup step does not exist";break;case Ee.b.ProjectNotExists:t="Project does not exist";break;case Ee.b.TitleAlreadyExists:t="Setup step title already exists";break;case Ee.b.HasChildren:t="Setup step has children"}r.notificationService.error(t||e)}else r.notificationService.error(e)})}},{key:"deleteSetupStep",value:function(e){var t=this;if(0===e.item.id)return this.setupService.clearDraftNode(e.item.parentId?e.item.parentId:null),e===this.activeNode&&(this.activeNode=null,this.activeNodeId=-1),void this.cdr.detectChanges();this.hyperionSetupService.deleteSetupStep(e.item.id).pipe(Object(_.a)(this.destroy$)).subscribe(function(e){t.activeNode=null,t.activeNodeId=-1,t.notificationService.success("Setup step deleted")},function(e){e instanceof Te.a&&e.error===Ee.b.HasChildren?t.notificationService.warning("Setup step can not be deleted because has children"):e instanceof Te.g?(t.notificationService.warning("Setup step is not found. Maybe it was deleted already"),t.cdr.detectChanges()):t.notificationService.error("Probably used in test case or other server error")})}},{key:"getLinkedAttachments",value:function(e){var t=this;0!==e&&this.hyperionAttachmentService.getLinkedAttachments(G.b.SetupStep,e).pipe(Object(_.a)(this.destroy$)).subscribe(function(n){t.attachments.set(e,n.items),t.activeFileAttachments=n.items,t.cdr.detectChanges()},function(e){return t.notificationService.error(e)})}},{key:"unlinkFileAttachment",value:function(e,t){var n=this;this.hyperionAttachmentService.deleteAttachmentLink(e,G.b.SetupStep,t).pipe(Object(_.a)(this.destroy$)).subscribe(function(t){n.activeFileAttachments=n.activeFileAttachments.filter(function(t){return t.id!==e}),n.cdr.detectChanges()},function(e){return n.notificationService.error(e)})}},{key:"expandAllTreeNodes",value:function(){this.dynamicTree.expandTreeNodes()}},{key:"collapseAllTreeNodes",value:function(){this.dynamicTree.collapseTreeNodes()}},{key:"filterCallback",value:function(e,t){return!t||e.title.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1}},{key:"orderingCallback",value:function(e,t){return e.item.orderNum>t.item.orderNum?1:-1}},{key:"updateAfterDrop",value:function(t){var n=t.dropType,i=t.draggedNode,r=t.targetNode,o=null,a=null;switch(n){case q.a.Before:case q.a.After:a=r.item.parentId,o=this.getOrderNum(r,n);break;case q.a.Into:a=r.item.id,o=r.children.length?r.children.slice(-1)[0].item.orderNum+1e3:1e3;break;case q.a.Root:a=-1,o=e(this.rootLevelSetupSteps.entries()).map(function(e){return e[1]}).sort(function(e,t){return e.orderNum>t.orderNum?1:-1}).slice(-1)[0].orderNum+1e3}this.updateSetupStep(i,null,a,o)}},{key:"showNotification",value:function(e){var t=e.message;switch(e.type){case z.b.Success:this.notificationService.success(t);break;case z.b.Info:this.notificationService.info(t);break;case z.b.Warning:this.notificationService.warning(t);break;case z.b.Error:this.notificationService.error(t)}}},{key:"updateParameter",value:function(e,t){var n=this;this.hyperionSetupService.linkSetupStepToParameter(new Ce.a,e.item.id,t).pipe(Object(_.a)(this.destroy$)).subscribe(function(t){n.notificationService.success("Parameter linked"),e.item.parameterId=t.parameterId,n.setActiveParamNode(e)})}},{key:"deleteParameter",value:function(e){var t=this;this.hyperionSetupService.unlinkSetupStepFromParameter(new Ce.a,e.item.id).pipe(Object(_.a)(this.destroy$)).subscribe(function(e){t.notificationService.success("Parameter unlinked"),t.activeParam=null})}},{key:"changeParameter",value:function(){var e=this;this.dialog.open(xe,{width:"850px",autoFocus:!1,data:{project:this.project,paramData:this.getMapAsIterable(this.parametersTree),setupNode:this.activeNode}}).afterClosed().pipe(Object(_.a)(this.destroy$)).subscribe(function(t){t&&t.paramNode&&e.updateParameter(t.setup,t.paramNode.item.id)})}},{key:"getMapAsIterable",value:function(e){var t=[];return e.forEach(function(e){return t.push(e)}),t.sort(function(e,t){return e.id-t.id}),t}},{key:"setActiveParamNode",value:function(e){this.activeParam=e.item.parameterId?this.parametersList.get(e.item.parameterId):null}},{key:"focusSetup",value:function(){var e=this;this.activeQueryId&&this.ready$.asObservable().pipe(Object(R.a)(function(e){return!!e}),Object(_.a)(this.destroy$)).subscribe(function(){var t=e.setupList.get(e.activeQueryId);if(t){var n=e.getAllParentId(t);e.dynamicTree.expandTreeNodesById(n),setTimeout(function(){var n=e.render.selectRootElement("#input-setup-"+t.item.id);setTimeout(function(){return n.focus()},10),e.setActiveTreeNode(t)},20)}else e.router.navigate([],{queryParams:{id:null},replaceUrl:!0,queryParamsHandling:"merge"})})}},{key:"tooltipTextShow",value:function(e){var t;if((null===(t=this.parametersList)||void 0===t?void 0:t.size)>0){if(!(e.item.parameterId&&this.parametersList.get(e.item.parameterId)&&this.parametersList.get(e.item.parameterId).item.dependentId))return null;var n=this.parametersList.get(e.item.parameterId).item,i=this.parametersList.get(this.parametersList.get(e.item.parameterId).item.dependentId).item;return this.isSetDependOnParameter(e,i.id)?null:"["+n.title+"] parameter depends on ["+i.title+"] parameter which is not set for any of the parent setup steps"}}},{key:"isSetDependOnParameter",value:function(e,t){return e.item.parameterId===t||!!e.item.parentId&&this.isSetDependOnParameter(this.setupList.get(e.item.parentId),t)}},{key:"afterTreeRendered",value:function(e){e&&this.focusSetup()}}]),i}()).\u0275fac=function(e){return new(e||ot)(N["\u0275\u0275directiveInject"](s.a),N["\u0275\u0275directiveInject"](s.g),N["\u0275\u0275directiveInject"](N.ChangeDetectorRef),N["\u0275\u0275directiveInject"](S.Lightbox),N["\u0275\u0275directiveInject"](L.a),N["\u0275\u0275directiveInject"](B.a),N["\u0275\u0275directiveInject"](J.a),N["\u0275\u0275directiveInject"](z.a),N["\u0275\u0275directiveInject"](N.Renderer2),N["\u0275\u0275directiveInject"](U.a),N["\u0275\u0275directiveInject"](H.a),N["\u0275\u0275directiveInject"](Q.a),N["\u0275\u0275directiveInject"](u.b),N["\u0275\u0275directiveInject"](Me.a),N["\u0275\u0275directiveInject"](Oe.a),N["\u0275\u0275directiveInject"](ve.a))},ot.\u0275cmp=N["\u0275\u0275defineComponent"]({type:ot,selectors:[["m-setup-page"]],viewQuery:function(e,t){var n;1&e&&(N["\u0275\u0275viewQuery"](V.b,!0),N["\u0275\u0275staticViewQuery"](ge.a,!0)),2&e&&(N["\u0275\u0275queryRefresh"](n=N["\u0275\u0275loadQuery"]())&&(t.trigger=n.first),N["\u0275\u0275queryRefresh"](n=N["\u0275\u0275loadQuery"]())&&(t.dynamicTree=n.first))},decls:36,vars:13,consts:[[1,"m-portlet","mb-0"],[1,"m-portlet__head","compact","align-items-center"],[1,"d-inline-flex"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"ml-2","m-button-group"],["mat-raised-button","",3,"click"],[1,"m-portlet__head-tools"],[1,"m-portlet__nav"],[1,"pr-2"],["floatLabel","never",2,"width","300px"],["matInput","","placeholder","Type to filter...",3,"ngModel","ngModelChange","keyup"],[1,"m-portlet__nav-item"],[1,"d-flex"],["unit","percent","direction","horizontal"],[3,"size"],[1,"pt-2","col-12","left-split-content"],[2,"height","70vh"],[3,"inputNodes$","flatNodes","hiddenNodeSet","dimmedNodeSet","canDrag","nodeAdded","nodeRemoved","nodeModified","showNotification","treeRendered"],["nodeTitleTemplate",""],[3,"size",4,"ngIf"],["lessAttachments",""],["moreAttachments",""],["uploadButton",""],["notParameters",""],["type","text",1,"monospace","new-in-place",2,"max-width","100ch !important","padding-left","5px !important",3,"id","placeholder","ngModel","ngModelChange","click","keyup.escape","keyup.enter","blur"],["class","las la-exclamation-triangle c-warning f-s-20","matTooltipPosition","above",3,"matTooltip",4,"ngIf"],["matTooltipPosition","above",1,"las","la-exclamation-triangle","c-warning","f-s-20",3,"matTooltip"],[1,"col","pt-3","right-split-content"],[1,"sticky-block"],[1,"title-container"],["matInput","","type","text",1,"form-control","inline-block",2,"max-width","65%",3,"placeholder","ngModel","ngModelChange","keyup.escape","blur"],[1,"block","text-right",2,"width","35%"],[1,"",3,"click"],[1,"las","la-times"],[1,"block","text-left"],[1,"sticky-id","dimmed"],[1,"basic-tree","pl-0"],[1,"row"],[1,"col-md-12"],[1,"f-w-600","block"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","2","cdkAutosizeMaxRows","6","placeholder","Put some text here",1,"form-control",3,"ngModel","ngModelChange","keyup.escape","blur"],[1,"textarea-border"],[1,"col-md-12","mini"],[1,"f-w-600","block","mb-0"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"col-md-12","mt-1",2,"display","flex","flex-wrap","wrap"],[4,"ngIf"],[3,"ngTemplateOutlet"],[1,"created-updated-row"],[1,"col-md-6"],["matInput","","type","text","readonly","",1,"form-control",3,"value"],[1,"param-select-wrapper"],["class","param-select",4,"ngIf","ngIfElse"],[1,"param-select"],[1,"node-add-icon","param-add-icon","c-success","f-w-600"],["href","javascript:void(null)",1,"f-w-400",3,"click"],["class","param-delete-icon c-error align-text-bottom clickable animate","style","height: 21px",3,"click",4,"ngIf"],[1,"param-delete-icon","c-error","align-text-bottom","clickable","animate",2,"height","21px",3,"click"],[1,"row","m-0"],[4,"ngFor","ngForOf"],["class","attachment-count-container clickable mr-1 mb-1 animate",3,"click",4,"ngIf"],[4,"ngTemplateOutlet"],["class","thumb mr-1 mb-1 inline-block animate clickable","matTooltipPosition","above",3,"matTooltip",4,"ngIf"],["matTooltipPosition","above",1,"thumb","mr-1","mb-1","inline-block","animate","clickable",3,"matTooltip"],[3,"src","click",4,"ngSwitchCase"],["target","_blank",3,"href","ngSwitch"],["class","placeholder inline-block",4,"ngSwitchCase"],[1,"delete","animate",3,"swal","confirm"],[1,"animate","c-white"],[3,"src","click"],[1,"placeholder","inline-block"],[1,"attachment-count-container","clickable","mr-1","mb-1","animate",3,"click"],[1,"attachment-count-label","animate"],["class","thumb mr-1 mb-1 inline-block animate clickable","matTooltipPosition","above",3,"matTooltip",4,"ngFor","ngForOf"],[1,"uploader","compact","inline-block","clickable","mb-1"],["dropZoneLabel","Drop files here",3,"onFileDrop"],["ngx-file-drop-content-tmp",""],["class","progress-conteiner mr-1 mb-1",4,"ngIf"],[1,"progress-conteiner","mr-1","mb-1"],["color","primary","mode","determinate",3,"value"],[1,"progress-percent"],["mat-icon-button","","color","primary",1,"animate",3,"click"],[1,"animate"],[1,"f-s-12"]],template:function(e,t){1&e&&(N["\u0275\u0275elementStart"](0,"div",0),N["\u0275\u0275elementStart"](1,"div",1),N["\u0275\u0275elementStart"](2,"div",2),N["\u0275\u0275elementStart"](3,"div"),N["\u0275\u0275elementStart"](4,"button",3),N["\u0275\u0275listener"]("click",function(){return t.addDraftTreeNode(null)}),N["\u0275\u0275text"](5," Add setup step "),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](6,"div",4),N["\u0275\u0275elementStart"](7,"button",5),N["\u0275\u0275listener"]("click",function(){return t.collapseAllTreeNodes()}),N["\u0275\u0275text"](8,"Collapse"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](9,"button",5),N["\u0275\u0275listener"]("click",function(){return t.expandAllTreeNodes()}),N["\u0275\u0275text"](10,"Expand"),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](11,"div",6),N["\u0275\u0275elementStart"](12,"ul",7),N["\u0275\u0275elementStart"](13,"li"),N["\u0275\u0275elementStart"](14,"div",8),N["\u0275\u0275elementStart"](15,"mat-form-field",9),N["\u0275\u0275elementStart"](16,"input",10),N["\u0275\u0275listener"]("ngModelChange",function(e){return t.filterText=e})("keyup",function(e){return t.applyFilter(e.target.value)}),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275element"](17,"li",11),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementStart"](18,"div",12),N["\u0275\u0275elementStart"](19,"as-split",13),N["\u0275\u0275elementStart"](20,"as-split-area",14),N["\u0275\u0275elementStart"](21,"div",15),N["\u0275\u0275elementStart"](22,"perfect-scrollbar",16),N["\u0275\u0275elementStart"](23,"m-dynamic-tree-map",17),N["\u0275\u0275listener"]("nodeAdded",function(e){return t.addDraftTreeNode(e)})("nodeRemoved",function(e){return t.deleteSetupStep(e)})("nodeModified",function(e){return t.updateAfterDrop(e)})("showNotification",function(e){return t.showNotification(e)})("treeRendered",function(e){return t.afterTreeRendered(e)}),N["\u0275\u0275pipe"](24,"async"),N["\u0275\u0275template"](25,je,2,12,"ng-template",null,18,N["\u0275\u0275templateRefExtractor"]),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275template"](27,Le,50,22,"as-split-area",19),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275elementEnd"](),N["\u0275\u0275template"](28,Ye,4,3,"ng-template",null,20,N["\u0275\u0275templateRefExtractor"]),N["\u0275\u0275template"](30,We,2,2,"ng-template",null,21,N["\u0275\u0275templateRefExtractor"]),N["\u0275\u0275template"](32,it,5,3,"ng-template",null,22,N["\u0275\u0275templateRefExtractor"]),N["\u0275\u0275template"](34,rt,2,1,"ng-template",null,23,N["\u0275\u0275templateRefExtractor"])),2&e&&(N["\u0275\u0275advance"](4),N["\u0275\u0275property"]("disabled",t.treeNodeHasDraftChildren(null)),N["\u0275\u0275advance"](12),N["\u0275\u0275property"]("ngModel",t.filterText),N["\u0275\u0275advance"](4),N["\u0275\u0275property"]("size",t.activeNode?70:100),N["\u0275\u0275advance"](1),N["\u0275\u0275classProp"]("darken",t.activeNode),N["\u0275\u0275advance"](2),N["\u0275\u0275property"]("inputNodes$",t.setupService.setupTree$)("flatNodes",N["\u0275\u0275pipeBind1"](24,11,t.setupService.flatSetup$))("hiddenNodeSet",t.hiddenNodeSetId)("dimmedNodeSet",t.dimmedNodeSetId)("canDrag",!0),N["\u0275\u0275advance"](4),N["\u0275\u0275property"]("ngIf",t.activeNode))},directives:[p.a,h.b,v.b,l.c,l.i,l.l,Pe.c,Pe.b,C.b,ge.a,c.m,b.a,Ae.b,c.o,c.p,c.r,f.a,c.l,I.b,w.a,w.b,g.a],pipes:[c.b,c.e,c.g],styles:[".non-sticky-block[_ngcontent-%COMP%]{margin-left:-15px;transition:background-color 125ms linear}.sticky-block-parent[_ngcontent-%COMP%]{box-shadow:-5px 0 5px -5px rgba(51,51,51,.25),0 0 5px 0 rgba(51,51,51,.25);padding-right:0;border:1px solid #fff;height:80vh;overflow-y:auto;overflow-x:hidden;margin-top:-28px}.sticky-block[_ngcontent-%COMP%], .sticky-block-parent[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:100px}.sticky-block[_ngcontent-%COMP%]{display:block;z-index:100}.darken[_ngcontent-%COMP%]{background-color:rgba(176,196,222,.125)}.small-line[_ngcontent-%COMP%]{line-height:21px}.btn-save[_ngcontent-%COMP%]{position:relative;z-index:10;top:32px;left:363px;border-radius:5px;background-color:#fff;padding:0}.btn-save[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#f1f1f1;transition:.2s}  .basic-tree>li div>ul,   .basic-tree>li div>ul>li{list-style-type:disc!important}  .basic-tree>li div>ol,   .basic-tree>li div>ol>li{list-style-type:decimal!important}  .ps__rail-x{visibility:hidden}.mat-tree-node[_ngcontent-%COMP%]{overflow:visible;border:2px solid transparent}.vertical-text[_ngcontent-%COMP%]{transform:rotate(90deg);transform-origin:left top 0}input.m-selected[_ngcontent-%COMP%]{background-color:#f5f7fa!important;border:1px solid #d3d3d3!important;box-shadow:0 0 7px 0 #d3d3d3!important}.draft[_ngcontent-%COMP%]{color:#ff8949;font-style:italic}.progress-percent[_ngcontent-%COMP%]{text-align:center;top:-60%;z-index:500;display:block;position:relative;font-size:16px}.progress-container[_ngcontent-%COMP%]{display:inline-block;height:100px;color:#0782d0;width:100px!important;height:100px!important;border:1px solid rgba(7,130,208,.25)!important;border-radius:8px!important;transition:all .125s linear}.align-icon[_ngcontent-%COMP%]{justify-content:center!important;background-repeat:no-repeat!important;display:flex!important;fill:currentColor!important;height:18px!important;width:18px!important;align-items:center!important}.m-portlet__preview[_ngcontent-%COMP%]{padding-right:0!important}.la-close-s-f[_ngcontent-%COMP%]{font-size:24px;color:#c4c5d6}.la-close-s-f[_ngcontent-%COMP%]:hover{cursor:pointer;font-size:24px;color:#a5a6b7}"],changeDetection:0}),ot),ct=d("NuMO"),lt=((at=function e(){r(this,e)}).\u0275mod=N["\u0275\u0275defineNgModule"]({type:at}),at.\u0275inj=N["\u0275\u0275defineInjector"]({factory:function(e){return new(e||at)},providers:[],imports:[[c.c,l.e,p.b,m.b,h.d,f.b,v.c,g.b,b.b,y.c,S.LightboxModule,w.c,k,I.c,C.c,T.a,M.a,E.a,s.i.forChild([{path:"**",component:dt,resolve:{activeProject:O.a},canActivate:[ct.a]}]),Pe.a,u.f]]}),at)}}])}();