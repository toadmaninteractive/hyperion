(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"l+rH":function(e,t,i){"use strict";i.r(t),i.d(t,"TestCasesModule",function(){return Nt});var n=i("ofXK"),r=i("3Pt+"),a=i("tyNb"),o=i("bTqV"),s=i("bSwM"),d=i("0IaG"),c=i("f0Cb"),l=i("kmnG"),p=i("NFeN"),m=i("qFsG"),u=i("STbY"),h=i("Xa2L"),f=i("d3UM"),v=i("Qu3c"),g=i("8yBR"),x=i("QJFE"),S=i("bFKe"),C=i("gfTr"),b=i("m3o8"),I=i("PCNd"),y=i("j1ZV"),w=i("0Y/I"),N=i("sUzd"),T=i("tk/3"),E=i("XNiG"),k=i("2Vo4"),P=i("itXk"),M=i("VRyK"),A=i("z6cu"),j=i("1G5W"),V=i("pLZG"),O=i("nYR2"),$=i("eIep"),D=i("IzEk"),F=i("PSD3"),R=i.n(F),L=i("EPMp"),z=i("Y4+Y"),_=i("Sw3e"),B=i("Ehhc"),W=i("65F8"),G=i("lPHq"),H=i("e18D"),U=i("UTw3"),q=i("0bxZ"),Q=i("7Z50"),Y=i("fXoL"),J=i("QyQT");function Z(e,t){1&e&&Y["\u0275\u0275element"](0,"i",12)}function X(e,t){1&e&&(Y["\u0275\u0275elementStart"](0,"span",13),Y["\u0275\u0275text"](1," Current "),Y["\u0275\u0275elementEnd"]())}function K(e,t){1&e&&(Y["\u0275\u0275elementStart"](0,"span",14),Y["\u0275\u0275text"](1," Precondition "),Y["\u0275\u0275elementEnd"]())}function ee(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"a",15),Y["\u0275\u0275listener"]("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]().node;return Y["\u0275\u0275nextContext"]().chooseSetup(t)}),Y["\u0275\u0275text"](1),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"]().node;Y["\u0275\u0275property"]("id","link-setup-"+e.item.id),Y["\u0275\u0275advance"](1),Y["\u0275\u0275textInterpolate1"](" ",e.item.title," ")}}function te(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"input",16),Y["\u0275\u0275listener"]("ngModelChange",function(t){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().node.item.title=t})("keyup.enter",function(e){return e.target.blur()})("blur",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]().node;return Y["\u0275\u0275nextContext"]().invalidateTreeNode(t,"title")}),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"]().node;Y["\u0275\u0275styleProp"]("width",e.item.title.length?e.item.title.length+2:20,"ch"),Y["\u0275\u0275property"]("placeholder","Put some text here")("ngModel",e.item.title)}}function ie(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"div",6),Y["\u0275\u0275template"](1,Z,1,0,"i",7),Y["\u0275\u0275template"](2,X,2,0,"span",8),Y["\u0275\u0275template"](3,K,2,0,"span",9),Y["\u0275\u0275template"](4,ee,2,2,"a",10),Y["\u0275\u0275template"](5,te,1,4,"input",11),Y["\u0275\u0275elementEnd"]()),2&e){const e=t.node,i=Y["\u0275\u0275nextContext"]();Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",e.item.parameterId>0),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",e.item.id===i.data.setupId),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",e.item.id===i.data.preconditionId),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",e.item.id>0),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",0===e.item.id)}}let ne=(()=>{class e{constructor(e,t,i,n,r,a,o,s,d){this.dialogRef=e,this.data=t,this.cdr=i,this.router=n,this.hyperionSetupService=r,this.notificationService=a,this.websocketService=o,this.windowRefService=s,this.setupService=d,this.setupsItems=new Array,this.setupList=new Map}ngOnInit(){this.destroy$=new E.b,Object(M.a)(this.websocketService.testCaseDeleted,this.websocketService.testCaseUpdated).pipe(Object(j.a)(this.destroy$),Object(V.a)(e=>this.data.project.id===e.data.projectId&&this.data.testCaseId===e.data.id)).subscribe(e=>{e instanceof W.p?R.a.fire("Test case has been deleted",`by <strong>${e.actorName}</strong>`,"info").then(()=>this.dialogRef.close(null)):e instanceof W.q&&this.data.setupId!==e.data.setupId&&(this.data.setupId=e.data.setupId)}),this.setupService.setupList$.asObservable().pipe(Object(j.a)(this.destroy$)).subscribe(e=>this.setupList=e)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngAfterViewInit(){this.data.setSetup&&this.data.setupId&&setTimeout(()=>this.windowRefService.scrollToElementCenter("link-setup-"+this.data.setupId,!0),250),this.data.setPrecondition&&this.data.preconditionId&&setTimeout(()=>this.windowRefService.scrollToElementCenter("link-setup-"+this.data.preconditionId,!0),250)}getAllChildrenId(e){return e.children.reduce((e,t)=>[...e,[t.item.id],t.children.map(e=>this.getAllChildrenId(e)).reduce((e,t)=>e.concat(t),[])],[]).concat(e.item.id).reduce((e,t)=>e.concat(t),[])}chooseSetup(e){this.data.setSetup&&this.data.setupId&&this.dialogRef.close(e.item.id!==this.data.setupId&&e.item.id),this.data.setPrecondition&&this.data.preconditionId&&this.dialogRef.close(e.item.id!==this.data.preconditionId&&e.item.id),this.dialogRef.close(e.item.id)}findTreeNodeStart(e,t){e.item.id!==t.id?e.children.forEach(e=>this.findTreeNodeStart(e,t)):this.setupsItems=[e]}addDraftTreeNode(e){const t=e?this.setupList.get(e):null,i=this.initializeTreeNode(t);t?this.setupService.addDraftSetupStep(i,t):this.setupService.addDraftSetupStep(i),this.cdr.detectChanges(),this.windowRefService.focusElementById("input-setup-0",100)}initializeTreeNode(e){const t=new U.i,i=new q.m;return i.id=0,i.parentId=e?e.item.id:null,i.projectId=this.data.project.id,i.title="",i.description=null,t.item=i,t.children=[],t}invalidateTreeNode(e,t){e.item.title=e.item.title.trim(),0!==(e.item.title||"").trim().length&&this.createTreeNode(e)}createTreeNode(e){const t=new G.a;t.parentId=e.item.parentId,t.title=null===e.item.title?null:e.item.title.trim(),t.description=null===e.item.description?null:e.item.description.trim(),t.isDraft=!1,t.orderNum=e.children.sort((e,t)=>e.item.orderNum>t.item.orderNum?1:-1).slice(-1)[0].item.orderNum+1e3,this.hyperionSetupService.createSetupStep(t,e.item.projectId).subscribe(e=>{this.notificationService.success("Setup step created"),this.setupService.clearDraftNode(e.parentId)},e=>{if(e instanceof U.a){let t=null;switch(e.error){case G.b.ParentNotExists:t="Setup step does not exist";break;case G.b.ProjectNotExists:t="Project does not exist";break;case G.b.TitleAlreadyExists:t="Setup step title already exists";break;case G.b.HasChildren:t="Setup step has children"}this.notificationService.error(t||e)}else this.notificationService.error(e)})}}return e.\u0275fac=function(t){return new(t||e)(Y["\u0275\u0275directiveInject"](d.g),Y["\u0275\u0275directiveInject"](d.a),Y["\u0275\u0275directiveInject"](Y.ChangeDetectorRef),Y["\u0275\u0275directiveInject"](a.g),Y["\u0275\u0275directiveInject"](L.a),Y["\u0275\u0275directiveInject"](z.a),Y["\u0275\u0275directiveInject"](_.a),Y["\u0275\u0275directiveInject"](B.a),Y["\u0275\u0275directiveInject"](Q.a))},e.\u0275cmp=Y["\u0275\u0275defineComponent"]({type:e,selectors:[["m-browse-setup-dialog"]],viewQuery:function(e,t){if(1&e&&Y["\u0275\u0275viewQuery"](H.a,!0),2&e){let e;Y["\u0275\u0275queryRefresh"](e=Y["\u0275\u0275loadQuery"]())&&(t.dynamicTree=e.first)}},decls:9,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"inputNodes$","nodeAdded"],["nodeTitleTemplate",""],["mat-dialog-actions","",1,"justify-content-end"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"],[1,"block-flex"],["class","las la-cog",4,"ngIf"],["class","m-badge m-badge--primary text-uppercase x-tag mini align-text-top mr-1",4,"ngIf"],["class","m-badge m-badge--primary text-uppercase x-tag mini align-text-top ml-3 mr-1",4,"ngIf"],["href","javascript:void(null)","class","tree-label m-0",3,"id","click",4,"ngIf"],["type","text","class","in-place-browse monospace","id","input-setup-0",3,"placeholder","width","ngModel","ngModelChange","keyup.enter","blur",4,"ngIf"],[1,"las","la-cog"],[1,"m-badge","m-badge--primary","text-uppercase","x-tag","mini","align-text-top","mr-1"],[1,"m-badge","m-badge--primary","text-uppercase","x-tag","mini","align-text-top","ml-3","mr-1"],["href","javascript:void(null)",1,"tree-label","m-0",3,"id","click"],["type","text","id","input-setup-0",1,"in-place-browse","monospace",3,"placeholder","ngModel","ngModelChange","keyup.enter","blur"]],template:function(e,t){1&e&&(Y["\u0275\u0275elementStart"](0,"h1",0),Y["\u0275\u0275text"](1,"Choose test setup"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](2,"div",1),Y["\u0275\u0275elementStart"](3,"m-dynamic-tree-map",2),Y["\u0275\u0275listener"]("nodeAdded",function(e){return t.addDraftTreeNode(e)}),Y["\u0275\u0275template"](4,ie,6,5,"ng-template",null,3,Y["\u0275\u0275templateRefExtractor"]),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](6,"div",4),Y["\u0275\u0275elementStart"](7,"button",5),Y["\u0275\u0275text"](8,"Close"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()),2&e&&(Y["\u0275\u0275advance"](3),Y["\u0275\u0275property"]("inputNodes$",t.setupService.setupTree$),Y["\u0275\u0275advance"](4),Y["\u0275\u0275property"]("mat-dialog-close",!1))},directives:[d.h,d.e,J.a,d.c,o.a,d.d,n.m,r.c,r.i,r.l],styles:[".tree-label[_ngcontent-%COMP%]{line-height:40px}.m-badge[_ngcontent-%COMP%]{min-width:40px}  .ps__rail-x{visibility:hidden}.mat-icon[_ngcontent-%COMP%]{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:auto;width:auto}.block-flex[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap}.in-place-browse[_ngcontent-%COMP%]{outline:none;margin:0 5px;border:1px solid transparent;border-radius:3px;transition:border 125ms linear,box-shadow 125ms linear,opacity 125ms linear;box-shadow:0 0 7px 0 transparent;background-color:transparent;max-width:100ch!important}"]}),e})();var re=i("N1IV"),ae=i("25+x"),oe=i("E1Th"),se=i("IsHO"),de=i("TufI"),ce=i("Jw7p"),le=i("wg/d"),pe=i("avHx"),me=i("xmDL"),ue=i("9pgZ"),he=i("cdP3"),fe=i("FKr1"),ve=i("jhN1");let ge=(()=>{class e{constructor(e){this._sanitizer=e}transform(e,t){switch(t){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:return this._sanitizer.bypassSecurityTrustHtml(e)}}}return e.\u0275fac=function(t){return new(t||e)(Y["\u0275\u0275directiveInject"](ve.DomSanitizer))},e.\u0275pipe=Y["\u0275\u0275definePipe"]({name:"safe",type:e,pure:!0}),e})();const xe=["afterDropDialog"],Se=["checkbox1"];function Ce(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"li"),Y["\u0275\u0275elementStart"](1,"div",28),Y["\u0275\u0275elementStart"](2,"mat-form-field",29),Y["\u0275\u0275elementStart"](3,"input",30),Y["\u0275\u0275listener"]("keyup",function(t){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().applyFilter(t.target.value)}),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()}}function be(e,t){if(1&e&&Y["\u0275\u0275element"](0,"i",33),2&e){const e=Y["\u0275\u0275nextContext"]().node,t=Y["\u0275\u0275nextContext"]();Y["\u0275\u0275property"]("matTooltip",t.tooltipTextShow(e))}}function Ie(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"input",31),Y["\u0275\u0275listener"]("ngModelChange",function(e){return t.node.item.title=e})("click",function(){Y["\u0275\u0275restoreView"](e);const i=t.node,n=Y["\u0275\u0275nextContext"]();return i.item.id>0?n.setActiveTreeNode(i):null})("keyup.escape",function(i){Y["\u0275\u0275restoreView"](e);const n=t.node;return Y["\u0275\u0275nextContext"]().revertTreeNode(n),i.target.blur()})("keyup.enter",function(e){return e.target.blur()})("blur",function(i){Y["\u0275\u0275restoreView"](e);const n=t.node;return Y["\u0275\u0275nextContext"]().invalidateTreeNode(n,0===n.item.id?null:"title",i.target.value)}),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275template"](1,be,1,1,"i",32)}if(2&e){const e=t.node,i=Y["\u0275\u0275nextContext"]();Y["\u0275\u0275styleProp"]("width",e.item.title.length?e.item.title.length+2:15,"ch"),Y["\u0275\u0275classProp"]("changed",0===e.item.id||i.pristineTestCaseMap.get(e.item.id)&&e.item.title!==i.pristineTestCaseMap.get(e.item.id).title)("draft",e.item.isDraft)("m-selected",i.activeNode&&e.item.id===i.activeNode.item.id),Y["\u0275\u0275propertyInterpolate1"]("id","input-testcase-",e.item.id,""),Y["\u0275\u0275property"]("placeholder",0===e.item.title.length?"Test case title":null)("ngModel",e.item.title),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",i.tooltipTextShow(e))}}function ye(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"button",35),Y["\u0275\u0275listener"]("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]().node,i=Y["\u0275\u0275nextContext"]();return t.expanded=!0,i.lastNodeId=t.item.id}),Y["\u0275\u0275element"](1,"i",36),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"]().node,t=Y["\u0275\u0275nextContext"](),i=Y["\u0275\u0275reference"](1);Y["\u0275\u0275property"]("matMenuTriggerFor",i)("disabled",t.treeNodeHasDraftChildren(e))}}function we(e,t){if(1&e&&Y["\u0275\u0275template"](0,ye,2,2,"button",34),2&e){const e=t.node;Y["\u0275\u0275property"]("ngIf",e.item.id>0&&e.item.isGroup)}}function Ne(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275elementStart"](1,"label",65),Y["\u0275\u0275text"](2,"|"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](3,"label",56),Y["\u0275\u0275elementStart"](4,"a",66),Y["\u0275\u0275listener"]("click",function(){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"](2).clearPrecondition()}),Y["\u0275\u0275text"](5," clear "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementContainerEnd"]()}}function Te(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"span"),Y["\u0275\u0275text"](1," Inherited from "),Y["\u0275\u0275elementStart"](2,"strong",67),Y["\u0275\u0275text"](3),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](3);Y["\u0275\u0275advance"](3),Y["\u0275\u0275textInterpolate1"](" ",e.inheritedPreconditionTestCase.title," ")}}function Ee(e,t){if(1&e&&(Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275template"](1,Te,4,1,"span",10),Y["\u0275\u0275elementContainerEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](2);Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",(null==e.activeNodePrecondition?null:e.activeNodePrecondition.length)>0)}}function ke(e,t){1&e&&(Y["\u0275\u0275elementStart"](0,"span",68),Y["\u0275\u0275text"](1," Not set "),Y["\u0275\u0275elementEnd"]())}function Pe(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"mat-icon",79),Y["\u0275\u0275listener"]("mouseover",function(){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().$implicit.$hovered=!0})("mouseout",function(){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().$implicit.$hovered=!1})("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]().$implicit;return Y["\u0275\u0275nextContext"](3).removePreconditionStep(t)}),Y["\u0275\u0275text"](1," close "),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"]().$implicit;Y["\u0275\u0275classProp"]("f-w-600",e.$hovered)}}function Me(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"li"),Y["\u0275\u0275elementStart"](1,"div",72),Y["\u0275\u0275elementStart"](2,"div",73),Y["\u0275\u0275elementStart"](3,"mat-icon",74),Y["\u0275\u0275text"](4," subdirectory_arrow_right "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](5,"div",75),Y["\u0275\u0275elementStart"](6,"span",76),Y["\u0275\u0275text"](7),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](8,"div",77),Y["\u0275\u0275template"](9,Pe,2,2,"mat-icon",78),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=t.index;Y["\u0275\u0275advance"](7),Y["\u0275\u0275textInterpolate"](e.title),Y["\u0275\u0275advance"](2),Y["\u0275\u0275property"]("ngIf",i>0)}}function Ae(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"a",80),Y["\u0275\u0275listener"]("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"](3);return t.showBrowsePreconditionDialog(t.activeNode,t.activeNodePrecondition[t.activeNodePrecondition.length-1])}),Y["\u0275\u0275elementStart"](1,"mat-icon",81),Y["\u0275\u0275text"](2," add "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275text"](3,"Add another step... "),Y["\u0275\u0275elementEnd"]()}}function je(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"ul",69),Y["\u0275\u0275template"](1,Me,10,2,"li",70),Y["\u0275\u0275elementStart"](2,"li"),Y["\u0275\u0275template"](3,Ae,4,0,"a",71),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](2);Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngForOf",e.activeNodePrecondition),Y["\u0275\u0275advance"](2),Y["\u0275\u0275property"]("ngIf",null!==e.activeNode.item.preconditionId)}}function Ve(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275elementStart"](1,"label",65),Y["\u0275\u0275text"](2,"|"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](3,"label",56),Y["\u0275\u0275elementStart"](4,"a",66),Y["\u0275\u0275listener"]("click",function(){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"](2).clearSetup()}),Y["\u0275\u0275text"](5," clear "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementContainerEnd"]()}}function Oe(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"span"),Y["\u0275\u0275text"](1," Inherited from "),Y["\u0275\u0275elementStart"](2,"strong",67),Y["\u0275\u0275text"](3),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](3);Y["\u0275\u0275advance"](3),Y["\u0275\u0275textInterpolate1"](" ",e.inheritedSetupTestCase.title," ")}}function $e(e,t){if(1&e&&(Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275template"](1,Oe,4,1,"span",10),Y["\u0275\u0275elementContainerEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](2);Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",(null==e.activeNodeSetup?null:e.activeNodeSetup.length)>0)}}function De(e,t){1&e&&(Y["\u0275\u0275elementStart"](0,"span",68),Y["\u0275\u0275text"](1," Not set "),Y["\u0275\u0275elementEnd"]())}function Fe(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"mat-icon",85),Y["\u0275\u0275listener"]("mouseover",function(){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().$implicit.$hovered=!0})("mouseout",function(){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().$implicit.$hovered=!1})("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]().$implicit;return Y["\u0275\u0275nextContext"](3).removeSetupStep(t)}),Y["\u0275\u0275text"](1," close "),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"]().$implicit;Y["\u0275\u0275classProp"]("f-w-600",e.$hovered)}}function Re(e,t){if(1&e&&(Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275text"](1),Y["\u0275\u0275elementContainerEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](3).$implicit,t=Y["\u0275\u0275nextContext"](3);Y["\u0275\u0275advance"](1),Y["\u0275\u0275textInterpolate"](t.getSpec(e.id).value)}}function Le(e,t){if(1&e&&(Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275text"](1),Y["\u0275\u0275elementContainerEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](3).$implicit,t=Y["\u0275\u0275nextContext"](3);Y["\u0275\u0275advance"](1),Y["\u0275\u0275textInterpolate"](t.flatParameter.get(t.getSpec(e.id).parameterId)?t.flatParameter.get(t.getSpec(e.id).parameterId).title:"")}}function ze(e,t){1&e&&(Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275text"](1,"Any"),Y["\u0275\u0275elementContainerEnd"]())}function _e(e,t){1&e&&(Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275text"](1,"Random"),Y["\u0275\u0275elementContainerEnd"]())}function Be(e,t){if(1&e&&(Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275text"](1),Y["\u0275\u0275elementContainerEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](3).$implicit,t=Y["\u0275\u0275nextContext"](3);Y["\u0275\u0275advance"](1),Y["\u0275\u0275textInterpolate"](t.flatParameter.get(e.parameterId).title)}}function We(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"a",89),Y["\u0275\u0275listener"]("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"](2).$implicit,i=Y["\u0275\u0275nextContext"](3);return i.inheritedSetupTestCase?null:i.showMoreParamMap.set(t.id,!0)}),Y["\u0275\u0275elementStart"](1,"span",82),Y["\u0275\u0275template"](2,Re,2,1,"ng-container",90),Y["\u0275\u0275template"](3,Le,2,1,"ng-container",90),Y["\u0275\u0275template"](4,ze,2,0,"ng-container",90),Y["\u0275\u0275template"](5,_e,2,0,"ng-container",90),Y["\u0275\u0275template"](6,Be,2,1,"ng-container",91),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"](2).$implicit,t=Y["\u0275\u0275nextContext"](3);Y["\u0275\u0275property"]("ngSwitch",t.getSpec(e.id).specType),Y["\u0275\u0275advance"](2),Y["\u0275\u0275property"]("ngSwitchCase",t.specTypeEnum.Value),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngSwitchCase",t.specTypeEnum.Source),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngSwitchCase",t.specTypeEnum.Any),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngSwitchCase",t.specTypeEnum.Random)}}function Ge(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"a",92),Y["\u0275\u0275listener"]("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"](2).$implicit,i=Y["\u0275\u0275nextContext"](3);return i.inheritedSetupTestCase?null:i.showMoreParamMap.set(t.id,!0)}),Y["\u0275\u0275pipe"](1,"safe"),Y["\u0275\u0275elementStart"](2,"span",82),Y["\u0275\u0275text"](3,"Unspecialized"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"](5);Y["\u0275\u0275attribute"]("href",e.inheritedSetupTestCase?null:Y["\u0275\u0275pipeBind2"](1,1,"javascript:void(null)","url"),Y["\u0275\u0275sanitizeUrl"])}}function He(e,t){if(1&e&&(Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275element"](1,"i",99),Y["\u0275\u0275text"](2),Y["\u0275\u0275elementContainerEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"]().$implicit;Y["\u0275\u0275advance"](2),Y["\u0275\u0275textInterpolate1"](" ",e.dependentValue," ")}}function Ue(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"mat-option",94),Y["\u0275\u0275text"](1),Y["\u0275\u0275template"](2,He,3,1,"ng-container",10),Y["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=Y["\u0275\u0275nextContext"](7);Y["\u0275\u0275property"]("value",i.specTypeEnum.Value+"|"+e.value),Y["\u0275\u0275advance"](1),Y["\u0275\u0275textInterpolate1"](" ",e.value," "),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",e.dependentValue)}}function qe(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"mat-optgroup",97),Y["\u0275\u0275template"](1,Ue,3,3,"mat-option",98),Y["\u0275\u0275elementEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](3).$implicit,t=Y["\u0275\u0275nextContext"](3);Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngForOf",t.getParameters(e.parameterId))}}function Qe(e,t){if(1&e&&(Y["\u0275\u0275element"](0,"mat-option",102),Y["\u0275\u0275pipe"](1,"safe")),2&e){const e=t.$implicit,i=Y["\u0275\u0275nextContext"](7);Y["\u0275\u0275property"]("value",i.specTypeEnum.Source+"|"+e.item.id)("innerHTML",Y["\u0275\u0275pipeBind2"](1,2,e.item.title,"html"),Y["\u0275\u0275sanitizeHtml"])}}function Ye(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"mat-optgroup",100),Y["\u0275\u0275template"](1,Qe,2,5,"mat-option",101),Y["\u0275\u0275elementEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](3).$implicit,t=Y["\u0275\u0275nextContext"](3);Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngForOf",t.levelParamMap.get(e.id))}}function Je(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275elementStart"](1,"mat-select",93),Y["\u0275\u0275listener"]("selectionChange",function(t){Y["\u0275\u0275restoreView"](e);const i=Y["\u0275\u0275nextContext"](2).$implicit;return Y["\u0275\u0275nextContext"](3).specializeParam(t.value,i.id)})("openedChange",function(t){Y["\u0275\u0275restoreView"](e);const i=Y["\u0275\u0275nextContext"](2).$implicit,n=Y["\u0275\u0275nextContext"](3);return t?null:n.showMoreParamMap.set(i.id,!1)}),Y["\u0275\u0275elementStart"](2,"mat-option",94),Y["\u0275\u0275text"](3," Any "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275element"](4,"mat-divider"),Y["\u0275\u0275template"](5,qe,2,1,"mat-optgroup",95),Y["\u0275\u0275element"](6,"mat-divider"),Y["\u0275\u0275template"](7,Ye,2,1,"mat-optgroup",96),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"](2).$implicit,t=Y["\u0275\u0275nextContext"](3);Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("value",t.getSpecValue(e.id)),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("value",t.specTypeEnum.Any+"|any"),Y["\u0275\u0275advance"](3),Y["\u0275\u0275property"]("ngIf",t.flatParameter.get(e.parameterId).values.length>0),Y["\u0275\u0275advance"](2),Y["\u0275\u0275property"]("ngIf",t.levelParamMap.get(e.id).length>0)}}function Ze(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"div",75),Y["\u0275\u0275elementStart"](1,"mat-icon",86),Y["\u0275\u0275text"](2," link "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275template"](3,We,7,5,"a",87),Y["\u0275\u0275template"](4,Ge,4,4,"a",88),Y["\u0275\u0275template"](5,Je,8,4,"ng-container",10),Y["\u0275\u0275elementEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"]().$implicit,t=Y["\u0275\u0275nextContext"](3);Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("inline",!0),Y["\u0275\u0275advance"](2),Y["\u0275\u0275property"]("ngIf",!t.showMoreParamMap.get(e.id)&&t.getSpec(e.id)),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",!t.showMoreParamMap.get(e.id)&&!t.getSpec(e.id)),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",t.showMoreParamMap.get(e.id))}}function Xe(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"li"),Y["\u0275\u0275elementStart"](1,"div",72),Y["\u0275\u0275elementStart"](2,"div",73),Y["\u0275\u0275elementStart"](3,"mat-icon",74),Y["\u0275\u0275text"](4," subdirectory_arrow_right "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](5,"div",75),Y["\u0275\u0275elementStart"](6,"span",82),Y["\u0275\u0275text"](7),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](8,"div",75),Y["\u0275\u0275template"](9,Fe,2,2,"mat-icon",83),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275template"](10,Ze,6,4,"div",84),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,i=t.index;Y["\u0275\u0275advance"](7),Y["\u0275\u0275textInterpolate1"](" ",e.title," "),Y["\u0275\u0275advance"](2),Y["\u0275\u0275property"]("ngIf",i>0),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",e&&e.parameterId)}}function Ke(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"a",80),Y["\u0275\u0275listener"]("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"](3);return t.showBrowseSetupDialog(t.activeNode,t.activeNodeSetup[t.activeNodeSetup.length-1])}),Y["\u0275\u0275elementStart"](1,"mat-icon",81),Y["\u0275\u0275text"](2," add "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275text"](3,"Add another step... "),Y["\u0275\u0275elementEnd"]()}}function et(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"ul",69),Y["\u0275\u0275template"](1,Xe,11,3,"li",70),Y["\u0275\u0275elementStart"](2,"li"),Y["\u0275\u0275template"](3,Ke,4,0,"a",71),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](2);Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngForOf",e.activeNodeSetup),Y["\u0275\u0275advance"](2),Y["\u0275\u0275property"]("ngIf",null!==e.activeNode.item.setupId)}}function tt(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"li"),Y["\u0275\u0275elementStart"](1,"label",56),Y["\u0275\u0275text"](2,"Test steps"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](3,"textarea",51),Y["\u0275\u0275listener"]("ngModelChange",function(t){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"](2).activeNode.item.testSteps=t})("keyup.escape",function(t){Y["\u0275\u0275restoreView"](e);const i=Y["\u0275\u0275nextContext"](2);return i.revertTreeNodeTestSteps(i.activeNode),t.target.blur()})("blur",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"](2);return t.invalidateTreeNode(t.activeNode,"testSteps")}),Y["\u0275\u0275text"](4,"                                    "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275element"](5,"div",103),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"](2);Y["\u0275\u0275advance"](3),Y["\u0275\u0275classProp"]("changed",e.treeNodeChanged(e.activeNode,"testSteps")),Y["\u0275\u0275property"]("ngModel",e.activeNode.item.testSteps)}}function it(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"li"),Y["\u0275\u0275elementStart"](1,"label",56),Y["\u0275\u0275text"](2,"Expected result"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](3,"textarea",51),Y["\u0275\u0275listener"]("ngModelChange",function(t){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"](2).activeNode.item.expectedResult=t})("keyup.escape",function(t){Y["\u0275\u0275restoreView"](e);const i=Y["\u0275\u0275nextContext"](2);return i.revertTreeNodeExpectedResult(i.activeNode),t.target.blur()})("blur",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"](2);return t.invalidateTreeNode(t.activeNode,"expectedResult")}),Y["\u0275\u0275text"](4,"                                    "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275element"](5,"div",103),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"](2);Y["\u0275\u0275advance"](3),Y["\u0275\u0275classProp"]("changed",e.treeNodeChanged(e.activeNode,"expectedResult")),Y["\u0275\u0275property"]("ngModel",e.activeNode.item.expectedResult)}}function nt(e,t){if(1&e&&(Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275elementContainer"](1,64),Y["\u0275\u0275elementContainerEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](2),t=Y["\u0275\u0275reference"](46),i=Y["\u0275\u0275reference"](44);Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngTemplateOutlet",(null==e.activeFileAttachments?null:e.activeFileAttachments.length)>3&&e.showMoreAttachments?t:i)}}function rt(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"li"),Y["\u0275\u0275elementStart"](1,"div",61),Y["\u0275\u0275elementStart"](2,"div",104),Y["\u0275\u0275elementStart"](3,"label",53),Y["\u0275\u0275text"](4,"Created At"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275element"](5,"input",105),Y["\u0275\u0275pipe"](6,"date"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](7,"div",104),Y["\u0275\u0275elementStart"](8,"label",53),Y["\u0275\u0275text"](9,"Updated At"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275element"](10,"input",105),Y["\u0275\u0275pipe"](11,"date"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](2);Y["\u0275\u0275advance"](5),Y["\u0275\u0275propertyInterpolate"]("value",Y["\u0275\u0275pipeBind2"](6,2,e.activeNode.item.createdAt,"yyyy-MM-dd HH:mm")),Y["\u0275\u0275advance"](5),Y["\u0275\u0275propertyInterpolate"]("value",Y["\u0275\u0275pipeBind2"](11,5,e.activeNode.item.updatedAt,"yyyy-MM-dd HH:mm"))}}function at(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"as-split-area",16),Y["\u0275\u0275elementStart"](1,"div",37),Y["\u0275\u0275elementStart"](2,"perfect-scrollbar",18),Y["\u0275\u0275elementStart"](3,"div",38),Y["\u0275\u0275elementStart"](4,"div",39),Y["\u0275\u0275elementStart"](5,"input",40),Y["\u0275\u0275listener"]("ngModelChange",function(t){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().activeNode.item.title=t})("keyup.escape",function(t){Y["\u0275\u0275restoreView"](e);const i=Y["\u0275\u0275nextContext"]();return i.revertTreeNodeTitle(i.activeNode),t.target.blur()})("blur",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]();return t.invalidateTreeNode(t.activeNode,"title")}),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](6,"div",41),Y["\u0275\u0275elementStart"](7,"div",42),Y["\u0275\u0275listener"]("click",function(){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().resetActiveTreeNode()}),Y["\u0275\u0275element"](8,"i",43),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](9,"div",44),Y["\u0275\u0275elementStart"](10,"span",45),Y["\u0275\u0275text"](11),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275element"](12,"div",46),Y["\u0275\u0275elementStart"](13,"div",47),Y["\u0275\u0275elementStart"](14,"mat-checkbox",48),Y["\u0275\u0275listener"]("ngModelChange",function(t){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().activeNode.item.isDraft=t})("change",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]();return t.invalidateTreeNode(t.activeNode,"isDraft")}),Y["\u0275\u0275text"](15," Draft "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](16,"ul",49),Y["\u0275\u0275elementStart"](17,"li"),Y["\u0275\u0275elementStart"](18,"label",50),Y["\u0275\u0275text"](19,"Description"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](20,"textarea",51),Y["\u0275\u0275listener"]("ngModelChange",function(t){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().activeNode.item.description=t})("keyup.escape",function(t){Y["\u0275\u0275restoreView"](e);const i=Y["\u0275\u0275nextContext"]();return i.revertTreeNodeDescription(i.activeNode),t.target.blur()})("blur",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]();return t.invalidateTreeNode(t.activeNode,"description")}),Y["\u0275\u0275text"](21,"                                    "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275element"](22,"div",52),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](23,"li"),Y["\u0275\u0275elementStart"](24,"label",53),Y["\u0275\u0275text"](25),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](26,"input",54),Y["\u0275\u0275listener"]("ngModelChange",function(t){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().activeNode.item.title=t})("keyup.escape",function(t){Y["\u0275\u0275restoreView"](e);const i=Y["\u0275\u0275nextContext"]();return i.revertTreeNodeTitle(i.activeNode),t.target.blur()})("keyup.enter",function(e){return e.target.blur()})("blur",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]();return t.invalidateTreeNode(t.activeNode,"title")}),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](27,"li"),Y["\u0275\u0275elementStart"](28,"div",55),Y["\u0275\u0275elementStart"](29,"label",56),Y["\u0275\u0275text"](30," Precondition "),Y["\u0275\u0275elementStart"](31,"a",57),Y["\u0275\u0275listener"]("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]();return t.showBrowsePreconditionDialog(t.activeNode)}),Y["\u0275\u0275text"](32," change "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275template"](33,Ne,6,0,"ng-container",10),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](34,"label",58),Y["\u0275\u0275template"](35,Ee,2,1,"ng-container",10),Y["\u0275\u0275template"](36,ke,2,0,"span",59),Y["\u0275\u0275template"](37,je,4,2,"ul",60),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](38,"li"),Y["\u0275\u0275elementStart"](39,"div",55),Y["\u0275\u0275elementStart"](40,"label",56),Y["\u0275\u0275text"](41," Setup "),Y["\u0275\u0275elementStart"](42,"a",57),Y["\u0275\u0275listener"]("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]();return t.showBrowseSetupDialog(t.activeNode)}),Y["\u0275\u0275text"](43," change "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275template"](44,Ve,6,0,"ng-container",10),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](45,"label",58),Y["\u0275\u0275template"](46,$e,2,1,"ng-container",10),Y["\u0275\u0275template"](47,De,2,0,"span",59),Y["\u0275\u0275template"](48,et,4,2,"ul",60),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275template"](49,tt,6,3,"li",10),Y["\u0275\u0275template"](50,it,6,3,"li",10),Y["\u0275\u0275elementStart"](51,"li"),Y["\u0275\u0275elementStart"](52,"div",61),Y["\u0275\u0275elementStart"](53,"div",62),Y["\u0275\u0275elementStart"](54,"label",53),Y["\u0275\u0275text"](55,"Attachments"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](56,"div",61),Y["\u0275\u0275elementStart"](57,"div",63),Y["\u0275\u0275template"](58,nt,2,1,"ng-container",10),Y["\u0275\u0275elementContainer"](59,64),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275template"](60,rt,12,8,"li",10),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"](),t=Y["\u0275\u0275reference"](48);Y["\u0275\u0275property"]("size",e.activeNode?30:0),Y["\u0275\u0275advance"](5),Y["\u0275\u0275classProp"]("changed",e.treeNodeChanged(e.activeNode,"title")),Y["\u0275\u0275property"]("placeholder",0===e.activeNode.item.title.length?"Parameter title":null)("ngModel",e.activeNode.item.title),Y["\u0275\u0275advance"](6),Y["\u0275\u0275textInterpolate1"](" #",e.activeNode.item.id," "),Y["\u0275\u0275advance"](3),Y["\u0275\u0275property"]("ngModel",e.activeNode.item.isDraft),Y["\u0275\u0275advance"](6),Y["\u0275\u0275classProp"]("changed",e.treeNodeChanged(e.activeNode,"description")),Y["\u0275\u0275property"]("ngModel",e.activeNode.item.description),Y["\u0275\u0275advance"](5),Y["\u0275\u0275textInterpolate1"](" Test ",e.activeNode.item.isGroup?"group":"case"," title "),Y["\u0275\u0275advance"](1),Y["\u0275\u0275styleProp"]("width",e.activeNode.item.title.length?e.activeNode.item.title.length+2:20,"ch"),Y["\u0275\u0275classProp"]("changed",e.treeNodeChanged(e.activeNode,"title")),Y["\u0275\u0275property"]("placeholder",0===e.activeNode.item.title.length?"Put some text here":null)("ngModel",e.activeNode.item.title),Y["\u0275\u0275advance"](7),Y["\u0275\u0275property"]("ngIf",0!==(null==e.activeNodePrecondition?null:e.activeNodePrecondition.length)&&null!==e.activeNode.item.preconditionId),Y["\u0275\u0275advance"](2),Y["\u0275\u0275property"]("ngIf",!e.activeNode.item.preconditionId&&e.inheritedPreconditionTestCase),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",0===(null==e.activeNodePrecondition?null:e.activeNodePrecondition.length)),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",(null==e.activeNodePrecondition?null:e.activeNodePrecondition.length)>0),Y["\u0275\u0275advance"](7),Y["\u0275\u0275property"]("ngIf",0!==(null==e.activeNodeSetup?null:e.activeNodeSetup.length)&&null!==e.activeNode.item.setupId),Y["\u0275\u0275advance"](2),Y["\u0275\u0275property"]("ngIf",!e.activeNode.item.setupId&&e.inheritedSetupTestCase),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",0===(null==e.activeNodeSetup?null:e.activeNodeSetup.length)),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",(null==e.activeNodeSetup?null:e.activeNodeSetup.length)>0),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",!e.activeNode.item.isGroup),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",!e.activeNode.item.isGroup),Y["\u0275\u0275advance"](8),Y["\u0275\u0275property"]("ngIf",(null==e.activeFileAttachments?null:e.activeFileAttachments.length)>0),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngTemplateOutlet",0===(null==e.activeFileAttachments?null:e.activeFileAttachments.length)?t:null),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",e.activeNode.item.id>0)}}function ot(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"img",116),Y["\u0275\u0275listener"]("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"](2).index;return Y["\u0275\u0275nextContext"](2).openGallery(t)}),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"](2).$implicit;Y["\u0275\u0275propertyInterpolate1"]("src","/download/attachments/",e.thumbFilename,"",Y["\u0275\u0275sanitizeUrl"])}}function st(e,t){1&e&&(Y["\u0275\u0275elementStart"](0,"div",117),Y["\u0275\u0275text"](1,"File"),Y["\u0275\u0275elementEnd"]())}const dt=function(e){return{title:"Confirmation",html:e,type:"question",confirmButtonText:"Delete",confirmButtonColor:"#f4516c",confirmButtonClass:"btn-danger",showCancelButton:!0,heightAuto:!1}};function ct(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"div",109),Y["\u0275\u0275elementContainerStart"](1,110),Y["\u0275\u0275template"](2,ot,1,1,"img",111),Y["\u0275\u0275elementStart"](3,"a",112),Y["\u0275\u0275template"](4,st,2,0,"div",113),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementContainerEnd"](),Y["\u0275\u0275elementStart"](5,"div",114),Y["\u0275\u0275listener"]("confirm",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]().$implicit,i=Y["\u0275\u0275nextContext"](2);return i.unlinkFileAttachment(t.id,i.activeNode.item.id)}),Y["\u0275\u0275elementStart"](6,"mat-icon",115),Y["\u0275\u0275text"](7,"clear"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"]().$implicit;Y["\u0275\u0275property"]("matTooltip",e.originalFilename),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngSwitch",!!e.thumbFilename),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngSwitchCase",!0),Y["\u0275\u0275advance"](1),Y["\u0275\u0275propertyInterpolate1"]("href","/download/attachments/",e.filename,"",Y["\u0275\u0275sanitizeUrl"]),Y["\u0275\u0275property"]("ngSwitch",!!e.thumbFilename),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngSwitchCase",!1),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("swal",Y["\u0275\u0275pureFunction1"](7,dt,"Delete <b>"+e.originalFilename+"</b>?"))}}function lt(e,t){if(1&e&&(Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275template"](1,ct,8,9,"div",108),Y["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.index;Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",e<3)}}function pt(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"div",118),Y["\u0275\u0275listener"]("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"](2);return t.showMoreAttachments=!t.showMoreAttachments}),Y["\u0275\u0275elementStart"](1,"div",119),Y["\u0275\u0275text"](2),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"](2);Y["\u0275\u0275advance"](2),Y["\u0275\u0275textInterpolate1"](" + ",(null==e.activeFileAttachments?null:e.activeFileAttachments.length)-3," ")}}function mt(e,t){1&e&&Y["\u0275\u0275elementContainer"](0)}function ut(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"div",55),Y["\u0275\u0275template"](1,lt,2,1,"ng-container",70),Y["\u0275\u0275template"](2,pt,3,1,"div",106),Y["\u0275\u0275template"](3,mt,1,0,"ng-container",107),Y["\u0275\u0275elementEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"](),t=Y["\u0275\u0275reference"](48);Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngForOf",e.activeFileAttachments),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",(null==e.activeFileAttachments?null:e.activeFileAttachments.length)>3),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngTemplateOutlet",t)}}function ht(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"img",116),Y["\u0275\u0275listener"]("click",function(){Y["\u0275\u0275restoreView"](e);const t=Y["\u0275\u0275nextContext"]().index;return Y["\u0275\u0275nextContext"](2).openGallery(t)}),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"]().$implicit;Y["\u0275\u0275propertyInterpolate1"]("src","/download/attachments/",e.thumbFilename,"",Y["\u0275\u0275sanitizeUrl"])}}function ft(e,t){1&e&&(Y["\u0275\u0275elementStart"](0,"div",117),Y["\u0275\u0275text"](1,"File"),Y["\u0275\u0275elementEnd"]())}function vt(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275elementStart"](0,"div",109),Y["\u0275\u0275elementContainerStart"](1,110),Y["\u0275\u0275template"](2,ht,1,1,"img",111),Y["\u0275\u0275elementStart"](3,"a",112),Y["\u0275\u0275template"](4,ft,2,0,"div",113),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementContainerEnd"](),Y["\u0275\u0275elementStart"](5,"div",114),Y["\u0275\u0275listener"]("confirm",function(){Y["\u0275\u0275restoreView"](e);const i=t.$implicit,n=Y["\u0275\u0275nextContext"](2);return n.unlinkFileAttachment(i.id,n.activeNode.item.id)}),Y["\u0275\u0275elementStart"](6,"mat-icon",115),Y["\u0275\u0275text"](7,"clear"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;Y["\u0275\u0275property"]("matTooltip",e.originalFilename),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngSwitch",!!e.thumbFilename),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngSwitchCase",!0),Y["\u0275\u0275advance"](1),Y["\u0275\u0275propertyInterpolate1"]("href","/download/attachments/",e.filename,"",Y["\u0275\u0275sanitizeUrl"]),Y["\u0275\u0275property"]("ngSwitch",!!e.thumbFilename),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngSwitchCase",!1),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("swal",Y["\u0275\u0275pureFunction1"](7,dt,"Delete <b>"+e.originalFilename+"</b>?"))}}function gt(e,t){1&e&&Y["\u0275\u0275elementContainer"](0)}function xt(e,t){if(1&e&&(Y["\u0275\u0275template"](0,vt,8,9,"div",120),Y["\u0275\u0275template"](1,gt,1,0,"ng-container",107)),2&e){const e=Y["\u0275\u0275nextContext"](),t=Y["\u0275\u0275reference"](48);Y["\u0275\u0275property"]("ngForOf",e.activeFileAttachments),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngTemplateOutlet",t)}}function St(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"div",125),Y["\u0275\u0275element"](1,"mat-progress-spinner",126),Y["\u0275\u0275pipe"](2,"async"),Y["\u0275\u0275elementStart"](3,"div",127),Y["\u0275\u0275text"](4),Y["\u0275\u0275pipe"](5,"async"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()),2&e){const e=Y["\u0275\u0275nextContext"]().$implicit;Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("value",Y["\u0275\u0275pipeBind1"](2,2,e.value)),Y["\u0275\u0275advance"](3),Y["\u0275\u0275textInterpolate1"]("",Y["\u0275\u0275pipeBind1"](5,4,e.value),"%")}}function Ct(e,t){if(1&e&&(Y["\u0275\u0275elementContainerStart"](0),Y["\u0275\u0275template"](1,St,6,6,"div",124),Y["\u0275\u0275pipe"](2,"async"),Y["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit;Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("ngIf",Y["\u0275\u0275pipeBind1"](2,1,e.value))}}function bt(e,t){1&e&&(Y["\u0275\u0275elementStart"](0,"button",128),Y["\u0275\u0275listener"]("click",function(){return(0,t.openFileSelector)()}),Y["\u0275\u0275elementStart"](1,"mat-icon",129),Y["\u0275\u0275text"](2,"add"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]())}function It(e,t){if(1&e){const e=Y["\u0275\u0275getCurrentView"]();Y["\u0275\u0275template"](0,Ct,3,3,"ng-container",70),Y["\u0275\u0275pipe"](1,"keyvalue"),Y["\u0275\u0275elementStart"](2,"div",121),Y["\u0275\u0275elementStart"](3,"ngx-file-drop",122),Y["\u0275\u0275listener"]("onFileDrop",function(t){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().dropped(t)})("onFileOver",function(t){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().fileOver(t)})("onFileLeave",function(t){return Y["\u0275\u0275restoreView"](e),Y["\u0275\u0275nextContext"]().fileLeave(t)}),Y["\u0275\u0275template"](4,bt,3,0,"ng-template",123),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"]()}if(2&e){const e=Y["\u0275\u0275nextContext"]();Y["\u0275\u0275property"]("ngForOf",Y["\u0275\u0275pipeBind1"](1,1,e.attachmentsProgress))}}let yt=(()=>{class e{constructor(e,t,i,n,r,a,o,s,d,c,l,p,m,u,h,f,v,g){this.route=e,this.router=t,this.render=i,this.cdr=n,this.dialog=r,this.lightbox=a,this.accountService=o,this.hyperionAttachmentService=s,this.hyperionParameterService=d,this.hyperionSetupService=c,this.hyperionTestCaseService=l,this.notificationService=p,this.uploadService=m,this.websocketService=u,this.parameterService=h,this.setupService=f,this.testCaseService=v,this.windowRefService=g,this.destroy$=new E.b,this.hiddenNodeSet=new Set,this.ready$=new k.a(!1),this.websocketNodeAdd$=new k.a(null),this.websocketNodeDelete$=new k.a(null),this.websocketNodeUpdate$=new k.a(null),this.attachmentsProgress=new Map,this.flatSetup=new Map,this.setupTree=new Map,this.flatParameter=new Map,this.parameterList=new Map,this.nodeWithSameSetupMap=new Map,this.nodeWithSamePreconditionMap=new Map,this.activeNodeId=-1,this.filteredNodeArray=[],this.lastNodeId=0,this.searchNeedle="",this.newSetupTitle="",this.initialized=!1,this.attachments=new Map,this.activeAlbum=[],this.showMoreAttachments=!1,this.afterDropOptions={title:"Test case parent changed",text:"Do you want change setup and precondition?",html:'<div class="row">\n                <div class="col">\n                    <input type="checkbox" id="nodeSetup" checked="checked" style="transform: scale(1.5)" class="m-1"/>\n                    <label  for="nodeSetup" class="m--regular-font-size-lg2">\n                        Change for item\n                    </label>\n                </div>\n                </div>\n                <div class="row">\n                <div class="col">\n                    <input type="checkbox" id="childrenSetup" checked="checked" style="transform: scale(1.5)" class="m-1"//>\n                    <label  for="childrenSetup"  class="m--regular-font-size-lg2">\n                        Change for children\n                    </label>\n                    </div>\n                </div>',type:"question",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No",preConfirm:()=>{this.nodeSetupChangeCheckbox=document.getElementById("nodeSetup"),this.childrenChangeCheckbox=document.getElementById("childrenSetup")}},this.showMoreParamMap=new Map,this.paramTypeMap=new Map,this.specTypeEnum=q.n,this.levelParamMap=new Map,this.childParamArray=[],this.createState=!1,this.dimmedNodeSetId=new Set,this.hiddenNodeSetId=new Set,this.pristineTestCaseMap=new Map,this.testCaseList=new Map,this.rootLevelTestCase=new Map}ngOnInit(){this.accountService.profile$.asObservable().pipe(Object(j.a)(this.destroy$)).subscribe(e=>this.profile=e),Object(P.b)([this.setupService.setupTree$,this.setupService.flatSetup$,this.parameterService.parameterList$,this.parameterService.flatParameter$,this.testCaseService.testCaseList$,this.testCaseService.flatTestCase$]).pipe(Object(V.a)(([e,t,i,n,r,a])=>!!(e&&t&&i&&n&&r&&a)),Object(j.a)(this.destroy$)).subscribe(([e,t,i,n,r,a])=>{this.pristineTestCaseMap.clear(),this.setupTree=e,this.flatSetup=t,this.parameterList=i,this.flatParameter=n,this.testCaseList=r,a.forEach(e=>this.pristineTestCaseMap.set(e.id,q.o.fromJson(e.toJson()))),this.ready$.next(!0)}),this.testCaseService.testCaseTree$.asObservable().pipe(Object(V.a)(e=>!!e),Object(j.a)(this.destroy$)).subscribe(e=>{this.rootLevelTestCase.clear(),e.forEach(e=>this.rootLevelTestCase.set(e.item.id,e.item))}),this.route.data.pipe(Object(j.a)(this.destroy$)).subscribe(e=>this.initialize(e.activeProject)),Object(P.b)(this.route.data,this.route.queryParamMap).pipe(Object(j.a)(this.destroy$)).subscribe(([e,t])=>{this.activeQueryId=parseInt(t.get("id"),10)}),Object(M.a)(this.websocketService.testCaseUpdated,this.websocketService.testCaseDeleted).pipe(Object(j.a)(this.destroy$),Object(V.a)(e=>e.data.projectId===this.project.id)).subscribe(e=>{const t=new U.i;t.item=e.data,e instanceof W.q?-1!==this.activeNodeId&&t.item.id===this.activeNodeId&&this.profile.username!==e.actorName&&R.a.fire({type:"information",title:"Your active node has been changed by "+e.actorName,confirmButtonText:"ok"}).then(e=>{void 0!==e.value&&(console.log("merge update test case"),this.setActiveTreeNode(t))}):e instanceof W.p&&this.activeNode&&t.item.id===this.activeNode.item.id&&this.profile.username!==e.actorName&&R.a.fire({type:"warning",title:"Your active node has been deleted by "+e.actorName,confirmButtonText:"ok"}).then(e=>{void 0!==e.value&&this.resetActiveTreeNode()})}),Object(M.a)(this.websocketService.attachmentLinked,this.websocketService.attachmentUnlinked).pipe(Object(j.a)(this.destroy$),Object(V.a)(e=>e.link.owner===q.b.TestCase)).subscribe(e=>{if(!this.attachments.has(e.link.linkedId))return;const t=this.attachments.get(e.link.linkedId),i=t.findIndex(t=>t.id===e.attachment.id);e instanceof W.a?i>=0?t[i]=e.attachment:t.push(e.attachment):e instanceof W.b&&-1!==i&&t.splice(i,1),this.attachments.set(e.link.linkedId,t),this.activeNode.item.id&&this.activeNode.item.id===e.link.linkedId&&(this.activeFileAttachments=t),this.cdr.detectChanges()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.ready$.complete()}initialize(e){this.project=e,this.refresh()}refresh(){this.searchNeedle="",this.activeNode=null,this.activeNodeId=-1,this.activeNodeSetup=[],this.newSetupTitle="",this.initialized=!0}openGallery(e){this.activeFileAttachments.filter(e=>e.contentType.includes("image")).forEach(e=>{this.activeAlbum.push({src:"/download/attachments/"+e.filename,caption:e.originalFilename,thumb:"/download/attachments/"+e.thumbFilename})}),this.lightbox.open(this.activeAlbum,e)}applyFilter(e){this.dimmedNodeSetId=new Set(Array.from(this.pristineTestCaseMap).map(t=>this.filterCallback(t[1],e)?null:t[1].id)),this.hiddenNodeSetId=new Set(Array.from(this.testCaseList).filter(e=>this.getAllChildrenId(e[1]).every(e=>this.dimmedNodeSetId.has(e))).map(e=>e[1].item.id)),this.expandAllTreeNodes()}getAllChildrenId(e){return e.children.reduce((e,t)=>[...e,[t.item.id],t.children.map(e=>this.getAllChildrenId(e)).reduce((e,t)=>e.concat(t),[])],[]).concat(e.item.id).reduce((e,t)=>e.concat(t),[])}getAllParentId(e){const t=[];for(;e&&0!==e.item.parentId;){const i=this.testCaseList.get(e.item.parentId);t.push(i?i.item.id:null),e=i}return t.filter(e=>!!e)}showChildrenBeforeAddDraftNode(e){e?e.children.forEach(e=>this.hiddenNodeSetId.delete(e.item.id)):this.hiddenNodeSetId.forEach(e=>{null===this.pristineTestCaseMap.get(e).parentId&&this.hiddenNodeSetId.delete(e)}),this.cdr.detectChanges()}initializeTreeNode(e,t){const i=new U.i,n=new q.o;return n.id=0,n.parentId=e?e.item.id:null,n.projectId=this.project.id,n.setupId=e?e.item.setupId:null,n.preconditionId=e?e.item.preconditionId:null,n.isGroup=t,n.title="",n.description=e?e.item.description:"",n.testSteps="",n.expectedResult="",n.orderNum=e?e.children.length?e.children.slice(-1)[0].item.orderNum+1e3:1e3:this.rootLevelTestCase.size?[...this.rootLevelTestCase.entries()].map(e=>e[1]).sort((e,t)=>e.orderNum>t.orderNum?1:-1).slice(-1)[0].orderNum+1e3:1e3,i.item=n,i.children=[],i}treeNodeHasDraftChildren(e){return e?e.children.filter(e=>0===e.item.id).length>0:this.rootLevelTestCase.has(0)}treeNodeChanged(e,t){const i=this.pristineTestCaseMap.get(e.item.id);let n=!1;switch(t){case"setupId":case"preconditionId":case"title":case"description":case"testSteps":case"expectedResult":case"isDraft":case null:n=!0}if(!n)return!1;if(!i)return!0;switch(t){case"setupId":return i.setupId!==e.item.setupId;case"preconditionId":return i.preconditionId!==e.item.preconditionId;case"title":return(i.title||"").trim()!==(e.item.title||"").trim();case"description":return(i.description||"").trim()!==(e.item.description||"").trim();case"testSteps":return(i.testSteps||"").trim()!==(e.item.testSteps||"").trim();case"expectedResult":return(i.expectedResult||"").trim()!==(e.item.expectedResult||"").trim();case"isDraft":return i.isDraft!==e.item.isDraft;default:return i.setupId!==e.item.setupId||(i.title||"").trim()!==(e.item.title||"").trim()||(i.description||"").trim()!==(e.item.description||"").trim()||(i.testSteps||"").trim()!==(e.item.testSteps||"").trim()||(i.expectedResult||"").trim()!==(e.item.expectedResult||"").trim()}}canSubmitTreeNode(e,t){let i=!1;switch(t){case"setupId":case"preconditionId":case"title":case"description":case"testSteps":case"expectedResult":case"isDraft":case null:i=!0}if(!i)return!1;switch(t){case"setupId":case"preconditionId":case"description":case"testSteps":case"expectedResult":case"isDraft":return!0;case"title":default:return(e.item.title||"").trim().length>0}}addDraftTreeNode(e){this.createState=!0;const t=this.testCaseList.get(this.lastNodeId);this.resetActiveTreeNode();const i=this.initializeTreeNode(t,e);t?this.testCaseService.addDraftTestCase(i,t):this.testCaseService.addDraftTestCase(i),this.cdr.detectChanges(),this.windowRefService.focusElementById("input-testcase-0",100)}revertTreeNode(e){const t=this.pristineTestCaseMap.get(e.item.id);e.item.setupId=t?t.setupId:null,e.item.title=t?t.title:"",e.item.description=t?t.description:null,e.item.testSteps=t?t.testSteps:"",e.item.expectedResult=t?t.expectedResult:"",this.activeNode=null,this.activeNodeId=-1,this.newSetupTitle="",this.cdr.detectChanges()}revertTreeNodeTitle(e){const t=this.pristineTestCaseMap.get(e.item.id);e.item.title=t?t.title:"",this.cdr.detectChanges()}revertTreeNodeDescription(e){const t=this.pristineTestCaseMap.get(e.item.id);e.item.description=t?t.description:null,this.cdr.detectChanges()}revertTreeNodeTestSteps(e){const t=this.pristineTestCaseMap.get(e.item.id);e.item.testSteps=t?t.testSteps:"",this.cdr.detectChanges()}revertTreeNodeExpectedResult(e){const t=this.pristineTestCaseMap.get(e.item.id);e.item.expectedResult=t?t.expectedResult:"",this.cdr.detectChanges()}invalidateTreeNode(e,t,i){const n=this.pristineTestCaseMap.get(e.item.id);let r=!1;switch(t){case"parentId":case"setupId":case"preconditionId":case"title":case"description":case"testSteps":case"expectedResult":case"isDraft":case null:r=!0}t&&"title"!==t||!i||(e.item.title=i.trim(),0!==(e.item.title||"").trim().length)?this.treeNodeChanged(e,t)&&this.canSubmitTreeNode(e,t)&&(0===e.item.id?this.createTestCase(e):this.updateTestCase(e,t)):e.item.title=n?n.title:""}resetActiveTreeNode(){this.activeNode=null,this.activeNodeId=-1,this.activeQueryId=null,this.newSetupTitle="",this.cdr.detectChanges()}findParentWithValidSetup(e){let t=e.item.id;for(;e&&!e.item.setupId;)t=e.item.parentId,e=this.testCaseList.get(t);return e||null}treeNodeSetupSteps(e){const t=[];let i,n=e.item.setupId?e.item.setupId:this.findParentWithValidSetup(e)?this.findParentWithValidSetup(e).item.setupId:0;for(;n;)i=this.flatSetup.get(n),t.unshift(i||null),n=i?i.parentId:null;return t}findParentWithValidPrecondition(e){let t=e.item.id;for(;e&&!e.item.preconditionId;)t=e.item.parentId,e=this.testCaseList.get(t);return e||null}treeNodePreconditionSteps(e){const t=new Array;let i,n=e.item.preconditionId?e.item.preconditionId:this.findParentWithValidPrecondition(e)?this.findParentWithValidPrecondition(e).item.preconditionId:0;for(;n;)i=this.flatSetup.get(n),t.unshift(i||null),n=i?i.parentId:null;return t}setActiveTreeNode(e){if(console.log("set active node"),e.item.id&&this.router.navigate([],{queryParams:{id:e.item.id},replaceUrl:!0,queryParamsHandling:"merge"}),this.activeNode=e,this.activeNodeId=e.item.id,this.newSetupTitle="",this.inheritedSetupTestCase=null,this.inheritedPreconditionTestCase=null,!this.activeNode.item.setupId){const t=this.findParentWithValidSetup(e);this.inheritedSetupTestCase=t?t.item:null}if(!this.activeNode.item.preconditionId){const t=this.findParentWithValidPrecondition(e);this.inheritedPreconditionTestCase=t?t.item:null}this.activeNodeSetup=this.treeNodeSetupSteps(e),this.activeNodePrecondition=this.treeNodePreconditionSteps(this.activeNode),this.attachments.has(this.activeNode.item.id)&&(this.activeFileAttachments=this.attachments.get(this.activeNode.item.id)),this.getLinkedAttachments(this.activeNode.item.id),this.showMoreParamMap.clear(),this.paramTypeMap.clear(),this.activeNodeSetup.forEach(e=>{e&&(this.childParamArray=[],this.showMoreParamMap.set(e.id,!1),this.paramTypeMap.set(e.id,this.activeNode.item.specs.find(t=>t.setupId===e.id)?this.activeNode.item.specs.find(t=>t.setupId===e.id).specType:null),this.flatteringTree(this.parameterList.get(e.parameterId),0),this.levelParamMap.set(e.id,this.childParamArray))}),this.cdr.detectChanges()}showBrowsePreconditionDialog(e,t=null){this.dialog.open(ne,{width:"850px",data:{project:this.project,testCaseId:this.activeNode.item.id,setupId:e.item.setupId,preconditionId:e.item.preconditionId,inheritedSetupId:this.inheritedSetupTestCase?this.inheritedSetupTestCase.setupId:null,inheritedPreconditionId:this.inheritedPreconditionTestCase?this.inheritedPreconditionTestCase.preconditionId:null,startSetup:t,setPrecondition:!0}}).afterClosed().pipe(Object(j.a)(this.destroy$)).subscribe(t=>{null!==t&&"number"!=typeof t||(this.activeNodePrecondition=this.treeNodePreconditionSteps(e),this.nodeWithSamePreconditionMap.clear(),this.getNodeWithSamePrecondition(e,e.item.preconditionId),e.children.length>0&&this.nodeWithSamePreconditionMap.size>1?this.showPreconditionChangedDialog(e,t):(e.item.preconditionId=t,this.invalidateTreeNode(e,"preconditionId")),this.cdr.detectChanges())})}removePreconditionStep(e){this.activeNode.item.preconditionId=e.parentId,this.activeNodePrecondition=this.treeNodePreconditionSteps(this.activeNode),this.invalidateTreeNode(this.activeNode,"preconditionId"),this.cdr.detectChanges()}clearPrecondition(){this.activeNode.item.preconditionId=null,this.activeNodePrecondition=[],this.invalidateTreeNode(this.activeNode,"preconditionId"),this.cdr.detectChanges()}showBrowseSetupDialog(e,t=null){this.dialog.open(ne,{width:"850px",data:{project:this.project,testCaseId:this.activeNode.item.id,setupId:e.item.setupId,preconditionId:e.item.preconditionId,inheritedSetupId:this.inheritedSetupTestCase?this.inheritedSetupTestCase.setupId:null,inheritedPreconditionID:this.inheritedPreconditionTestCase?this.inheritedPreconditionTestCase.preconditionId:null,startSetup:t,setSetup:!0}}).afterClosed().pipe(Object(j.a)(this.destroy$)).subscribe(t=>{null!==t&&"number"!=typeof t||(this.nodeWithSameSetupMap.clear(),this.getNodeWithSameSetup(e,e.item.setupId),e.children.length>0&&this.nodeWithSameSetupMap.size>1?this.showSetupChangedDialog(e,t):(e.item.setupId=t,this.activeNodeSetup=this.treeNodeSetupSteps(e),this.invalidateTreeNode(e,"setupId")),this.cdr.detectChanges())})}removeSetupStep(e){this.activeNode.item.setupId=e.parentId,this.activeNodeSetup=this.treeNodeSetupSteps(this.activeNode),this.invalidateTreeNode(this.activeNode,"setupId"),this.cdr.detectChanges()}clearSetup(){const e=this.activeNode.item.specs.map(e=>this.hyperionTestCaseService.despecializeTestCase(new le.a,this.activeNode.item.id,e.setupId));e.length>0?Object(P.b)(e).pipe(Object(j.a)(this.destroy$)).subscribe(e=>{e.every(e=>e instanceof q.o)?(this.activeNode.item.setupId=null,this.activeNodeSetup=[],this.invalidateTreeNode(this.activeNode,"setupId")):this.notificationService.error("Can't remove specialized parameter")}):(this.activeNode.item.setupId=null,this.activeNodeSetup=[],this.invalidateTreeNode(this.activeNode,"setupId")),this.cdr.detectChanges()}getOrderNum(e,t){switch(t){case re.a.Before:if(e.item.parentId){const t=this.testCaseList.get(e.item.parentId).children.indexOf(e);return 0===t?1e3:Math.round((e.item.orderNum+this.testCaseList.get(e.item.parentId).children[t-1].item.orderNum)/2)}{const t=[...this.rootLevelTestCase.entries()].map(e=>e[1]).findIndex(t=>t.id===e.item.id);return 0===t?1e3:Math.round((e.item.orderNum+[...this.rootLevelTestCase.entries()].map(e=>e[1])[t-1].orderNum)/2)}case re.a.After:if(e.item.parentId){const t=this.testCaseList.get(e.item.parentId).children.indexOf(e);return t===this.testCaseList.get(e.item.parentId).children.length-1?e.item.orderNum+1e3:Math.round((e.item.orderNum+this.testCaseList.get(e.item.parentId).children[t+1].item.orderNum)/2)}{const t=[...this.rootLevelTestCase.entries()].map(e=>e[1]).findIndex(t=>t.id===e.item.id);return t===this.rootLevelTestCase.size-1?e.item.orderNum+1e3:Math.round((e.item.orderNum+[...this.rootLevelTestCase.entries()].map(e=>e[1])[t+1].orderNum)/2)}}}getNodeWithSameSetup(e,t){e.item.setupId===t&&this.nodeWithSameSetupMap.set(e.item.id,e),e.children.forEach(e=>this.getNodeWithSameSetup(e,t))}showSetupChangedDialog(e,t){const i=this.pristineTestCaseMap.get(e.item.id),n=Array.from(this.nodeWithSameSetupMap).filter(t=>t[0]!==e.item.id).map(e=>e[1].item.title).join(",");e.item.setupId=t,t!==i.setupId&&this.nodeWithSameSetupMap.size>1&&(R.a.fire({title:"Setup changed",text:"Do you want change setup for following children ("+n+")",type:"question",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"}).then(t=>{t.value&&(this.nodeWithSameSetupMap.forEach(t=>{t.item.setupId=e.item.setupId,this.updateTestCase(t,"setupId")}),this.updateTestCase(e,"setupId"))}),this.setActiveTreeNode(this.testCaseList.get(e.item.id)))}getNodeWithSamePrecondition(e,t){e.item.preconditionId===t&&this.nodeWithSamePreconditionMap.set(e.item.id,e),e.children.forEach(e=>this.getNodeWithSamePrecondition(e,t))}showPreconditionChangedDialog(e,t){const i=this.pristineTestCaseMap.get(e.item.id),n=Array.from(this.nodeWithSamePreconditionMap).filter(t=>t[0]!==e.item.id).map(e=>e[1].item.title).join(",");e.item.preconditionId=t,t!==i.preconditionId&&this.nodeWithSamePreconditionMap.size>1&&(R.a.fire({title:"Precondition changed",text:"Do you want change precondition for following children ("+n+")",type:"question",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"}).then(t=>{t.value&&(this.nodeWithSameSetupMap.forEach(t=>{t.item.preconditionId=e.item.preconditionId,this.updateTestCase(t,"preconditionId")}),this.updateTestCase(e,"preconditionId"))}),this.setActiveTreeNode(this.testCaseList.get(e.item.id)))}dropped(e){for(const t of e)if(t.fileEntry.isFile){const e=t.fileEntry,i=new k.a(0);this.attachmentsProgress.set(t.fileEntry.name,i),e.file(e=>{this.uploadService.uploadAttachment(e,q.b.TestCase,this.activeNode.item.id).pipe(Object(V.a)(e=>e.type===T.d.UploadProgress),Object(O.a)(()=>{i.complete(),this.attachmentsProgress.delete(e.name),this.cdr.detectChanges()})).subscribe(e=>{const t=Math.round(100*e.loaded/e.total);i.next(t)},t=>this.notificationService.warning("Failed to upload attachment error: "+e.name))})}}fileOver(e){}fileLeave(e){}createTestCase(e){const t=new ce.a;t.parentId=e.item.parentId,t.setupId=e.item.setupId,t.preconditionId=e.item.preconditionId,t.isGroup=e.item.isGroup,t.title=null===e.item.title?null:e.item.title.trim(),t.description=null===e.item.description?null:e.item.description.trim(),t.testSteps=e.item.testSteps.trim(),t.expectedResult=e.item.expectedResult.trim(),t.isDraft=!1,t.orderNum=e.item.orderNum,this.hyperionTestCaseService.createTestCase(t,e.item.projectId).pipe(Object(j.a)(this.destroy$)).subscribe(t=>{this.activeQueryId=t.id,this.createState=!1,this.setActiveTreeNode({children:[],item:{description:t.description,expectedResult:t.expectedResult,id:t.id,isDraft:t.isDraft,isGroup:t.isGroup,orderNum:t.orderNum,parentId:t.parentId,preconditionId:t.preconditionId,projectId:t.projectId,rev:t.rev,setupId:t.setupId,specs:t.specs,testSteps:t.testSteps,title:t.title,createdAt:t.createdAt,updatedAt:t.updatedAt}}),this.testCaseService.clearDraftNode(e.item.parentId),this.cdr.detectChanges(),this.notificationService.success(`Test ${e.item.isGroup?"group":"case"} created`)},e=>{if(e instanceof U.a){let t=null;switch(e.error){case ce.c.ParentNotExists:t="Parent test case does not exist";break;case ce.c.ProjectNotExists:t="Project does not exist";break;case ce.c.PreconditionNotExists:t="Precondition setup step does not exists";break;case ce.c.SetupNotExists:t="Setup step does not exist";break;case ce.c.TitleAlreadyExists:t="Test case title already exists";break;case ce.c.HasChildren:t="Setup step has children"}this.notificationService.error(t||e)}else this.notificationService.error(e)})}updateTestCase(e,t,i,n){const r=new ce.e,a=this.pristineTestCaseMap.get(e.item.id);r.parentId=i?-1===i?null:i:e.item.parentId!==a.parentId?e.item.parentId:a.parentId,r.orderNum=n||(e.item.orderNum!==a.orderNum?e.item.orderNum:a.orderNum),e.item.setupId===a.setupId||null!==t&&"setupId"!==t||(r.setupId=e.item.setupId),e.item.preconditionId===a.preconditionId||null!==t&&"preconditionId"!==t||(r.preconditionId=e.item.preconditionId),e.item.title===a.title||null!==t&&"title"!==t||(r.title=e.item.title),e.item.description===a.description||null!==t&&"description"!==t||(r.description=e.item.description),e.item.testSteps===a.testSteps||null!==t&&"testSteps"!==t||(r.testSteps=e.item.testSteps),e.item.expectedResult===a.expectedResult||null!==t&&"expectedResult"!==t||(r.expectedResult=e.item.expectedResult),e.item.isDraft===a.isDraft||null!==t&&"isDraft"!==t||(r.isDraft=e.item.isDraft),this.hyperionTestCaseService.updateTestCase(r,e.item.id).pipe(Object(j.a)(this.destroy$)).subscribe(t=>{this.notificationService.success(`Test ${e.item.isGroup?"group":"case"} updated`),this.activeNodeSetup.filter(e=>e.parameterId&&-1===t.specs.findIndex(t=>t.setupId===e.id)).forEach(e=>{this.specializeParam(this.specTypeEnum.Source+"|"+this.flatParameter.get(e.parameterId).id,e.id)}),this.cdr.detectChanges()},e=>{if(e instanceof U.a){let t=null;switch(e.error){case ce.c.ParentNotExists:t="Parent test case does not exist";break;case ce.c.ProjectNotExists:t="Project does not exist";break;case ce.c.PreconditionNotExists:t="Precondition setup step does not exists";break;case ce.c.SetupNotExists:t="Setup step does not exist";break;case ce.c.TitleAlreadyExists:t="Test case title already exists";break;case ce.c.HasChildren:t="Setup step has children"}this.notificationService.error(t||e)}else this.notificationService.error(e)})}deleteTestCase(e){if(e===this.activeNode&&(this.activeNode=null,this.activeNodeId=-1),0===e.item.id)return this.testCaseService.clearDraftNode(e.item.parentId?e.item.parentId:null),void this.cdr.detectChanges();const t=e.item.specs.map(t=>this.hyperionTestCaseService.despecializeTestCase(new le.a,e.item.id,t.setupId));t.length>0?Object(P.b)(t).pipe(Object($.a)(t=>t.every(e=>e instanceof q.o)?this.hyperionTestCaseService.deleteTestCase(e.item.id).pipe(Object(j.a)(this.destroy$)):Object(A.a)(new U.a))).subscribe(t=>{this.activeNode=null,this.activeNodeId=-1,this.notificationService.success(`Test ${e.item.isGroup?"group":"case"} deleted`),this.cdr.detectChanges()},t=>{t instanceof U.a&&t.error===ce.c.HasChildren?this.notificationService.warning(`Test ${e.item.isGroup?"group":"case"} can not be deleted because it is used elsewhere`):t instanceof U.g?(this.notificationService.warning(`Test ${e.item.isGroup?"group":"case"} is not found. Maybe it was deleted already`),this.activeNode&&e.item.id===this.activeNode.item.id&&(this.activeNode=null,this.activeNodeId=-1),this.cdr.detectChanges()):this.notificationService.error(t)}):this.hyperionTestCaseService.deleteTestCase(e.item.id).pipe(Object(j.a)(this.destroy$)).subscribe(t=>{this.activeNode=null,this.activeNodeId=-1,this.notificationService.success(`Test ${e.item.isGroup?"group":"case"} deleted`),this.cdr.detectChanges()},t=>{t instanceof U.a&&t.error===ce.c.HasChildren?this.notificationService.warning(`Test ${e.item.isGroup?"group":"case"} can not be deleted because it is used elsewhere`):t instanceof U.g?(this.notificationService.warning(`Test ${e.item.isGroup?"group":"case"} is not found. Maybe it was deleted already`),this.activeNode&&e.item.id===this.activeNode.item.id&&(this.activeNode=null,this.activeNodeId=-1),this.cdr.detectChanges()):this.notificationService.error(t)})}getLinkedAttachments(e){0!==e&&this.hyperionAttachmentService.getLinkedAttachments(q.b.TestCase,e).pipe(Object(j.a)(this.destroy$)).subscribe(t=>{this.attachments.set(e,t.items),this.activeFileAttachments=t.items,this.cdr.detectChanges()},e=>this.notificationService.error(e))}unlinkFileAttachment(e,t){this.hyperionAttachmentService.deleteAttachmentLink(e,q.b.TestCase,t).pipe(Object(j.a)(this.destroy$)).subscribe(t=>{this.activeFileAttachments=this.activeFileAttachments.filter(t=>t.id!==e),this.cdr.detectChanges()},e=>this.notificationService.error(e))}expandAllTreeNodes(){this.dynamicTree.expandTreeNodes()}collapseAllTreeNodes(){this.dynamicTree.collapseTreeNodes()}filterCallback(e,t){return!t||e.title.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1}orderingCallback(e,t){return e.item.orderNum>t.item.orderNum?1:-1}updateAfterDrop(e){const t=e.dropType,i=e.draggedNode,n=e.targetNode,r=this.pristineTestCaseMap.get(i.item.id),a=this.pristineTestCaseMap.get(r.parentId);let o=null,s=null;switch(t){case re.a.Before:case re.a.After:s=n.item.parentId,o=this.getOrderNum(n,t);break;case re.a.Into:s=n.item.id,o=n.children.length?n.children.slice(-1)[0].item.orderNum+1e3:1e3;break;case re.a.Root:s=-1,i.item.orderNum=[...this.rootLevelTestCase.entries()].map(e=>e[1]).sort((e,t)=>e.orderNum>t.orderNum?1:-1).slice(-1)[0].orderNum+1e3}i.item.parentId!==r.parentId&&a&&i.item.parentId&&(i.item.setupId===a.setupId||i.item.preconditionId===a.preconditionId)?this.afterDropDialog.fire().then(e=>{e.value&&(this.nodeSetupChangeCheckbox.checked&&(i.item.setupId===a.setupId&&(i.item.setupId=n.item.setupId),i.item.preconditionId===a.preconditionId&&(i.item.preconditionId=n.item.preconditionId)),this.childrenChangeCheckbox.checked&&i.children.filter(e=>e.item.setupId===a.setupId||e.item.preconditionId===a.preconditionId).forEach(e=>{e.item.setupId===a.setupId&&(e.item.setupId=n.item.setupId),e.item.preconditionId===a.preconditionId&&(e.item.preconditionId=n.item.preconditionId),this.updateTestCase(e,null)})),this.updateTestCase(i,null,s,o)}):this.updateTestCase(i,null,s,o)}showNotification(e){const t=e.message;switch(e.type){case z.b.Success:this.notificationService.success(t);break;case z.b.Info:this.notificationService.info(t);break;case z.b.Warning:this.notificationService.warning(t);break;case z.b.Error:this.notificationService.error(t)}}getSpecValue(e){if(!this.activeNode.item.specs.find(t=>t.setupId===e))return!1;{const t=this.activeNode.item.specs.find(t=>t.setupId===e);switch(t.specType){case q.n.Any:return q.n.Any+"|any";case q.n.Random:return q.n.Random+"|random";case q.n.Value:return q.n.Value+"|"+t.value;case q.n.Source:return q.n.Source+"|"+t.parameterId;default:return!1}}}getSpec(e){return this.inheritedSetupTestCase?this.inheritedSetupTestCase.specs.find(t=>t.setupId===e)||null:this.activeNode.item.specs.find(t=>t.setupId===e)||null}specializeParam(e,t){const i=new Map;this.activeNode.item.specs.forEach((e,t)=>{i.set(e.setupId,this.flatParameter.get(this.flatSetup.get(e.setupId).parameterId))});const n=new ce.b;i.forEach((e,i)=>{e.dependentId===this.flatSetup.get(t).parameterId&&this.activeNode.item.specs.forEach((t,r)=>{t.setupId===i&&(n.specType=q.n.Source,n.value=null,n.parameterId=e.id,this.hyperionTestCaseService.specializeTestCase(n,this.activeNode.item.id,i).subscribe(e=>{this.showNotification({type:z.b.Success,message:"Parameter successfully changed"})},e=>this.showNotification({type:z.b.Error,message:"Something going wrong"})))})});const r=new ce.b,a=e.split("|")[0],o=e.split("|")[1];switch(a){case"3":r.specType=q.n.Any;break;case"4":r.specType=q.n.Random;break;case"1":r.specType=q.n.Value,r.value=o+"";break;case"2":r.specType=q.n.Source,r.parameterId=+o}this.hyperionTestCaseService.specializeTestCase(r,this.activeNode.item.id,t).subscribe(e=>{this.showNotification({type:z.b.Success,message:"Parameter successfully changed"})},e=>this.showNotification({type:z.b.Error,message:"Something going wrong"}))}despecializeParam(e){const t=new le.a;this.hyperionTestCaseService.despecializeTestCase(t,this.activeNode.item.id,e).subscribe(t=>{this.showMoreParamMap.set(e,!1),this.showNotification({type:z.b.Success,message:"Parameter successfully changed"})},e=>this.showNotification({type:z.b.Error,message:"Something going wrong"}))}flatteringTree(e,t){if(!e)return;t++;const i=new U.i;i.item=new q.f,i.item.title="",i.item.values=e.item.values,i.item.id=e.item.id,i.item.parentId=e.item.parentId,i.item.projectId=e.item.projectId,i.children=e.children,i.item.title="&nbsp;&nbsp;&nbsp;&nbsp;".repeat(t-1)+e.item.title,this.childParamArray.push({level:t,item:i.item}),e.children.forEach(e=>this.flatteringTree(e,t))}getParameters(e){const t=[...this.flatSetup.values()].filter(e=>e.parameterId).find(t=>t.parameterId===this.flatParameter.get(e).dependentId),i=t?this.activeNode.item.specs.find(e=>e.setupId===t.id):null;return i&&i.value?this.flatParameter.get(e).values.filter(e=>e.dependentValue===i.value):this.flatParameter.get(e).values}focusTestCase(){this.activeQueryId&&this.ready$.asObservable().pipe(Object(V.a)(e=>!!e),Object(D.a)(1)).subscribe(()=>{const e=this.testCaseList.get(this.activeQueryId);if(e){const t=this.getAllParentId(e);this.dynamicTree.expandTreeNodesById(t),setTimeout(()=>{const t=this.render.selectRootElement("#input-testcase-"+e.item.id);setTimeout(()=>t.focus(),10),console.log("focus test case"),this.setActiveTreeNode(e)},20)}else this.router.navigate([],{queryParams:{id:null},replaceUrl:!0,queryParamsHandling:"merge"})})}tooltipTextShow(e){if(0===e.item.specs.length)return null;const t=this.treeNodeSetupSteps(e).map(e=>e.parameterId).filter(e=>!!e),i=t.map(e=>{if(this.flatParameter.get(e).dependentId)return e}).filter(e=>!!e);if(i.map(e=>-1!==t.findIndex(t=>t===this.flatParameter.get(e).dependentId)).every(e=>!0===e))return null;const n=i.filter(e=>-1===t.findIndex(t=>t===this.flatParameter.get(e).dependentId));let r="";return n.forEach(e=>{r+="["+this.flatParameter.get(e).title+"] parameter depends on ["+this.flatParameter.get(this.flatParameter.get(e).dependentId).title+"] parameter which is not set for any of the parent setup steps \n"}),r}afterTreeRendered(e){e&&this.focusTestCase()}}return e.\u0275fac=function(t){return new(t||e)(Y["\u0275\u0275directiveInject"](a.a),Y["\u0275\u0275directiveInject"](a.g),Y["\u0275\u0275directiveInject"](Y.Renderer2),Y["\u0275\u0275directiveInject"](Y.ChangeDetectorRef),Y["\u0275\u0275directiveInject"](d.b),Y["\u0275\u0275directiveInject"](b.Lightbox),Y["\u0275\u0275directiveInject"](ue.a),Y["\u0275\u0275directiveInject"](oe.a),Y["\u0275\u0275directiveInject"](de.a),Y["\u0275\u0275directiveInject"](L.a),Y["\u0275\u0275directiveInject"](se.a),Y["\u0275\u0275directiveInject"](z.a),Y["\u0275\u0275directiveInject"](ae.a),Y["\u0275\u0275directiveInject"](_.a),Y["\u0275\u0275directiveInject"](me.a),Y["\u0275\u0275directiveInject"](Q.a),Y["\u0275\u0275directiveInject"](pe.a),Y["\u0275\u0275directiveInject"](B.a))},e.\u0275cmp=Y["\u0275\u0275defineComponent"]({type:e,selectors:[["m-test-cases-new-page"]],viewQuery:function(e,t){if(1&e&&(Y["\u0275\u0275staticViewQuery"](xe,!0),Y["\u0275\u0275staticViewQuery"](Se,!0),Y["\u0275\u0275viewQuery"](J.a,!0)),2&e){let e;Y["\u0275\u0275queryRefresh"](e=Y["\u0275\u0275loadQuery"]())&&(t.afterDropDialog=e.first),Y["\u0275\u0275queryRefresh"](e=Y["\u0275\u0275loadQuery"]())&&(t.checkbox1=e.first),Y["\u0275\u0275queryRefresh"](e=Y["\u0275\u0275loadQuery"]())&&(t.dynamicTree=e.first)}},decls:49,vars:14,consts:[["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"m-portlet","mb-0"],[1,"m-portlet__head","compact","align-items-center"],[1,"d-inline-flex"],["mat-raised-button","","color","primary",3,"matMenuTriggerFor","disabled","click"],[1,"ml-2","m-button-group"],["mat-raised-button","",3,"click"],[1,"m-portlet__head-tools"],[1,"m-portlet__nav"],[4,"ngIf"],[1,"m-portlet__nav-item"],["href","javascript:void(null);","title","Refresh","matTooltip","Click to refresh","matTooltipPosition","above",1,"m-portlet__nav-link","m-portlet__nav-link--icon",3,"click"],[1,"las","la-sync"],[1,"d-flex"],["unit","percent","direction","horizontal"],[3,"size"],[1,"pt-2","col-12","left-split-content"],[2,"height","70vh"],[3,"inputNodes$","hiddenNodeSet","dimmedNodeSet","canDrag","nodeAdded","nodeRemoved","nodeModified","showNotification","treeRendered"],["nodeTitleTemplate",""],["addButtonTemplate",""],[3,"size",4,"ngIf"],[3,"swalOptions"],["afterDropDialog",""],["lessAttachments",""],["moreAttachments",""],["uploadButton",""],[1,"pr-2"],["floatLabel","never",2,"width","300px"],["matInput","","placeholder","Type to filter...",3,"keyup"],["type","text",1,"monospace","new-in-place",2,"max-width","100ch !important","padding-left","5px !important",3,"id","placeholder","ngModel","ngModelChange","click","keyup.escape","keyup.enter","blur"],["class","las la-exclamation-triangle c-warning f-s-20","matTooltipPosition","above",3,"matTooltip",4,"ngIf"],["matTooltipPosition","above",1,"las","la-exclamation-triangle","c-warning","f-s-20",3,"matTooltip"],["class","icon-button","color","primary","matTooltip","Click to add a child","matTooltipPosition","above",3,"matMenuTriggerFor","disabled","click",4,"ngIf"],["color","primary","matTooltip","Click to add a child","matTooltipPosition","above",1,"icon-button",3,"matMenuTriggerFor","disabled","click"],[1,"las","la-plus","cursor-pointer","blue","f-s-20"],[1,"col","pt-3","pl-2","pr-2","right-split-content"],[1,"sticky-block"],[1,"title-container"],["matInput","","type","text",1,"form-control","inline-block",2,"max-width","65%",3,"placeholder","ngModel","ngModelChange","keyup.escape","blur"],[1,"block","text-right",2,"width","35%"],[1,"",3,"click"],[1,"las","la-times"],[1,"block","text-left",2,"width","50%"],[1,"sticky-id","dimmed"],[1,"block",2,"width","50%"],[1,"f-s-13","f-w-400"],["color","primary",3,"ngModel","ngModelChange","change"],[1,"basic-tree","pl-0"],[1,"f-w-600","block","pb-1"],["matInput","","matTextareaAutosize","","matAutosizeMinRows","2","matAutosizeMaxRows","4","placeholder","Put some text here",1,"form-control",3,"ngModel","ngModelChange","keyup.escape","blur"],[1,"input-border"],[1,"f-w-600","block","mb-0"],["matInput","","type","text",1,"form-control",3,"placeholder","ngModel","ngModelChange","keyup.escape","keyup.enter","blur"],[1,"row","m-0"],[1,"f-w-600","block"],["href","javascript:void(null)",1,"ml-2","f-w-400",3,"click"],[1,"f-w-400"],["class","dimmed",4,"ngIf"],["class","pl-0",4,"ngIf"],[1,"row"],[1,"col-md-12","mini"],[1,"col-md-12","mt-1",2,"display","flex","flex-wrap","wrap"],[3,"ngTemplateOutlet"],[1,"c-gray","ml-1","f-w-300"],["href","javascript:void(null)",1,"ml-1","f-w-400","c-error",3,"click"],[1,"c-info","f-w-500"],[1,"dimmed"],[1,"pl-0"],[4,"ngFor","ngForOf"],["href","javascript:void(null)","class","f-w-400",3,"click",4,"ngIf"],[1,"d-table-row"],[1,"d-table-cell","m--valign-top"],[1,"c-info"],[1,"d-table-cell"],[1,"inline-block","medium-line","align-text-bottom"],[1,"d-table-cell","m--valign-top",2,"padding-top","3px"],["class","c-error align-text-bottom ml-1 clickable animate","style","height: 21px",3,"f-w-600","mouseover","mouseout","click",4,"ngIf"],[1,"c-error","align-text-bottom","ml-1","clickable","animate",2,"height","21px",3,"mouseover","mouseout","click"],["href","javascript:void(null)",1,"f-w-400",3,"click"],[1,"c-success","align-text-bottom","f-w-600","narrow-icon"],[1,"medium-line","align-text-bottom"],["class","c-error m--valign-top align-text-bottom ml-1 clickable animate","style","padding-top: 3px",3,"f-w-600","mouseover","mouseout","click",4,"ngIf"],["class","d-table-cell",4,"ngIf"],[1,"c-error","m--valign-top","align-text-bottom","ml-1","clickable","animate",2,"padding-top","3px",3,"mouseover","mouseout","click"],[1,"c-gray","mr-2",3,"inline"],["class","f-w-400","href","javascript:void(null)",3,"ngSwitch","click",4,"ngIf"],["class","f-w-400",3,"click",4,"ngIf"],["href","javascript:void(null)",1,"f-w-400",3,"ngSwitch","click"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"f-w-400",3,"click"],["placeholder","Select parameter",1,"param-select",3,"value","selectionChange","openedChange"],[3,"value"],["label","Values",4,"ngIf"],["label","Sources",4,"ngIf"],["label","Values"],[3,"value",4,"ngFor","ngForOf"],[1,"la","la-link"],["label","Sources"],[3,"value","innerHTML",4,"ngFor","ngForOf"],[3,"value","innerHTML"],[1,"textarea-border"],[1,"col-md-6"],["matInput","","type","text","readonly","",1,"form-control",3,"value"],["class","attachment-count-container clickable mr-1 mb-1 animate",3,"click",4,"ngIf"],[4,"ngTemplateOutlet"],["class","thumb mr-1 mb-1 inline-block animate clickable","matTooltipPosition","above",3,"matTooltip",4,"ngIf"],["matTooltipPosition","above",1,"thumb","mr-1","mb-1","inline-block","animate","clickable",3,"matTooltip"],[3,"ngSwitch"],[3,"src","click",4,"ngSwitchCase"],["target","_blank",3,"href","ngSwitch"],["class","placeholder inline-block",4,"ngSwitchCase"],[1,"delete","animate",3,"swal","confirm"],[1,"animate","c-white"],[3,"src","click"],[1,"placeholder","inline-block"],[1,"attachment-count-container","clickable","mr-1","mb-1","animate",3,"click"],[1,"attachment-count-label","animate"],["class","thumb mr-1 mb-1 inline-block animate clickable","matTooltipPosition","above",3,"matTooltip",4,"ngFor","ngForOf"],[1,"uploader","compact","inline-block","clickable","mb-1"],["dropZoneLabel","Drop files here",3,"onFileDrop","onFileOver","onFileLeave"],["ngx-file-drop-content-tmp",""],["class","progress-container mr-1 mb-1",4,"ngIf"],[1,"progress-container","mr-1","mb-1"],["color","primary","mode","determinate",3,"value"],[1,"progress-percent"],["mat-icon-button","","color","primary",1,"animate",3,"click"],[1,"animate"]],template:function(e,t){if(1&e&&(Y["\u0275\u0275elementStart"](0,"mat-menu",null,0),Y["\u0275\u0275elementStart"](2,"button",1),Y["\u0275\u0275listener"]("click",function(){return t.addDraftTreeNode(!0)}),Y["\u0275\u0275elementStart"](3,"mat-icon"),Y["\u0275\u0275text"](4,"folder"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](5,"span"),Y["\u0275\u0275text"](6,"Add test group"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](7,"button",1),Y["\u0275\u0275listener"]("click",function(){return t.addDraftTreeNode(!1)}),Y["\u0275\u0275elementStart"](8,"mat-icon"),Y["\u0275\u0275text"](9,"assignment"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](10,"span"),Y["\u0275\u0275text"](11,"Add test case"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](12,"div",2),Y["\u0275\u0275elementStart"](13,"div",3),Y["\u0275\u0275elementStart"](14,"div",4),Y["\u0275\u0275elementStart"](15,"div"),Y["\u0275\u0275elementStart"](16,"button",5),Y["\u0275\u0275listener"]("click",function(){return t.lastNodeId=0}),Y["\u0275\u0275text"](17," Add test item "),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](18,"div",6),Y["\u0275\u0275elementStart"](19,"button",7),Y["\u0275\u0275listener"]("click",function(){return t.collapseAllTreeNodes()}),Y["\u0275\u0275text"](20,"Collapse"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](21,"button",7),Y["\u0275\u0275listener"]("click",function(){return t.expandAllTreeNodes()}),Y["\u0275\u0275text"](22,"Expand"),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](23,"div",8),Y["\u0275\u0275elementStart"](24,"ul",9),Y["\u0275\u0275template"](25,Ce,4,0,"li",10),Y["\u0275\u0275pipe"](26,"async"),Y["\u0275\u0275elementStart"](27,"li",11),Y["\u0275\u0275elementStart"](28,"a",12),Y["\u0275\u0275listener"]("click",function(){return t.refresh()}),Y["\u0275\u0275element"](29,"i",13),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementStart"](30,"div",14),Y["\u0275\u0275elementStart"](31,"as-split",15),Y["\u0275\u0275elementStart"](32,"as-split-area",16),Y["\u0275\u0275elementStart"](33,"div",17),Y["\u0275\u0275elementStart"](34,"perfect-scrollbar",18),Y["\u0275\u0275elementStart"](35,"m-dynamic-tree-map",19),Y["\u0275\u0275listener"]("nodeAdded",function(e){return t.addDraftTreeNode(e)})("nodeRemoved",function(e){return t.deleteTestCase(e)})("nodeModified",function(e){return t.updateAfterDrop(e)})("showNotification",function(e){return t.showNotification(e)})("treeRendered",function(e){return t.afterTreeRendered(e)}),Y["\u0275\u0275template"](36,Ie,2,12,"ng-template",null,20,Y["\u0275\u0275templateRefExtractor"]),Y["\u0275\u0275template"](38,we,1,1,"ng-template",null,21,Y["\u0275\u0275templateRefExtractor"]),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275template"](40,at,61,30,"as-split-area",22),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275elementEnd"](),Y["\u0275\u0275element"](41,"swal",23,24),Y["\u0275\u0275template"](43,ut,4,3,"ng-template",null,25,Y["\u0275\u0275templateRefExtractor"]),Y["\u0275\u0275template"](45,xt,2,2,"ng-template",null,26,Y["\u0275\u0275templateRefExtractor"]),Y["\u0275\u0275template"](47,It,5,3,"ng-template",null,27,Y["\u0275\u0275templateRefExtractor"])),2&e){const e=Y["\u0275\u0275reference"](1);Y["\u0275\u0275advance"](16),Y["\u0275\u0275property"]("matMenuTriggerFor",e)("disabled",t.treeNodeHasDraftChildren(null)),Y["\u0275\u0275advance"](9),Y["\u0275\u0275property"]("ngIf",Y["\u0275\u0275pipeBind1"](26,12,t.ready$)),Y["\u0275\u0275advance"](7),Y["\u0275\u0275property"]("size",t.activeNode?70:100),Y["\u0275\u0275advance"](1),Y["\u0275\u0275classProp"]("darken",t.activeNode),Y["\u0275\u0275advance"](2),Y["\u0275\u0275property"]("inputNodes$",t.testCaseService.testCaseTree$)("hiddenNodeSet",t.hiddenNodeSetId)("dimmedNodeSet",t.dimmedNodeSetId)("canDrag",!0),Y["\u0275\u0275advance"](5),Y["\u0275\u0275property"]("ngIf",t.activeNode&&!t.createState),Y["\u0275\u0275advance"](1),Y["\u0275\u0275property"]("swalOptions",t.afterDropOptions)}},directives:[u.a,u.c,p.a,o.a,u.e,n.m,v.a,he.c,he.b,S.b,J.a,x.a,l.b,m.b,r.c,r.i,r.l,s.a,m.d,n.r,n.l,n.o,n.p,n.q,f.a,fe.n,c.a,fe.m,x.b,C.a,C.b,h.a],pipes:[n.b,ge,n.e,n.g],styles:[".darken[_ngcontent-%COMP%]{background-color:rgba(176,196,222,.125)}.small-line[_ngcontent-%COMP%]{line-height:21px}.medium-line[_ngcontent-%COMP%]{line-height:24px}.narrow-icon[_ngcontent-%COMP%]{height:16px!important;width:24px!important}.bold-icon[_ngcontent-%COMP%]{font-size:24px!important;height:24px!important;width:24px!important;line-height:26px}input.inplace[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:2px;width:250px;height:26px;padding:2px 5px}  .basic-tree>li div>ul,   .basic-tree>li div>ul>li{list-style-type:disc!important}  .basic-tree>li div>ol,   .basic-tree>li div>ol>li{list-style-type:decimal!important}input.m-selected[_ngcontent-%COMP%]{background-color:#f5f7fa!important;border:1px solid #d3d3d3!important;box-shadow:0 0 7px 0 #d3d3d3!important}.draft[_ngcontent-%COMP%]{color:#ff8949;font-style:italic}.progress-percent[_ngcontent-%COMP%]{text-align:center;top:-60%;z-index:500;display:block;position:relative;font-size:16px}.progress-container[_ngcontent-%COMP%]{display:inline-block;color:#0782d0;width:100px!important;height:100px!important;border:1px solid rgba(7,130,208,.25)!important;border-radius:8px!important;transition:all .125s linear}.param-select[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:3px;width:150px;display:inline-block;padding:0 3px;margin:0 5px;vertical-align:super}.paramTitle[_ngcontent-%COMP%]{cursor:pointer}  .ps__rail-x{visibility:hidden}.align-icon[_ngcontent-%COMP%]{justify-content:center!important;background-repeat:no-repeat!important;display:flex!important;fill:currentColor!important;height:18px!important;width:18px!important;align-items:center!important}  .mat-select-panel .mat-optgroup-label{font-size:12px!important}.la-close-s-f[_ngcontent-%COMP%]{font-size:24px;color:#c4c5d6}.la-close-s-f[_ngcontent-%COMP%]:hover{cursor:pointer;font-size:24px;color:#a5a6b7}"],changeDetection:0}),e})();var wt=i("NuMO");let Nt=(()=>{class e{}return e.\u0275mod=Y["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=Y["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[],imports:[[n.c,r.e,o.b,s.b,d.f,l.d,p.b,m.c,h.b,u.d,v.b,g.c,b.LightboxModule,C.c,x.c,S.c,y.a,w.a,I.a,a.i.forChild([{path:"**",component:yt,resolve:{activeProject:N.a},canActivate:[wt.a]}]),f.b,c.b,he.a]]}),e})()}}]);