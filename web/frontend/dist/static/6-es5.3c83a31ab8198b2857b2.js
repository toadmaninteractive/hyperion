!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=i(e);if(t){var d=i(this).constructor;n=Reflect.construct(r,arguments,d)}else n=r.apply(this,arguments);return o(this,n)}}function o(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"8YY7":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return e[e.Id=1]="Id",e[e.FileSize=2]="FileSize",e[e.OriginalFilename=3]="OriginalFilename",e[e.ContentType=4]="ContentType",e[e.PersonnelId=5]="PersonnelId",e[e.PersonnelName=6]="PersonnelName",e[e.CreatedAt=7]="CreatedAt",e}({});!function(e){function t(t){switch(t){case e.Id:return"id";case e.FileSize:return"file_size";case e.OriginalFilename:return"original_filename";case e.ContentType:return"content_type";case e.PersonnelId:return"personnel_id";case e.PersonnelName:return"personnel_name";case e.CreatedAt:return"created_at";default:throw new Error("Invalid FileAttachmentOrderBy value: "+t)}}function n(t){switch(t){case"id":return e.Id;case"file_size":return e.FileSize;case"original_filename":return e.OriginalFilename;case"content_type":return e.ContentType;case"personnel_id":return e.PersonnelId;case"personnel_name":return e.PersonnelName;case"created_at":return e.CreatedAt;default:throw new Error("Invalid FileAttachmentOrderBy value: "+t)}}e.toJson=function(e){return t(e)},e.fromJson=function(e){return n(e)},e.toJsonKey=t,e.fromJsonKey=n}(r||(r={}))},E1Th:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n("tk/3"),o=n("z6cu"),i=n("JIr8"),a=n("lJxs"),s=n("UTw3"),l=n("0bxZ"),u=n("8YY7"),f=n("fXoL"),h=function(){var e=function(){function e(t){d(this,e),this.http=t,this.baseUrl=""}return c(e,[{key:"getProjectAttachments",value:function(e,t,n,d,c){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,h=[];h.push("order_by="+u.a.toJson(t)),h.push("order_dir="+s.h.toJson(n)),h.push("offset="+d),h.push("limit="+c),null!=f&&h.push("needle="+f);var p=h.length>0?"?"+h.join("&"):"";return this.http.get("".concat(this.baseUrl,"/api/attachments/project/").concat(e).concat(p)).pipe(Object(i.a)(function(e){if(e instanceof r.c)switch(e.status){case 403:return Object(o.a)(s.d.fromJson(e.error));case 500:return Object(o.a)(s.f.fromJson(e.error))}Object(o.a)(e)}),Object(a.a)(function(e){return s.c.instanceJsonSerializer(l.c).fromJson(e)}))}},{key:"getLinkedAttachments",value:function(e,t){return this.http.get("".concat(this.baseUrl,"/api/attachments/").concat(l.b.toJson(e),"/").concat(t)).pipe(Object(i.a)(function(e){if(e instanceof r.c)switch(e.status){case 403:return Object(o.a)(s.d.fromJson(e.error));case 404:return Object(o.a)(s.g.fromJson(e.error));case 500:return Object(o.a)(s.f.fromJson(e.error))}Object(o.a)(e)}),Object(a.a)(function(e){return s.b.instanceJsonSerializer(l.c).fromJson(e)}))}},{key:"deleteAttachmentLink",value:function(e,t,n){return this.http.delete("".concat(this.baseUrl,"/api/attachments/").concat(e,"/").concat(l.b.toJson(t),"/").concat(n)).pipe(Object(i.a)(function(e){if(e instanceof r.c)switch(e.status){case 403:return Object(o.a)(s.d.fromJson(e.error));case 404:return Object(o.a)(s.g.fromJson(e.error));case 500:return Object(o.a)(s.f.fromJson(e.error))}Object(o.a)(e)}),Object(a.a)(function(e){return s.e.fromJson(e)}))}},{key:"getAttachmentLinks",value:function(e){return this.http.get("".concat(this.baseUrl,"/api/attachments/").concat(e,"/links")).pipe(Object(i.a)(function(e){if(e instanceof r.c)switch(e.status){case 403:return Object(o.a)(s.d.fromJson(e.error));case 500:return Object(o.a)(s.f.fromJson(e.error))}Object(o.a)(e)}),Object(a.a)(function(e){return s.b.instanceJsonSerializer(l.d).fromJson(e)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275inject"](r.a))},e.\u0275prov=f["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},e18D:function(t,o,i){"use strict";i.d(o,"a",function(){return _});var a=i("fXoL"),s=i("UTw3"),l=i("Y4+Y"),u=i("N1IV"),f=i("ofXK"),h=i("bSwM"),p=["addButtonTemplate"],m=["addParaButtonTemplate"],g=["nodeTitleTemplate"];function v(e,t){1&e&&(a["\u0275\u0275elementStart"](0,"div",7),a["\u0275\u0275text"](1," Node template not defined\n"),a["\u0275\u0275elementEnd"]())}function N(e,t){if(1&e){var n=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"div",8),a["\u0275\u0275listener"]("dragover",function(e){return a["\u0275\u0275restoreView"](n),a["\u0275\u0275nextContext"]().onDragOverRoot(e)})("drop",function(e){return a["\u0275\u0275restoreView"](n),a["\u0275\u0275nextContext"]().onDropToRoot(e)})("dragleave",function(){return a["\u0275\u0275restoreView"](n),a["\u0275\u0275nextContext"]().onDragLeaveRoot()}),a["\u0275\u0275elementStart"](1,"div",9),a["\u0275\u0275text"](2," Drop to root "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()}if(2&e){var r=a["\u0275\u0275nextContext"]();a["\u0275\u0275classProp"]("drop-parent-select",r.dragOverRoot)}}var y=function(e){return{node:e}};function x(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"li",13),a["\u0275\u0275elementContainer"](1,14),a["\u0275\u0275elementEnd"]()),2&e){var n=a["\u0275\u0275nextContext"]().$implicit;a["\u0275\u0275nextContext"](2);var r=a["\u0275\u0275reference"](6),o=a["\u0275\u0275reference"](4);a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngTemplateOutlet",n.children.length?r:o)("ngTemplateOutletContext",a["\u0275\u0275pureFunction1"](2,y,n))}}function C(e,t){if(1&e&&(a["\u0275\u0275elementContainerStart"](0),a["\u0275\u0275template"](1,x,2,4,"li",12),a["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit,r=a["\u0275\u0275nextContext"](2);a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",!r.hiddenNodeSet.has(n.item.id))}}function k(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"ul",10),a["\u0275\u0275template"](1,C,2,1,"ng-container",11),a["\u0275\u0275elementEnd"]()),2&e){var n=a["\u0275\u0275nextContext"]();a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngForOf",n.nodes)}}function S(e,t){if(1&e&&a["\u0275\u0275elementContainer"](0,14),2&e){var n=t.node;a["\u0275\u0275nextContext"]();var r=a["\u0275\u0275reference"](8);a["\u0275\u0275property"]("ngTemplateOutlet",r)("ngTemplateOutletContext",a["\u0275\u0275pureFunction1"](2,y,n))}}function b(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"li",13),a["\u0275\u0275elementContainer"](1,14),a["\u0275\u0275elementEnd"]()),2&e){var n=a["\u0275\u0275nextContext"]().$implicit;a["\u0275\u0275nextContext"](3);var r=a["\u0275\u0275reference"](6),o=a["\u0275\u0275reference"](4);a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngTemplateOutlet",n.children.length?r:o)("ngTemplateOutletContext",a["\u0275\u0275pureFunction1"](2,y,n))}}function w(e,t){if(1&e&&(a["\u0275\u0275elementContainerStart"](0),a["\u0275\u0275template"](1,b,2,4,"li",12),a["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit,r=a["\u0275\u0275nextContext"](3);a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",!r.hiddenNodeSet.has(n.item.id))}}function I(e,t){if(1&e&&(a["\u0275\u0275elementContainerStart"](0),a["\u0275\u0275elementStart"](1,"ul",10),a["\u0275\u0275template"](2,w,2,1,"ng-container",11),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementContainerEnd"]()),2&e){var n=a["\u0275\u0275nextContext"]().node;a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("ngForOf",n.children)}}function O(e,t){if(1&e&&(a["\u0275\u0275elementContainer"](0,14),a["\u0275\u0275template"](1,I,3,1,"ng-container",15)),2&e){var n=t.node;a["\u0275\u0275nextContext"]();var r=a["\u0275\u0275reference"](8);a["\u0275\u0275property"]("ngTemplateOutlet",r)("ngTemplateOutletContext",a["\u0275\u0275pureFunction1"](3,y,n)),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",n.expanded)}}function T(e,t){if(1&e){var n=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"i",21),a["\u0275\u0275listener"]("click",function(){a["\u0275\u0275restoreView"](n);var e=a["\u0275\u0275nextContext"]().node;return e.expanded=!e.expanded}),a["\u0275\u0275elementEnd"]()}if(2&e){var r=a["\u0275\u0275nextContext"]().node;a["\u0275\u0275classProp"]("la-angle-right",!r.expanded)("la-angle-down",r.expanded)}}function E(e,t){if(1&e){var n=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"mat-checkbox",22),a["\u0275\u0275listener"]("change",function(e){a["\u0275\u0275restoreView"](n);var t=a["\u0275\u0275nextContext"]().node;return a["\u0275\u0275nextContext"]().onCheckNode(t,e.checked)}),a["\u0275\u0275elementEnd"]()}if(2&e){var r=a["\u0275\u0275nextContext"]().node,o=a["\u0275\u0275nextContext"]();a["\u0275\u0275property"]("indeterminate",o.indeterminateNodeSet.has(r.item.id))("checked",o.checkedNodeSet.has(r.item.id))("disabled",r.item.isDraft)}}function D(e,t){if(1&e){var n=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"i",23),a["\u0275\u0275listener"]("mousedown",function(e){a["\u0275\u0275restoreView"](n);var t=a["\u0275\u0275nextContext"]().node;return a["\u0275\u0275nextContext"]().setDraggedNode(e,t)})("mouseup",function(){return a["\u0275\u0275restoreView"](n),a["\u0275\u0275nextContext"](2).unsetDraggedNode()}),a["\u0275\u0275elementEnd"]()}}function A(e,t){if(1&e){var n=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"i",24),a["\u0275\u0275listener"]("click",function(){a["\u0275\u0275restoreView"](n);var e=a["\u0275\u0275nextContext"]().node;return a["\u0275\u0275nextContext"]().onRemoveNode(e)}),a["\u0275\u0275elementEnd"]()}}function P(e,t){if(1&e){var n=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"div",16),a["\u0275\u0275listener"]("dragover",function(e){a["\u0275\u0275restoreView"](n);var r=t.node;return a["\u0275\u0275nextContext"]().onDragOver(e,r)})("dragend",function(e){return a["\u0275\u0275restoreView"](n),a["\u0275\u0275nextContext"]().onDragEnd(e)})("drop",function(e){a["\u0275\u0275restoreView"](n);var r=t.node;return a["\u0275\u0275nextContext"]().onDrop(e,r)})("dragstart",function(e){a["\u0275\u0275restoreView"](n);var r=t.node;return a["\u0275\u0275nextContext"]().onDragStart(e,r)}),a["\u0275\u0275template"](1,T,1,4,"i",17),a["\u0275\u0275template"](2,E,1,3,"mat-checkbox",18),a["\u0275\u0275template"](3,D,1,0,"i",19),a["\u0275\u0275elementContainer"](4,14),a["\u0275\u0275elementContainer"](5,14),a["\u0275\u0275template"](6,A,1,0,"i",20),a["\u0275\u0275elementEnd"]()}if(2&e){var r=t.node,o=a["\u0275\u0275nextContext"](),i=a["\u0275\u0275reference"](10);a["\u0275\u0275classProp"]("dimmed",o.dimmedNodeSet.has(r.item.id))("more",o.dimmedNodeSet.has(r.item.id))("drag-start",r===o.draggedNode)("drop-center",r===o.hoveredNode&&0===o.draggedNodeHoveredType&&r!==o.draggedNode&&o.canDropInto(o.draggedNode,o.hoveredNode))("drop-before",r===o.hoveredNode&&-1===o.draggedNodeHoveredType&&r!==o.draggedNode&&o.canDropBefore(o.draggedNode,o.hoveredNode))("drop-below",r===o.hoveredNode&&1===o.draggedNodeHoveredType&&r!==o.draggedNode&&o.canDropAfter(o.draggedNode,o.hoveredNode)),a["\u0275\u0275attribute"]("draggable",r===o.draggedNode),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",r.children.length>0),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",o.showCheckboxes),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",o.canDrag&&0!==r.item.id),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngTemplateOutlet",o.nodeTitleTemplate)("ngTemplateOutletContext",a["\u0275\u0275pureFunction1"](21,y,r)),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngTemplateOutlet",o.addButtonTemplate?o.addButtonTemplate:i)("ngTemplateOutletContext",a["\u0275\u0275pureFunction1"](23,y,r)),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",o.canRemove)}}function j(e,t){if(1&e){var n=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"button",26),a["\u0275\u0275listener"]("click",function(){a["\u0275\u0275restoreView"](n);var e=a["\u0275\u0275nextContext"]().node;return a["\u0275\u0275nextContext"]().onAddNode(e)}),a["\u0275\u0275element"](1,"i",27),a["\u0275\u0275elementEnd"]()}if(2&e){var r=a["\u0275\u0275nextContext"]().node,o=a["\u0275\u0275nextContext"]();a["\u0275\u0275property"]("disabled",o.hasDraftChildrenSet.has(r.item.id))}}function R(e,t){if(1&e&&a["\u0275\u0275template"](0,j,2,1,"button",25),2&e){var n=a["\u0275\u0275nextContext"]();a["\u0275\u0275property"]("ngIf",n.canAdd)}}var J=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(o,e);var t=r(o);function o(e,n){var r;return d(this,o),(r=t.call(this)).expanded=!1,r.item=null,r.children=[],r.item=e.item,r.children=r.convertToDynamicNodes(e.children,n),r.expanded=n.has(e.item.id),r}return c(o,[{key:"convertToDynamicNodes",value:function(e,t){return e.map(function(e){return new o(e,t)})}}]),o}(s.i),_=function(){var t=function(){function t(e){d(this,t),this.cdr=e,this.dimmedNodeSet=new Set,this.hiddenNodeSet=new Set,this.canAdd=!0,this.canRemove=!0,this.showCheckboxes=!1,this.nodeAdded=new a.EventEmitter,this.nodeRemoved=new a.EventEmitter,this.nodeModified=new a.EventEmitter,this.showNotification=new a.EventEmitter,this.checkedNodeSetChange=new a.EventEmitter,this.checkedNodeSet=new Set,this.indeterminateNodeSet=new Set,this.nodes=[],this.flatNodes=[],this.expandedNodeSet=new Set,this.hasDraftChildrenSet=new Set,this.dragOverRoot=!1,this.delayBeforeHoveredNodeExpand=300,this.dropPlaceEnum=u.a,this.notificationTypeEnum=l.b}return c(t,[{key:"expandTreeNodes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.nodes;t.forEach(function(t){t.expanded=!0,e.expandTreeNodes(t.children)})}},{key:"expandTreeNodesById",value:function(e){this.flatNodes.filter(function(t){return e.includes(t.item.id)}).forEach(function(e){return e.expanded=!0}),this.cdr.detectChanges()}},{key:"collapseTreeNodes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.nodes;t.forEach(function(t){t.expanded=!1,e.collapseTreeNodes(t.children)})}},{key:"walkDynamicTreeNodes",value:function(e){var t=this;this.flatNodes=this.flatNodes.concat(e),e.forEach(function(e){return t.walkDynamicTreeNodes(e.children)})}},{key:"onAddNode",value:function(e){var t=this;e.expanded=!0,setTimeout(function(){return t.cdr.detectChanges()}),this.nodeAdded.emit(e.item.id)}},{key:"onRemoveNode",value:function(e){this.nodeRemoved.emit(e)}},{key:"saveExpandedNode",value:function(t){var n=this;this.expandedNodeSet=new Set([].concat(e(t.filter(function(e){return e.expanded}).map(function(e){return e.item.id})),e(this.expandedNodeSet))),t.forEach(function(e){return n.saveExpandedNode(e.children)})}},{key:"checkDraftChildren",value:function(t){var n=this;this.hasDraftChildrenSet=new Set([].concat(e(t.filter(function(e){return e.children.find(function(e){return 0===e.item.id})}).map(function(e){return e.item.id})),e(this.hasDraftChildrenSet))),t.forEach(function(e){return n.checkDraftChildren(e.children)})}},{key:"treeNodeHasDraftChildren",value:function(e){return e.children.filter(function(e){return 0===e.item.id}).length>0}},{key:"fillIndeterminateNodeSetId",value:function(){var e=this,t=this.flatNodes.filter(function(t){return e.checkedNodeSet.has(t.item.id)}).reduce(function(t,n){return t.concat(e.getAllParentId(n))},[]);return new Set(t)}},{key:"onCheckNode",value:function(t,n){var r=this;n?(this.checkedNodeSet=new Set([].concat(e(this.checkedNodeSet),[t.item.id],e(this.getAllChildrenId(t)))),this.indeterminateNodeSet=new Set([].concat(e(this.indeterminateNodeSet),e(this.getAllParentId(t)))),t.item.parentId&&this.markParent(this.getNode(t.item.parentId))):(this.checkedNodeSet.delete(t.item.id),this.indeterminateNodeSet.delete(t.item.id),this.getAllChildrenId(t).forEach(function(e){r.checkedNodeSet.delete(e),r.indeterminateNodeSet.delete(e)}),t.item.parentId&&this.unmarkParent(this.getNode(t.item.parentId))),this.checkedNodeSetChange.emit(this.checkedNodeSet)}},{key:"markParent",value:function(e){this.checkAllChildrenAreChecked(e.item.id)&&(this.checkedNodeSet.add(e.item.id),this.indeterminateNodeSet.delete(e.item.id),e.item.parentId&&this.markParent(this.getNode(e.item.parentId)))}},{key:"unmarkParent",value:function(e){this.checkAllChildrenAreUnchecked(e.item.id)?(this.checkedNodeSet.delete(e.item.id),this.indeterminateNodeSet.delete(e.item.id),e.item.parentId&&this.unmarkParent(this.getNode(e.item.parentId))):(this.checkedNodeSet.delete(e.item.id),this.indeterminateNodeSet.add(e.item.id),e.item.parentId&&this.unmarkParent(this.getNode(e.item.parentId)))}},{key:"checkAllChildrenAreChecked",value:function(e){var t=this;return this.getNode(e).children.every(function(e){return t.checkedNodeSet.has(e.item.id)})}},{key:"checkAllChildrenAreUnchecked",value:function(e){var t=this;return this.getNode(e).children.every(function(e){return!t.checkedNodeSet.has(e.item.id)})}},{key:"getAllParentId",value:function(e){for(var t=[];e&&0!==e.item.parentId;){var n=this.flatNodes.find(function(t){return t.item.id===e.item.parentId});t.push(n?n.item.id:null),e=n}return t.filter(function(e){return!!e})}},{key:"getAllChildrenId",value:function(t){var n=this;return t.children.reduce(function(t,r){return[].concat(e(t),[[r.item.id],r.children.map(function(e){return n.getAllChildrenId(e)}).reduce(function(e,t){return e.concat(t)},[])])},[]).concat(t.item.id).reduce(function(e,t){return e.concat(t)},[])}},{key:"getNode",value:function(e){return this.flatNodes.find(function(t){return t.item.id===e})}},{key:"setDraggedNode",value:function(e,t){this.draggedNode=t}},{key:"unsetDraggedNode",value:function(){this.draggedNode=null}},{key:"onDragOverRoot",value:function(e){this.dragOverRoot=!0,e.preventDefault()}},{key:"onDragLeaveRoot",value:function(){this.dragOverRoot=!1}},{key:"onDropToRoot",value:function(e){this.dragOverRoot=!1,this.nodeModified.emit({dropType:u.a.Root,draggedNode:this.draggedNode,targetNode:null}),this.onDragEnd(e)}},{key:"onDragOver",value:function(e,t){e.preventDefault(),this.draggedNodeHoveredType=NaN,this.hoveredNode&&t===this.hoveredNode?Date.now()-this.draggedNodeHoveredSince>this.delayBeforeHoveredNodeExpand&&(t.expanded||(t.expanded=!0,this.cdr.detectChanges())):(this.hoveredNode=t,this.draggedNodeHoveredSince=(new Date).getTime());var n=e.offsetY/e.target.clientHeight;n>.15&&n<.85?this.draggedNodeHoveredType=this.dropPlaceEnum.Into:n<.15?this.draggedNodeHoveredType=this.dropPlaceEnum.Before:n>.85&&(this.draggedNodeHoveredType=this.dropPlaceEnum.After)}},{key:"onDrop",value:function(e,t){t!==this.draggedNode&&(this.draggedNodeHoveredType===this.dropPlaceEnum.Into?this.canDropInto(this.draggedNode,t)?this.draggedNode.item.parentId===t.item.id?this.showNotification.emit({type:this.notificationTypeEnum.Error,message:"You try drop to parent"}):this.nodeModified.emit({dropType:u.a.Into,draggedNode:this.nodeConverter(this.draggedNode),targetNode:this.nodeConverter(t)}):this.showNotification.emit({type:this.notificationTypeEnum.Error,message:"Forbidden"}):this.draggedNodeHoveredType===this.dropPlaceEnum.Before&&this.canDropBefore(this.draggedNode,t)?this.nodeModified.emit({dropType:u.a.Before,draggedNode:this.nodeConverter(this.draggedNode),targetNode:this.nodeConverter(t)}):this.draggedNodeHoveredType===this.dropPlaceEnum.After&&this.canDropAfter(this.draggedNode,t)&&this.nodeModified.emit({dropType:u.a.After,draggedNode:this.nodeConverter(this.draggedNode),targetNode:this.nodeConverter(t)})),this.onDragEnd(e)}},{key:"onDragStart",value:function(e,t){e.dataTransfer.setData("foo","bar")}},{key:"onDragEnd",value:function(e){this.draggedNode=null,this.hoveredNode=null,this.draggedNodeHoveredSince=0,this.draggedNodeHoveredType=NaN,e.preventDefault()}},{key:"nodeConverter",value:function(e){var t=new s.i;return t.children=e.children,t.item=e.item,t}},{key:"verifyChildrenNode",value:function(e,t){return t.item.parentId!==e.item.id&&(!t.item.parentId||this.verifyChildrenNode(e,this.flatNodes.find(function(e){return e.item.id===t.item.parentId})))}},{key:"canDropInto",value:function(e,t){return!(!e||!t)&&e.item.parentId!==t.item.id&&this.verifyChildrenNode(e,t)}},{key:"canDropAfter",value:function(e,t){return!(!e||!t)&&e.item.id!==t.item.id&&this.verifyChildrenNode(e,t)}},{key:"canDropBefore",value:function(e,t){return!(!e||!t)&&e.item.id!==t.item.id&&this.verifyChildrenNode(e,t)}},{key:"inputNodes",set:function(e){var t=this;this.nodes.length&&(this.expandedNodeSet.clear(),this.saveExpandedNode(this.nodes)),this.nodes=e.map(function(e){return new J(e,t.expandedNodeSet)}),this.flatNodes=[],this.walkDynamicTreeNodes(this.nodes),this.hasDraftChildrenSet.clear(),this.checkDraftChildren(this.nodes),this.indeterminateNodeSet=this.fillIndeterminateNodeSetId()}},{key:"precheckedNodeIdSet",set:function(e){this.checkedNodeSet=e}}]),t}();return t.\u0275fac=function(e){return new(e||t)(a["\u0275\u0275directiveInject"](a.ChangeDetectorRef))},t.\u0275cmp=a["\u0275\u0275defineComponent"]({type:t,selectors:[["m-dynamic-tree"]],contentQueries:function(e,t,n){var r;(1&e&&(a["\u0275\u0275contentQuery"](n,p,!0),a["\u0275\u0275contentQuery"](n,m,!0),a["\u0275\u0275contentQuery"](n,g,!0)),2&e)&&(a["\u0275\u0275queryRefresh"](r=a["\u0275\u0275loadQuery"]())&&(t.addButtonTemplate=r.first),a["\u0275\u0275queryRefresh"](r=a["\u0275\u0275loadQuery"]())&&(t.addParaButtonTemplate=r.first),a["\u0275\u0275queryRefresh"](r=a["\u0275\u0275loadQuery"]())&&(t.nodeTitleTemplate=r.first))},inputs:{inputNodes:"inputNodes",dimmedNodeSet:"dimmedNodeSet",hiddenNodeSet:"hiddenNodeSet",canAdd:"canAdd",canRemove:"canRemove",showCheckboxes:"showCheckboxes",precheckedNodeIdSet:"precheckedNodeIdSet",canDrag:"canDrag"},outputs:{nodeAdded:"nodeAdded",nodeRemoved:"nodeRemoved",nodeModified:"nodeModified",showNotification:"showNotification",checkedNodeSetChange:"checkedNodeSetChange"},decls:11,vars:3,consts:[["class","m-card-warning",4,"ngIf"],["class","drop-parent",3,"drop-parent-select","dragover","drop","dragleave",4,"ngIf"],["class","tree-list",4,"ngIf"],["noChild",""],["hasChild",""],["nodeItem",""],["defaultAddButton",""],[1,"m-card-warning"],[1,"drop-parent",3,"dragover","drop","dragleave"],[1,"drop-text"],[1,"tree-list"],[4,"ngFor","ngForOf"],["class","tree-list-item",4,"ngIf"],[1,"tree-list-item"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngIf"],[1,"item-node",3,"dragover","dragend","drop","dragstart"],["class","las cursor-pointer",3,"la-angle-right","la-angle-down","click",4,"ngIf"],["color","primary","class","mr-1",3,"indeterminate","checked","disabled","change",4,"ngIf"],["class","drag-handle las la-grip-lines",3,"mousedown","mouseup",4,"ngIf"],["class","las la-trash cursor-pointer red",3,"click",4,"ngIf"],[1,"las","cursor-pointer",3,"click"],["color","primary",1,"mr-1",3,"indeterminate","checked","disabled","change"],[1,"drag-handle","las","la-grip-lines",3,"mousedown","mouseup"],[1,"las","la-trash","cursor-pointer","red",3,"click"],["class","icon-button",3,"disabled","click",4,"ngIf"],[1,"icon-button",3,"disabled","click"],[1,"las","la-plus","cursor-pointer","blue","f-s-20"]],template:function(e,t){1&e&&(a["\u0275\u0275template"](0,v,2,0,"div",0),a["\u0275\u0275template"](1,N,3,2,"div",1),a["\u0275\u0275template"](2,k,2,1,"ul",2),a["\u0275\u0275template"](3,S,1,4,"ng-template",null,3,a["\u0275\u0275templateRefExtractor"]),a["\u0275\u0275template"](5,O,2,5,"ng-template",null,4,a["\u0275\u0275templateRefExtractor"]),a["\u0275\u0275template"](7,P,7,25,"ng-template",null,5,a["\u0275\u0275templateRefExtractor"]),a["\u0275\u0275template"](9,R,1,1,"ng-template",null,6,a["\u0275\u0275templateRefExtractor"])),2&e&&(a["\u0275\u0275property"]("ngIf",!t.nodeTitleTemplate),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",t.draggedNode&&t.draggedNode.item.parentId),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngIf",t.nodes))},directives:[f.m,f.l,f.r,h.a],styles:[".example-tree-progress-bar[_ngcontent-%COMP%]{margin-left:30px}ul[_ngcontent-%COMP%]{list-style-type:none}.las[_ngcontent-%COMP%]{font-size:20px}.item-node[_ngcontent-%COMP%]{height:32px;display:flex;align-items:center;border:2px solid transparent}input[type=text].default-disable[_ngcontent-%COMP%], input[type=text].default-disable[_ngcontent-%COMP%]:disabled{border:none;border-bottom:1px solid #ccc;background-color:hsla(0,0%,100%,.125)}"],changeDetection:0}),t}()}}])}();